<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>THE.OS – Coordinate Grid Sequence</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300;500;700&family=Press+Start+2P&display=swap" rel="stylesheet">
  <style>
    :root {
      color-scheme: dark;
      --bg: #03040a;
      --fg: #cfd6ff;
      --accent: #8ab4ff;
      --accent-strong: #00ffc3;
    }

    * { box-sizing: border-box; }

    html, body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at 50% 15%, rgba(18, 30, 60, 0.55), rgba(3, 4, 10, 0.95));
      font-family: 'Roboto Mono', monospace;
      color: var(--fg);
      overflow: hidden;
    }

    #sequence-root {
      position: fixed;
      inset: 0;
    }

    #overlay {
      position: fixed;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 22px;
      background: radial-gradient(circle at 50% 50%, rgba(10, 16, 28, 0.92), rgba(3, 4, 8, 0.97));
      backdrop-filter: blur(8px) saturate(140%);
      -webkit-backdrop-filter: blur(8px) saturate(140%);
      z-index: 10;
      transition: opacity 0.6s ease, transform 0.6s ease;
    }

    #overlay.hidden {
      opacity: 0;
      pointer-events: none;
      transform: translateY(12px);
    }

    #startBtn {
      appearance: none;
      border: 1px solid rgba(138, 180, 255, 0.7);
      background: linear-gradient(135deg, rgba(40, 60, 120, 0.9), rgba(22, 34, 88, 0.9));
      color: #fff;
      padding: 18px 32px;
      font-size: 14px;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      border-radius: 999px;
      font-family: 'Press Start 2P', cursive;
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0 18px 45px rgba(10, 20, 60, 0.55), inset 0 1px 0 rgba(255, 255, 255, 0.15);
    }

    #startBtn:hover {
      transform: translateY(-3px);
      box-shadow: 0 24px 55px rgba(18, 36, 90, 0.65), inset 0 1px 0 rgba(255, 255, 255, 0.18);
    }

    #overlay h1 {
      margin: 0;
      font-size: clamp(22px, 3vw, 34px);
      letter-spacing: 0.4em;
      text-transform: uppercase;
      text-align: center;
      color: var(--accent-strong);
    }

    #overlay p {
      margin: 0;
      font-size: 13px;
      max-width: 540px;
      text-align: center;
      letter-spacing: 0.12em;
      line-height: 1.6;
      color: rgba(207, 214, 255, 0.82);
    }

    #telemetry {
      position: fixed;
      left: 24px;
      top: 24px;
      padding: 12px 18px;
      border-radius: 12px;
      background: rgba(12, 18, 36, 0.72);
      border: 1px solid rgba(138, 180, 255, 0.25);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      font-size: 12px;
      letter-spacing: 0.14em;
      line-height: 1.6;
      max-width: 320px;
      pointer-events: none;
      z-index: 4;
      opacity: 0;
      transition: opacity 1.2s ease;
    }

    body.running #telemetry { opacity: 1; }

    #telemetry strong { color: var(--accent-strong); }

    .hint {
      display: block;
      margin-top: 8px;
      font-size: 11px;
      color: rgba(255, 255, 255, 0.55);
      letter-spacing: 0.18em;
    }

    footer {
      position: fixed;
      bottom: 16px;
      right: 18px;
      font-size: 11px;
      letter-spacing: 0.2em;
      text-transform: uppercase;
      color: rgba(200, 210, 255, 0.45);
      z-index: 4;
    }
  </style>
</head>
<body>
  <div id="sequence-root"></div>

  <div id="overlay">
    <h1>THE.OS Grid Boot</h1>
    <p>Initialize the coordinate lattice. Observe 2D address genesis, Z-axis propagation, voxel crystallization, and singularity collapse into the black hole.</p>
    <button id="startBtn">Initialize Grid Build</button>
    <span class="hint">Audio recommended • Tap to engage</span>
  </div>

  <div id="telemetry">
    <div><strong>Sequence:</strong> Coordinate grid → Singularity</div>
    <div><strong>Status:</strong> Awaiting initialization</div>
    <div><strong>Controls:</strong> Observational</div>
  </div>

  <footer>celli.real // the.os lattice</footer>

  <script type="module">
    import { initTheosSequence } from '../../src/scripts/sequences/theosSequence.js';

    const params = new URLSearchParams(window.location.search);
    const startStage = params.get('start') === 'blackhole' ? 'blackhole' : 'intro';

    const overlay = document.getElementById('overlay');
    const startBtn = document.getElementById('startBtn');
    const telemetry = document.getElementById('telemetry');
    const sequenceRoot = document.getElementById('sequence-root');

    function updateTelemetry(message) {
      if (!telemetry) return;
      const lines = telemetry.querySelectorAll('div');
      if (lines.length > 1) {
        lines[1].innerHTML = `<strong>Status:</strong> ${message}`;
      }
    }

    let sequenceInstance = null;

    function beginSequence() {
      if (sequenceInstance) {
        return;
      }
      document.body.classList.add('running');
      if (overlay) {
        overlay.classList.add('hidden');
        setTimeout(() => overlay.remove(), 900);
      }
      updateTelemetry('Grid constructing…');
      sequenceInstance = initTheosSequence({
        container: sequenceRoot,
        startStage
      });

      if (startStage === 'blackhole') {
        updateTelemetry('Singularity engaged');
      } else {
        setTimeout(() => updateTelemetry('Extending into Z-axis…'), 9000);
        setTimeout(() => updateTelemetry('Voxel lattice forming…'), 17000);
        setTimeout(() => updateTelemetry('White room manifesting…'), 26000);
        setTimeout(() => updateTelemetry('Singularity forming…'), 34000);
      }
    }

    if (startStage === 'blackhole') {
      beginSequence();
    } else if (startBtn) {
      startBtn.addEventListener('click', beginSequence);
    }

    window.addEventListener('keydown', (event) => {
      if (event.key === 'Enter' || event.key === ' ') {
        beginSequence();
      }
    });
  </script>
</body>
</html>
