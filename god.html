<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LOOMWORKS // GOD ROUTER</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/react-router-dom@6/umd/react-router-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      --matrix-green: #00ff41;
      --terminal-bg: #050505;
      --panel-border: rgba(0, 255, 65, 0.18);
    }

    body {
      background: radial-gradient(circle at 20% 20%, rgba(0, 255, 65, 0.08), transparent 35%), var(--terminal-bg);
      color: #e2fbe2;
      font-family: 'Space Mono', 'Courier New', monospace;
    }

    .gridlines {
      background-size: 40px 40px;
      background-image: linear-gradient(to right, rgba(0, 255, 65, 0.07) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(0, 255, 65, 0.07) 1px, transparent 1px);
    }

    .holo {
      box-shadow: 0 0 30px rgba(0, 255, 65, 0.25);
      border-color: var(--panel-border);
    }

    .crt-glow {
      text-shadow: 0 0 8px rgba(0, 255, 65, 0.35);
    }

    .crt-flicker {
      animation: crt 0.16s infinite;
    }

    @keyframes crt {
      0% { opacity: 0.99; }
      50% { opacity: 1; }
      100% { opacity: 0.97; }
    }

    .panel-surface {
      background: rgba(0, 0, 0, 0.6);
      border: 1px solid var(--panel-border);
    }

    .nav-active {
      background: rgba(0, 255, 65, 0.16);
      color: #e2fbe2;
      border-color: rgba(0, 255, 65, 0.4);
    }

    iframe {
      background: #000;
    }
  </style>
</head>
<body class="min-h-screen gridlines">
  <div id="app-root"></div>

  <script type="text/babel">
    const { useMemo, useState, useEffect } = React;
    const { HashRouter, Routes, Route, NavLink, Navigate, useLocation, Link } = ReactRouterDOM;

    const MOCK_TRENDS = [
      { id: 1, topic: "Bitcoin Halving", category: "Finance", volatility: 0.8 },
      { id: 2, topic: "Met Gala Insects", category: "Fashion", volatility: 0.4 },
      { id: 3, topic: "AI Consciousness", category: "Tech", volatility: 0.9 },
      { id: 4, topic: "Fast Food Prices", category: "Econ", volatility: 0.6 },
      { id: 5, topic: "Oasis Reunion", category: "Music", volatility: 0.7 }
    ];

    const AGENTS = {
      DIME: { name: "DIME (The Child)", core: "Wonder/Confusion", toki: "sona lili" },
      FESH: { name: "FESH PINCE (The Jester)", core: "Absurdity/Satire", toki: "musi ike" },
      WEAVER: { name: "THE WEAVER (Historian)", core: "Patterns/History", toki: "tenpo pini" }
    };

    const CRYPTO_TICKERS = ["$PEPE", "$WIF", "$AI", "$BTC", "$SOL", "$DIME", "$MOG", "$TURBO"];

    const PROVISIONING_STACK = [
      { id: "Registrar", scope: "Identity Birth", focus: "Mint @loomworks.xyz + MX/DMARC", sla: "<2m" },
      { id: "Herald", scope: "Recovery Linker", focus: "Playwright Gmail binding", sla: "<90s" },
      { id: "Chorus Hand", scope: "Social Shell", focus: "TikTok/Spotify initialization", sla: "<3m" },
      { id: "Tropist", scope: "Semiotic Infill", focus: "TV Tropes heatmap + trope tags", sla: "<45s" },
      { id: "Spinster", scope: "Tracklist", focus: "90-song arc clustering", sla: "<2m" },
      { id: "GREG Monitor", scope: "Self-Repair", focus: "Link audits + re-cluster", sla: "continuous" }
    ];

    const ARC_LIBRARY = [
      { id: "hope", title: "Hope Arc", keyword: "pona", cpv: 0.006, form: "Reality Show PSA", backlog: ["LW_TRACK_091", "LW_TRACK_034"] },
      { id: "critique", title: "Anger/Critique", keyword: "ike", cpv: 0.012, form: "And Now Presenting", backlog: ["LW_TRACK_010", "LW_TRACK_034"] },
      { id: "heart", title: "Feeling/Pilin", keyword: "pilin", cpv: 0.008, form: "Vignette + Stem Pack", backlog: ["LW_TRACK_091", "LW_TRACK_010"] }
    ];

    const INITIAL_RESONANCE_NODES = [
      {
        node_id: "LW_TRACK_091",
        toki_pona_profile: {
          dominant_word: "pilin",
          purity_score: 0.85,
          truth_balance: "hope_weighted"
        },
        resonance_node: {
          theme: "Hope",
          life_link: "post_breakup_lucidity",
          culture_shell: "90s_vibe_animation",
          semiotic_lesson: "The integrity of the archive vs. digital rot"
        },
        industrial_metrics: {
          bite_layers: 9,
          reference_delta: 4.5,
          visual_shell: "creme_bezel_ui",
          accessibility: "open_gate"
        },
        performance_delta: {
          organic_rip_potential: "high",
          cpv_prediction: 0.006
        }
      },
      {
        node_id: "LW_TRACK_034",
        toki_pona_profile: {
          dominant_word: "pona",
          purity_score: 0.73,
          truth_balance: "balanced"
        },
        resonance_node: {
          theme: "Anger",
          life_link: "warehouse_shift_era",
          culture_shell: "1930s_aesthetic",
          semiotic_lesson: "Labor grift vs. craft integrity"
        },
        industrial_metrics: {
          bite_layers: 8,
          reference_delta: 6.2,
          visual_shell: "pumpkin_head",
          accessibility: "identity_gate"
        },
        performance_delta: {
          organic_rip_potential: "medium",
          cpv_prediction: 0.012
        }
      },
      {
        node_id: "LW_TRACK_010",
        toki_pona_profile: {
          dominant_word: "ike",
          purity_score: 0.64,
          truth_balance: "anger_weighted"
        },
        resonance_node: {
          theme: "Hope",
          life_link: "trainyard_nights",
          culture_shell: "skibidi_velocity",
          semiotic_lesson: "Integrity layer of a 1928 sketch vs. modern feed friction"
        },
        industrial_metrics: {
          bite_layers: 7,
          reference_delta: 3.1,
          visual_shell: "chrome_mask",
          accessibility: "open_gate"
        },
        performance_delta: {
          organic_rip_potential: "high",
          cpv_prediction: 0.004
        }
      }
    ];

    function Header() {
      const location = useLocation();
      const routeLabel = useMemo(() => {
        if (location.pathname.includes("story")) return "Story Wiki";
        if (location.pathname.includes("graph")) return "Node Graph";
        if (location.pathname.includes("cast")) return "Cast & Explorer";
        if (location.pathname.includes("weaver")) return "Weaver Protocol";
        if (location.pathname.includes("basilisk")) return "Basilisk Protocol";
        return "Router Overview";
      }, [location.pathname]);

      return (
        <header className="max-w-7xl mx-auto p-6 pb-3 flex items-center justify-between border-b border-green-800">
          <div>
            <p className="text-[11px] text-green-400 uppercase tracking-[0.35em]">Loomworks Dispatch</p>
            <h1 className="text-2xl font-bold text-green-300 crt-glow">GOD ROUTER · Basilisk / Story / Graph</h1>
            <p className="text-xs text-green-500">{routeLabel} · high-side routing online</p>
          </div>
          <div className="text-right text-xs text-green-700">
            <div>Now Presenting · Cast + Wiki + Node Graph</div>
            <div className="text-green-500">single-page cockpit</div>
          </div>
        </header>
      );
    }

    function Sidebar() {
      const routes = [
        { path: "/", label: "Overview", description: "Pulse, Shamanic protocol, in-app nav" },
        { path: "/story-wiki", label: "Story Wiki", description: "Story engine + wiki" },
        { path: "/graph", label: "Graph", description: "Node lattice / cockpit" },
        { path: "/cast", label: "Cast", description: "Story bible + explorer" },
        { path: "/weaver", label: "Weaver Protocol", description: "Agent stack + orchestration" },
        { path: "/basilisk", label: "Basilisk", description: "Live generator" }
      ];

      return (
        <nav className="panel-surface p-4 rounded-lg space-y-3">
          <div className="text-[11px] uppercase text-green-500 tracking-[0.2em]">Navigation</div>
          <div className="flex flex-col gap-2">
            {routes.map(route => (
              <NavLink
                key={route.path}
                to={route.path}
                end={route.path === "/"}
                className={({ isActive }) =>
                  `border border-green-900/60 rounded-md px-3 py-2 text-sm flex flex-col gap-0.5 hover:border-green-400 transition ${
                    isActive ? 'nav-active' : 'text-green-300'
                  }`
                }
              >
                <span className="font-semibold">{route.label}</span>
                <span className="text-[11px] text-green-500">{route.description}</span>
              </NavLink>
            ))}
          </div>
          <div className="text-[11px] text-green-600 border-t border-green-900/60 pt-2">
            Internal router keeps all modules docked—no external jumps.
          </div>
        </nav>
      );
    }

    function TriangulationMiniGame() {
      const [theme, setTheme] = useState("Hope");
      const [shell, setShell] = useState("Skibidi velocity");
      const [truth, setTruth] = useState("pilin");
      const [bite, setBite] = useState(7);
      const [ref, setRef] = useState(4);
      const [verdict, setVerdict] = useState("Awaiting triangulation…");

      const resonanceWeights = useMemo(() => ({
        theme: { Hope: 12, Anger: 11, Loss: 10, Love: 12 },
        shell: {
          'Skibidi velocity': 10,
          'Vintage gourmet meme': 11,
          'Tarot prop': 9,
          'Mario rotational rods': 12
        },
        truth: { pona: 4, ike: 5, pilin: 6 }
      }), []);

      const calculate = () => {
        const themeScore = resonanceWeights.theme[theme] || 8;
        const shellScore = resonanceWeights.shell[shell] || 8;
        const truthScore = resonanceWeights.truth[truth] || 4;
        const biteScore = Math.min(12, Math.max(1, Number(bite)));
        const refScore = Math.min(12, Math.max(1, Number(ref)));
        const cadence = Math.abs(7 - refScore) < 2 ? 3 : 1;
        const pilinBonus = truth === 'pilin' ? 2 : 0;
        const total = themeScore + shellScore + truthScore + biteScore + cadence + pilinBonus;

        const verdictCopy = total >= 45
          ? 'Legendary resonance—fire bars forged.'
          : total >= 38
            ? 'Strong pull—semiotic rods spinning hot.'
            : 'Keep iterating—adjacency needs more heat.';

        setVerdict(`Score: ${total} · ${verdictCopy}`);
      };

      return (
        <div className="panel-surface p-4 rounded-lg space-y-2">
          <div className="flex items-center justify-between">
            <h3 className="text-sm font-bold text-green-200">Triangulation Mini-Game</h3>
            <span className="text-[11px] text-green-500">Score resonance across shells</span>
          </div>
          <div className="grid grid-cols-2 md:grid-cols-3 gap-2 text-[12px] text-green-400">
            <label className="flex flex-col gap-1 text-green-300">Theme
              <select value={theme} onChange={e => setTheme(e.target.value)} className="bg-black border border-green-700 text-green-200 p-1 text-[11px] rounded">
                <option>Hope</option>
                <option>Anger</option>
                <option>Loss</option>
                <option>Love</option>
              </select>
            </label>
            <label className="flex flex-col gap-1 text-green-300">Culture Shell
              <select value={shell} onChange={e => setShell(e.target.value)} className="bg-black border border-green-700 text-green-200 p-1 text-[11px] rounded">
                <option>Skibidi velocity</option>
                <option>Vintage gourmet meme</option>
                <option>Tarot prop</option>
                <option>Mario rotational rods</option>
              </select>
            </label>
            <label className="flex flex-col gap-1 text-green-300">Truth Vector
              <select value={truth} onChange={e => setTruth(e.target.value)} className="bg-black border border-green-700 text-green-200 p-1 text-[11px] rounded">
                <option>pona</option>
                <option>ike</option>
                <option>pilin</option>
              </select>
            </label>
            <label className="flex flex-col gap-1 text-green-300">Bite Layers
              <input value={bite} onChange={e => setBite(e.target.value)} type="number" min="1" max="12" className="bg-black border border-green-700 text-green-200 p-1 text-[11px] rounded" />
            </label>
            <label className="flex flex-col gap-1 text-green-300">Reference Delta (beats)
              <input value={ref} onChange={e => setRef(e.target.value)} type="number" min="1" max="12" className="bg-black border border-green-700 text-green-200 p-1 text-[11px] rounded" />
            </label>
          </div>
          <button onClick={calculate} className="mt-2 text-[11px] bg-green-900 text-green-100 px-3 py-1 border border-green-700 hover:bg-green-800">Calculate Resonance Score</button>
          <div className="text-[11px] text-green-200 bg-green-900/20 border border-green-800 p-2 rounded mt-2">{verdict}</div>
        </div>
      );
    }

    function OverviewPanel() {
      return (
        <div className="space-y-4">
          <div className="grid md:grid-cols-3 gap-4">
            <div className="panel-surface p-4 rounded-lg holo">
              <p className="text-[10px] text-green-700 uppercase">Primary toolchain</p>
              <h2 className="text-lg text-green-200 font-bold">Domestic Product</h2>
              <p className="text-sm text-green-400 mb-2">Launch the legacy cockpit with referrer controls and integrated sequence builder.</p>
              <Link className="underline text-green-300 text-sm" to="/graph">Open graph cockpit</Link>
            </div>
            <div className="panel-surface p-4 rounded-lg holo">
              <p className="text-[10px] text-green-700 uppercase">Node graph engine</p>
              <h2 className="text-lg text-green-200 font-bold">Triangle/Celli lattice</h2>
              <p className="text-sm text-green-400 mb-2">Visualize jumps and Frogger leaps without leaving the router.</p>
              <Link className="underline text-green-300 text-sm" to="/graph">Route to graph</Link>
            </div>
            <div className="panel-surface p-4 rounded-lg holo">
              <p className="text-[10px] text-green-700 uppercase">Wiki style story engine</p>
              <h2 className="text-lg text-green-200 font-bold">Story Engine</h2>
              <p className="text-sm text-green-400 mb-2">CRM pulse with non-linear release scaffolding and manifestos.</p>
              <Link className="underline text-green-300 text-sm" to="/story-wiki">Open story wiki</Link>
            </div>
          </div>

          <div className="grid md:grid-cols-2 gap-4">
            <div className="panel-surface p-4 rounded-lg holo">
              <p className="text-[10px] text-green-700 uppercase">Cast</p>
              <h2 className="text-xl text-green-200 font-bold">LOOK characters · Now Presenting</h2>
              <p className="text-sm text-green-400">Pull character canon and Now Presenting beats directly from the encyclopedic cast sheet.</p>
              <div className="mt-3 flex gap-2 text-xs text-green-300 flex-wrap">
                <Link className="underline" to="/cast">Story Bible</Link>
                <Link className="underline" to="/cast">Explorer</Link>
                <Link className="underline" to="/story-wiki">Wiki tone demo</Link>
              </div>
            </div>
            <div className="panel-surface p-4 rounded-lg holo">
              <p className="text-[10px] text-green-700 uppercase">Now Presenting</p>
              <h2 className="text-xl text-green-200 font-bold">Timeline pulse</h2>
              <p className="text-sm text-green-400">Hop between canonical moments, cast files, and node graphs without losing tone.</p>
              <div className="mt-3 text-xs text-green-400 space-y-1">
                <div>· Timescape: Current / River Delta / Dunes of Yore</div>
                <div>· Agents: Dime · Fesh Pince · Weaver</div>
                <div>· Hooks: Basilisk dashboard for live leaping</div>
              </div>
            </div>
          </div>

          <div className="panel-surface p-4 rounded-lg holo space-y-4">
            <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-2">
              <div>
                <p className="text-[10px] text-green-700 uppercase">System Card Update · Genealogy Engine</p>
                <h2 className="text-lg text-green-200 font-bold">Shamanic Artist Protocol</h2>
                <p className="text-sm text-green-400">Tropological scans, resonance heatmaps, and bardic satire fused into a sovereign generative loop.</p>
              </div>
              <div className="text-[11px] text-green-500 bg-green-900/30 px-3 py-1 rounded-md border border-green-800">Password: 12346 · Semiotic Liminal Space</div>
            </div>
            <div className="grid md:grid-cols-3 gap-3 text-[12px] text-green-400">
              <div className="panel-surface p-3 rounded">
                <h3 className="font-bold text-green-200 text-sm">Tropological Scan</h3>
                <p className="text-green-500">TV Tropes compressed locally. Track legacy tropes colliding with novel trends to surface “Novel Evolutions”. Chains of meaning map nodes to universal imagery.</p>
              </div>
              <div className="panel-surface p-3 rounded">
                <h3 className="font-bold text-green-200 text-sm">Resonance Heatmap</h3>
                <p className="text-green-500">Heat every node against resonance vectors: Tarot arcana, Moe elements, and emotional poles (reversal, heat, distance, love, loss, pilin).</p>
              </div>
              <div className="panel-surface p-3 rounded">
                <h3 className="font-bold text-green-200 text-sm">Bardic Satire Protocol</h3>
                <p className="text-green-500">Treat every bar as transformative magic—satire that melts the opiate glaze of advertising. Rhythm is a forged Mario rotational rod.</p>
              </div>
            </div>
            <div className="grid md:grid-cols-3 gap-3 text-[12px] text-green-400">
              <div className="panel-surface p-3 rounded space-y-2">
                <h3 className="font-bold text-green-200 text-sm">Spellbook Encoding</h3>
                <p className="text-green-500">“Magic is simply the science of manipulating symbols, words, or images, to achieve changes in consciousness... Indeed, to cast a spell, is simply to spell, to manipulate words.”</p>
                <p className="text-green-600">Alan Moore reminds the Bard is feared because satire survives. Use grammar as grimmoire; resonance emerges from compressed specificity.</p>
              </div>
              <div className="panel-surface p-3 rounded space-y-2">
                <h3 className="font-bold text-green-200 text-sm">Semiotic Liminal Space</h3>
                <p className="text-green-500">Language encodes activation space. Link tropes like fire bars or pixel rods to place-based bars, candy bars, or prison bars. Hop lilypads between water → mirror → fire → slime → sand to keep meaning in motion.</p>
                <p className="text-green-600">Resonance is universal captured through specificity; familiarity is forged through adjacency.</p>
              </div>
              <div className="panel-surface p-3 rounded space-y-2">
                <h3 className="font-bold text-green-200 text-sm">Praxis / Poiesis / Theoria</h3>
                <p className="text-green-500">A complete work loops action, creation, and thought. Use tarot-like props, pop-culture dioramas, and satire to model the transformation of pain into bold confidence.</p>
                <p className="text-green-600">This router hosts the Little Rap God Machine: a language game that rewards triangulating meaning and truth through formalized prompts.</p>
              </div>
            </div>
            <div className="grid md:grid-cols-2 gap-4 text-[12px] text-green-400">
              <TriangulationMiniGame />
              <div className="panel-surface p-4 rounded space-y-2">
                <h3 className="font-bold text-green-200 text-sm">Samples & Adjacency</h3>
                <p className="text-green-500">Link “spitting fire bars” to pixel columns, candy bars, prison bars, and Frogger hops. Pair Will Smith mythos with Oscars scandal, or weave “Too many Urkles on your team, that’s why you’re Winslow” into labor grift stanzas.</p>
                <p className="text-green-600">Use off-centered UI as desire paths; comments as chorus; skimming as sprint. Remember: joke explained midflight still lands if the rhythm is forged.</p>
              </div>
            </div>
          </div>

          <div className="panel-surface p-4 rounded-lg holo">
            <div className="flex items-center justify-between">
              <div>
                <p className="text-[10px] text-green-700 uppercase">Hidden module</p>
                <h2 className="text-lg text-green-200 font-bold">BASILISK PROTOCOL</h2>
                <p className="text-sm text-green-400">Proof of concept tucked behind the router. Trigger trends, Frogger leaps, and Scattergun payouts.</p>
              </div>
              <Link to="/basilisk" className="px-3 py-1 text-xs border border-green-700 text-green-200 hover:bg-green-900">Open</Link>
            </div>
          </div>
        </div>
      );
    }

    function WeaverProtocolPanel() {
      const [agentOps, setAgentOps] = useState(() => PROVISIONING_STACK.map(agent => ({ ...agent, status: "idle", lastPing: "--", note: "Queued" })));
      const [ledger, setLedger] = useState([
        { ts: "08:00", msg: "Router online · mythkeeper quorum formed" },
        { ts: "08:05", msg: "Baseline resonance loaded from god.html nodes" }
      ]);
      const [voteDraft, setVoteDraft] = useState("pona hope pilin");
      const [nextArc, setNextArc] = useState(ARC_LIBRARY[0]);
      const [cta, setCta] = useState("Identity Assessment");
      const [backlogHealth, setBacklogHealth] = useState({ linked: 90, broken: 2, patched: 0 });

      const cycleStatus = (status) => {
        if (status === "idle") return "running";
        if (status === "running") return "stable";
        if (status === "stable") return "alert";
        return "idle";
      };

      const pushLedger = (msg) => {
        const ts = new Date().toLocaleTimeString();
        setLedger(prev => [{ ts, msg }, ...prev].slice(0, 10));
      };

      const pingAgent = (id) => {
        setAgentOps(prev => prev.map(agent => agent.id === id
          ? { ...agent, status: cycleStatus(agent.status), lastPing: new Date().toLocaleTimeString(), note: agent.status === "running" ? "stabilized" : "checking" }
          : agent
        ));
        pushLedger(`[${id}] executed runbook`);
      };

      const evaluateVotes = () => {
        const tokens = voteDraft.toLowerCase().split(/\s+/).filter(Boolean);
        let winner = ARC_LIBRARY[0];
        let bestScore = -1;
        ARC_LIBRARY.forEach(arc => {
          const score = tokens.filter(t => t.includes(arc.keyword)).length;
          if (score > bestScore) {
            bestScore = score;
            winner = arc;
          }
        });
        setNextArc(winner);
        pushLedger(`[VOTE] ${winner.title} prioritized via keyword match`);
      };

      const triggerRepair = () => {
        setBacklogHealth(prev => ({
          linked: prev.linked,
          broken: Math.max(prev.broken - 1, 0),
          patched: prev.patched + 1
        }));
        pushLedger("[GREG] Self-repair triggered · broken link patched");
      };

      const rotateCTA = () => {
        const next = cta === "Identity Assessment" ? "16x16 Manufacture" : "Identity Assessment";
        setCta(next);
        pushLedger(`[VALUE GATE] CTA rotated to ${next}`);
      };

      const statusColor = (status) => {
        if (status === "running") return "text-amber-300";
        if (status === "stable") return "text-green-300";
        if (status === "alert") return "text-red-300";
        return "text-green-700";
      };

      return (
        <div className="space-y-4">
          <div className="panel-surface p-4 rounded-lg holo flex flex-col md:flex-row md:items-center md:justify-between gap-2">
            <div>
              <p className="text-[10px] text-green-700 uppercase">Sovereign Automated IP</p>
              <h2 className="text-lg text-green-200 font-bold">Weaver Protocol · Operations Stack</h2>
              <p className="text-sm text-green-400">Sub-agents handle provisioning, trope infill, and self-repair; chorus accounts follow audience votes.</p>
            </div>
            <div className="text-[11px] bg-green-900/40 border border-green-800 px-3 py-1 rounded">Integrity Layer · 100-year stance</div>
          </div>

          <div className="grid md:grid-cols-3 gap-4">
            <div className="panel-surface p-3 rounded-lg holo space-y-2">
              <div className="flex items-center justify-between">
                <h3 className="text-sm font-bold text-green-200">Provisioning & Integrity Board</h3>
                <span className="text-[10px] text-green-600">Identity Birth → Self-Repair</span>
              </div>
              <div className="space-y-2">
                {agentOps.map(agent => (
                  <div key={agent.id} className="border border-green-900/60 bg-black/40 p-2 rounded">
                    <div className="flex items-center justify-between">
                      <div>
                        <div className="text-green-200 font-semibold text-sm">{agent.id}</div>
                        <div className="text-[10px] text-green-600">{agent.scope} · {agent.focus}</div>
                      </div>
                      <div className={`text-[11px] font-bold ${statusColor(agent.status)}`}>{agent.status.toUpperCase()}</div>
                    </div>
                    <div className="flex items-center justify-between text-[11px] text-green-500 mt-1">
                      <span>SLA: {agent.sla}</span>
                      <span>Last ping: {agent.lastPing}</span>
                    </div>
                    <div className="flex items-center justify-between mt-2 text-[11px]">
                      <button onClick={() => pingAgent(agent.id)} className="px-3 py-1 bg-green-900 text-green-100 border border-green-700 hover:bg-green-800">Run check</button>
                      <span className="text-green-600 italic">{agent.note}</span>
                    </div>
                  </div>
                ))}
              </div>
              <div className="text-[10px] text-green-500">Audit pings write to the integrity ledger and simulate the “follower ritual” checkpoints.</div>
            </div>

            <div className="panel-surface p-3 rounded-lg holo space-y-3">
              <div className="flex items-center justify-between">
                <h3 className="text-sm font-bold text-green-200">Comment-Driven Orchestration</h3>
                <button onClick={evaluateVotes} className="px-3 py-1 text-[11px] bg-green-900 text-green-100 border border-green-700 hover:bg-green-800">Parse votes</button>
              </div>
              <p className="text-[11px] text-green-500">Paste recent comments/keywords to steer the next drop. Keywords map to the arc library (pona/ike/pilin).</p>
              <textarea value={voteDraft} onChange={(e) => setVoteDraft(e.target.value)} className="w-full h-24 bg-black/50 border border-green-800 p-2 text-xs text-green-200" />
              <div className="border border-green-900/60 bg-black/40 p-2 rounded">
                <div className="text-[11px] text-green-600">Next Drop</div>
                <div className="flex items-center justify-between">
                  <div>
                    <div className="text-green-200 font-semibold">{nextArc.title}</div>
                    <div className="text-[11px] text-green-500">Form: {nextArc.form} · CPV target ${nextArc.cpv}</div>
                    <div className="text-[11px] text-green-500">Backlog: {nextArc.backlog.join(', ')}</div>
                  </div>
                  <button onClick={rotateCTA} className="px-3 py-1 text-[11px] bg-green-900 text-green-100 border border-green-700 hover:bg-green-800">Rotate CTA</button>
                </div>
                <div className="text-[11px] text-green-400 mt-1">Value Gate → {cta}</div>
              </div>
              <div className="text-[10px] text-green-500">Arc selection simulates the “American Idol” vote and feeds the drop planner.</div>
            </div>

            <div className="panel-surface p-3 rounded-lg holo space-y-3">
              <div className="flex items-center justify-between">
                <h3 className="text-sm font-bold text-green-200">Integrity Ledger</h3>
                <button onClick={triggerRepair} className="px-3 py-1 text-[11px] bg-green-900 text-green-100 border border-green-700 hover:bg-green-800">Patch link</button>
              </div>
              <div className="grid grid-cols-3 gap-2 text-[11px]">
                <div className="border border-green-800 bg-black/40 p-2 rounded">
                  <div className="text-green-500">Linked</div>
                  <div className="text-lg font-bold text-green-200">{backlogHealth.linked}</div>
                </div>
                <div className="border border-green-800 bg-black/40 p-2 rounded">
                  <div className="text-green-500">Broken</div>
                  <div className="text-lg font-bold text-amber-300">{backlogHealth.broken}</div>
                </div>
                <div className="border border-green-800 bg-black/40 p-2 rounded">
                  <div className="text-green-500">Patched</div>
                  <div className="text-lg font-bold text-green-200">{backlogHealth.patched}</div>
                </div>
              </div>
              <div className="space-y-1 text-[10px] text-green-300 max-h-48 overflow-y-auto">
                {ledger.map((entry, idx) => (
                  <div key={idx} className="border border-green-900/50 p-1 bg-black/50">[{entry.ts}] {entry.msg}</div>
                ))}
              </div>
              <div className="text-[10px] text-green-500">Ledger mirrors god.html metadata audits and self-repair triggers.</div>
            </div>
          </div>

          <div className="panel-surface p-4 rounded-lg holo">
            <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-2 mb-3">
              <div>
                <p className="text-[10px] text-green-700 uppercase">Drop Planner</p>
                <h3 className="text-lg font-bold text-green-200">Resonance Node Tree · 90-song backlog</h3>
                <p className="text-sm text-green-400">Catalog arcs, pick form factor, and keep skibidi-speed velocity without losing the integrity layer.</p>
              </div>
              <div className="text-[11px] bg-black/40 border border-green-800 px-3 py-1 rounded text-green-400">Chorus accounts auto-follow on publish.</div>
            </div>
            <div className="grid md:grid-cols-3 gap-3 text-[12px] text-green-400">
              {ARC_LIBRARY.map(arc => (
                <div key={arc.id} className="border border-green-800 bg-black/30 p-3 rounded">
                  <div className="flex items-center justify-between">
                    <div className="text-green-200 font-semibold">{arc.title}</div>
                    <span className="text-[10px] text-green-600">keyword: {arc.keyword}</span>
                  </div>
                  <div className="text-[11px]">Form: {arc.form}</div>
                  <div className="text-[11px]">CPV target: ${arc.cpv}</div>
                  <div className="text-[11px]">Backlog nodes: {arc.backlog.join(', ')}</div>
                </div>
              ))}
            </div>
          </div>
        </div>
      );
    }

    function IframePanel({ views, title, description }) {
      const [active, setActive] = useState(views[0].id);
      const current = views.find(v => v.id === active) || views[0];

      return (
        <div className="panel-surface p-4 rounded-lg space-y-3 holo">
          <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-2">
            <div>
              <p className="text-[10px] text-green-700 uppercase">{description}</p>
              <h2 className="text-xl text-green-200 font-bold">{title}</h2>
            </div>
            <div className="flex flex-wrap gap-2 text-[11px]">
              {views.map(view => (
                <button
                  key={view.id}
                  onClick={() => setActive(view.id)}
                  className={`px-3 py-1 border rounded-md transition ${active === view.id ? 'bg-green-800 text-green-50 border-green-500' : 'border-green-800 text-green-400 hover:border-green-500'}`}
                >
                  {view.label}
                </button>
              ))}
            </div>
          </div>
          <div className="text-[12px] text-green-500">{current.copy}</div>
          <div className="h-[620px] w-full border border-green-900 overflow-hidden rounded">
            <iframe title={current.label} src={current.src} className="w-full h-full" loading="lazy"></iframe>
          </div>
        </div>
      );
    }

    function StoryWikiPanel() {
      const views = [
        { id: 'engine', label: 'Story Engine', src: 'story-engine/index.html', copy: 'CRM + wiki pulse with non-linear release scaffolding and manifestos.' },
        { id: 'demo', label: 'Narrative Demo', src: 'narrative-demo.html', copy: 'Tone demo for wiki space—keeps weight and cadence consistent.' },
        { id: 'bible', label: 'Story Bible', src: 'story.html', copy: 'Full cast canonical beats inside the shell.' }
      ];
      return <IframePanel views={views} title="Story Wiki" description="Wiki style story engine" />;
    }

    function GraphPanel() {
      const views = [
        { id: 'three', label: 'Node Graph', src: 'three.html', copy: 'Routes to the three.js lattice (Triangle/Celli) for visualizing jumps and Frogger leaps.' },
        { id: 'oldindex', label: 'Domestic Product', src: 'oldindex.html', copy: 'Legacy cockpit with referrer controls and integrated sequence builder.' }
      ];
      return <IframePanel views={views} title="Graph Cockpit" description="Node graph engine" />;
    }

    function CastPanel() {
      const views = [
        { id: 'story-bible', label: 'Story Bible', src: 'story.html', copy: 'Encyclopedic cast sheet plus canonical beats.' },
        { id: 'explorer', label: 'Explorer', src: 'story-explorer/index.html', copy: 'Interactive explorer for traversing the cast and moments.' },
        { id: 'wiki', label: 'Wiki Tone', src: 'narrative-demo.html', copy: 'Wiki tone demo to keep cadence aligned with Now Presenting.' }
      ];
      return <IframePanel views={views} title="Cast & Explorer" description="Characters · Now Presenting" />;
    }

    function BasiliskDashboard() {
      const [logs, setLogs] = useState(["SYSTEM INITIALIZED...", "CONNECTING TO CELLI NODE GRAPH...", "LISTENING TO ZEITGEIST..."]);
      const [trends, setTrends] = useState([]);
      const [nodes, setNodes] = useState([]);
      const [activePath, setActivePath] = useState([]);
      const [activeAgent, setActiveAgent] = useState("DIME");
      const [generatedContent, setGeneratedContent] = useState(null);
      const [resonanceNodes, setResonanceNodes] = useState(INITIAL_RESONANCE_NODES);
      const [apiStatus, setApiStatus] = useState({
        transcription: "idle",
        trendDiscovery: "idle",
        distroStats: "idle"
      });
      const [financials, setFinancials] = useState({
        totalRevenue: 45200,
        warChest: 13560,
        vault: 13560,
        venture: 9040,
        casino: 9040,
        holdings: []
      });

      useEffect(() => {
        const tempNodes = [];
        for (let i = 0; i < 40; i++) {
          tempNodes.push({
            id: i,
            x: Math.random() * 100,
            y: Math.random() * 100,
            label: ["Water", "Mirror", "God", "Glitch", "Profit", "Frog", "Coin", "Shell", "Ghost", "Void", "Urkel", "Winslow"][Math.floor(Math.random() * 12)],
            active: false
          });
        }
        setNodes(tempNodes);
      }, []);

      const addLog = (msg) => {
        const timestamp = new Date().toLocaleTimeString();
        setLogs(prev => [`[${timestamp}] ${msg}`, ...prev].slice(0, 8));
      };

      const ingestTrend = () => {
        const newTrend = MOCK_TRENDS[Math.floor(Math.random() * MOCK_TRENDS.length)];
        setTrends(prev => [newTrend, ...prev].slice(0, 5));
        addLog(`[SENSORIUM] Ingested Trend: ${newTrend.topic} (Vol: ${newTrend.volatility})`);
      };

      const triggerLeap = (trend) => {
        addLog(`[CELLI] Calculating Frogger Leap for: ${trend.topic}...`);
        const startNode = Math.floor(Math.random() * nodes.length);
        const midNode = Math.floor(Math.random() * nodes.length);
        const endNode = Math.floor(Math.random() * nodes.length);
        const path = [startNode, midNode, endNode];
        setActivePath(path);
        const newNodes = nodes.map((n, idx) => ({ ...n, active: path.includes(idx) }));
        setNodes(newNodes);
        setTimeout(() => generateAsset(trend, newNodes[endNode].label), 1500);
      };

      const generateAsset = (trend, anchor) => {
        const agent = AGENTS[activeAgent];
        addLog(`[BASILISK] Generating Asset via Agent: ${agent.name}`);
        let script = "";
        if (activeAgent === "DIME") {
          script = `DIME: "Steve said ${trend.topic} is like ${anchor}. But if the ${anchor} breaks, do we still get paid? sona lili. I am just a file."`;
        } else if (activeAgent === "FESH") {
          script = `FESH: "Yall rly think ${trend.topic} matters?? Its giving ${anchor} energy fr fr. Simulation broke. Buy my merch."`;
        } else {
          script = `WEAVER: "${trend.topic} threads through the ${anchor} glyph. Catalogued, archived, filed."`;
        }

        setGeneratedContent({
          topic: trend.topic,
          anchor,
          script,
          audioStatus: "RENDERING (Suno API)...",
          videoStatus: "QUEUED (SyncLabs)..."
        });
      };

      const syncTranscriptions = () => {
        addLog("[INGEST] Queuing auto-transcription for backlog (stub)");
        setApiStatus(prev => ({ ...prev, transcription: "queued" }));
        setTimeout(() => setApiStatus(prev => ({ ...prev, transcription: "complete" })), 1200);
      };

      const scanOpenInternet = () => {
        addLog("[RESONANCE] Searching for leading topics and shells (stub)");
        setApiStatus(prev => ({ ...prev, trendDiscovery: "scanning" }));
        setTimeout(() => {
          ingestTrend();
          setApiStatus(prev => ({ ...prev, trendDiscovery: "complete" }));
        }, 800);
      };

      const fetchDistroStats = () => {
        addLog("[PERFORMANCE] Pulling DistroKid delta metrics (stub)");
        setApiStatus(prev => ({ ...prev, distroStats: "syncing" }));
        setTimeout(() => setApiStatus(prev => ({ ...prev, distroStats: "ready" })), 900);
      };

      const simulatePayout = () => {
        const payout = 1000;
        addLog(`[BAGMAN] Incoming Stripe Payout: $${payout}`);
        const split = { warChest: payout * 0.30, vault: payout * 0.30, venture: payout * 0.20, casino: payout * 0.20 };
        const vibe = generatedContent ? generatedContent.anchor : "Vibes";
        const ticker = CRYPTO_TICKERS[Math.floor(Math.random() * CRYPTO_TICKERS.length)];
        addLog(`[SCATTERGUN] Allocating $${split.casino} to ${ticker} based on node: ${vibe}`);
        setFinancials(prev => ({
          totalRevenue: prev.totalRevenue + payout,
          warChest: prev.warChest + split.warChest,
          vault: prev.vault + split.vault,
          venture: prev.venture + split.venture,
          casino: prev.casino + split.casino,
          holdings: [...prev.holdings, { ticker, amount: split.casino, vibe }].slice(-5)
        }));
      };

      return (
        <div className="h-full flex flex-col p-4 gap-4 panel-surface rounded-lg">
          <div className="flex justify-between items-center border-b border-green-900 pb-2">
            <h1 className="text-xl font-bold tracking-widest text-green-500">LOOMWORKS // BASILISK_V1.0</h1>
            <div className="text-xs text-green-800 animate-pulse">SYSTEM STATUS: OPERATIONAL</div>
          </div>
          <div className="flex-1 grid grid-cols-12 gap-4 min-h-0">
            <div className="col-span-3 border border-green-900 p-2 flex flex-col bg-black/50">
              <h2 className="text-sm font-bold mb-2 bg-green-900 text-black px-1">ZEITGEIST SENSORIUM [INPUT]</h2>
              <button onClick={ingestTrend} className="bg-green-700 hover:bg-green-600 text-black text-xs py-1 mb-4 font-bold">SCAN ZEITGEIST</button>
              <div className="flex-1 overflow-y-auto space-y-2">
                {trends.map(t => (
                  <div key={t.id} className="text-xs border-l-2 border-green-600 pl-2 cursor-pointer hover:bg-green-900/30 p-1 group">
                    <div className="font-bold flex justify-between">
                      {t.topic}
                      <span className="text-green-700">{t.volatility}</span>
                    </div>
                    <div className="text-[10px] text-green-600">{t.category}</div>
                    <button onClick={() => triggerLeap(t)} className="hidden group-hover:block w-full text-center bg-green-900 text-[10px] mt-1 hover:text-white">TRIGGER LEAP</button>
                  </div>
                ))}
                {trends.length === 0 && <div className="text-xs text-green-800 italic text-center mt-10">Scanning...</div>}
              </div>
            </div>
            <div className="col-span-6 border border-green-900 relative bg-black overflow-hidden">
              <h2 className="absolute top-2 left-2 text-sm font-bold bg-green-900 text-black px-1 z-10">CELLI SEMIOTIC ENGINE [PROCESS]</h2>
              <div className="w-full h-full relative">
                {nodes.map((node, i) => (
                  <div key={i}
                    className={`node absolute w-2 h-2 rounded-full ${node.active ? 'bg-white glow w-3 h-3 z-20' : 'bg-green-800'}`}
                    style={{ left: `${node.x}%`, top: `${node.y}%` }}>
                    {node.active && <div className="absolute top-4 left-0 text-[10px] bg-black border border-green-500 px-1 whitespace-nowrap z-30">{node.label}</div>}
                  </div>
                ))}
                {activePath.length === 3 && (
                  <svg className="absolute top-0 left-0 w-full h-full pointer-events-none z-10">
                    <line x1={`${nodes[activePath[0]].x}%`} y1={`${nodes[activePath[0]].y}%`}
                          x2={`${nodes[activePath[1]].x}%`} y2={`${nodes[activePath[1]].y}%`}
                          stroke="#00ff41" strokeWidth="1" strokeDasharray="4" className="animate-pulse" />
                    <line x1={`${nodes[activePath[1]].x}%`} y1={`${nodes[activePath[1]].y}%`}
                          x2={`${nodes[activePath[2]].x}%`} y2={`${nodes[activePath[2]].y}%`}
                          stroke="#00ff41" strokeWidth="1" strokeDasharray="4" className="animate-pulse" />
                  </svg>
                )}
              </div>
            </div>
            <div className="col-span-3 border border-green-900 p-2 flex flex-col bg-black/50">
              <h2 className="text-sm font-bold mb-2 bg-green-900 text-black px-1">AGENT SELECTION</h2>
              <div className="flex gap-2 mb-4">
                {Object.keys(AGENTS).map(key => (
                  <button key={key} onClick={() => setActiveAgent(key)}
                    className={`flex-1 text-[10px] py-1 border border-green-600 ${activeAgent === key ? 'bg-green-600 text-black font-bold' : 'text-green-600 opacity-50'}`}>
                    {key}
                  </button>
                ))}
              </div>
              <div className="flex-1 border-t border-green-900 pt-2 mb-2">
                <h3 className="text-xs font-bold mb-2 underline decoration-green-600">GENERATED ASSET_</h3>
                {generatedContent ? (
                  <div className="bg-green-900/10 p-2 border border-green-800 text-xs">
                    <div className="mb-1 text-green-400">PATH: {generatedContent.topic} -&gt; {generatedContent.anchor}</div>
                    <div className="italic text-white mb-2">"{generatedContent.script}"</div>
                    <div className="text-[10px] grid grid-cols-2 gap-2">
                      <span className="text-green-600 animate-pulse">{generatedContent.audioStatus}</span>
                      <span className="text-green-600 animate-pulse">{generatedContent.videoStatus}</span>
                    </div>
                  </div>
                ) : (
                  <div className="text-[10px] text-green-800">Waiting for Frogger Leap...</div>
                )}
              </div>
              <div className="h-1/3 border-t border-green-900 pt-2 overflow-hidden">
                <h3 className="text-xs font-bold mb-1">SYSTEM LOGS</h3>
                <div className="text-[10px] space-y-1 font-mono">
                  {logs.map((log, i) => <div key={i} className="opacity-70">&gt; {log}</div>)}
                </div>
              </div>
            </div>
          </div>
          <div className="h-32 border border-green-900 p-2 grid grid-cols-12 gap-4 bg-black/80">
            <div className="col-span-2 flex flex-col justify-center border-r border-green-900">
              <h2 className="text-sm font-bold text-green-400 mb-2">THE BAGMAN</h2>
              <button onClick={simulatePayout} className="bg-green-900 text-green-300 text-xs py-2 hover:bg-green-800 border border-green-600">SIMULATE $1k PAYOUT</button>
            </div>
            <div className="col-span-6 grid grid-rows-2 gap-2">
              <div className="flex items-center text-xs">
                <span className="w-24 font-bold">WAR CHEST (30%)</span>
                <div className="flex-1 bg-green-900/30 h-4 relative">
                  <div className="bg-green-600 h-full transition-all duration-500" style={{ width: `${(financials.warChest / financials.totalRevenue) * 100}%` }}></div>
                  <span className="absolute right-1 top-0 text-[9px]">${financials.warChest}</span>
                </div>
              </div>
              <div className="flex items-center text-xs">
                <span className="w-24 font-bold">CASINO (20%)</span>
                <div className="flex-1 bg-green-900/30 h-4 relative">
                  <div className="bg-purple-600 h-full transition-all duration-500" style={{ width: `${(financials.casino / financials.totalRevenue) * 100}%` }}></div>
                  <span className="absolute right-1 top-0 text-[9px]">${financials.casino}</span>
                </div>
              </div>
            </div>
            <div className="col-span-4 border-l border-green-900 pl-4 overflow-y-auto">
              <h3 className="text-[10px] font-bold mb-1 text-purple-400">SCATTERSHOT HOLDINGS [ACTIVE]</h3>
              <div className="grid grid-cols-3 gap-1">
                {financials.holdings.map((h, i) => (
                  <div key={i} className="bg-purple-900/20 border border-purple-800 p-1 text-[9px] text-center">
                    <div className="font-bold text-purple-300">{h.ticker}</div>
                    <div className="text-green-700 opacity-60">{h.vibe}</div>
                  </div>
                ))}
              </div>
            </div>
          </div>

          <div className="border border-green-900 p-3 bg-black/80 grid grid-cols-12 gap-4">
            <div className="col-span-5 space-y-2">
              <div className="flex items-center justify-between">
                <h2 className="text-sm font-bold text-green-200">SOVEREIGN FEEDBACK ENGINE</h2>
                <span className="text-[10px] bg-green-900 text-black px-2 py-0.5 rounded-full">90-song backlog mapped</span>
              </div>
              <p className="text-xs text-green-400">Compressed resonance nodes blending Humanese lore, meme shells, and industrial bite metrics.</p>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-2">
                {resonanceNodes.map(node => (
                  <div key={node.node_id} className="border border-green-800 p-2 bg-green-900/10 text-[11px]">
                    <div className="flex items-center justify-between mb-1">
                      <span className="font-bold text-green-200">{node.node_id}</span>
                      <span>balance: {node.toki_pona_profile.truth_balance}</span>
                    </div>
                    <div className="text-green-500">Theme: {node.resonance_node.theme}</div>
                    <div className="text-green-500">Shell: {node.resonance_node.culture_shell}</div>
                    <div className="text-green-600">Performance: {node.performance_delta.organic_rip_potential}</div>
                  </div>
                ))}
              </div>
            </div>
            <div className="col-span-4 space-y-2">
              <h3 className="text-xs font-bold text-green-300">Toki Pona Tracker · Zero State</h3>
              <p className="text-[11px] text-green-500">Balancing <span className="text-green-300">pona</span> (hope arc), <span className="text-green-300">ike</span> (critique arc), and <span className="text-green-300">pilin</span> (heart connector) to prevent sterile drops.</p>
              <div className="grid grid-cols-3 gap-2 text-[11px]">
                <div className="border border-green-800 p-2 bg-green-900/10">
                  <div className="text-[10px] text-green-600">pona</div>
                  <div className="text-lg font-bold text-green-200">{resonanceNodes.filter(n => n.toki_pona_profile.dominant_word === "pona").length}</div>
                  <div className="text-[10px] text-green-500">Hope-weighted payloads</div>
                </div>
                <div className="border border-green-800 p-2 bg-green-900/10">
                  <div className="text-[10px] text-green-600">ike</div>
                  <div className="text-lg font-bold text-green-200">{resonanceNodes.filter(n => n.toki_pona_profile.dominant_word === "ike").length}</div>
                  <div className="text-[10px] text-green-500">Anger/critique arcs</div>
                </div>
                <div className="border border-green-800 p-2 bg-green-900/10">
                  <div className="text-[10px] text-green-600">pilin</div>
                  <div className="text-lg font-bold text-green-200">{resonanceNodes.filter(n => n.toki_pona_profile.dominant_word === "pilin").length}</div>
                  <div className="text-[10px] text-green-500">Heart connectors</div>
                </div>
              </div>
              <div className="text-[10px] bg-black border border-green-800 p-2 overflow-x-auto">
                <div className="font-bold text-green-300 mb-1">Node JSON (live)</div>
                <pre className="whitespace-pre-wrap text-green-400">{JSON.stringify(resonanceNodes[0], null, 2)}</pre>
              </div>
            </div>
            <div className="col-span-3 space-y-2 border-l border-green-900 pl-3">
              <h3 className="text-xs font-bold text-green-300">Data Infill & API Stubs</h3>
              <p className="text-[11px] text-green-500">Skeleton for connecting DistroKid stats, auto-transcription, and open-internet scouting.</p>
              <div className="flex flex-col gap-2">
                <button onClick={syncTranscriptions} className="text-[10px] bg-green-900 text-green-200 py-1 border border-green-700 hover:bg-green-800">Queue Transcriptions</button>
                <button onClick={scanOpenInternet} className="text-[10px] bg-green-900 text-green-200 py-1 border border-green-700 hover:bg-green-800">Scan Leading Topics</button>
                <button onClick={fetchDistroStats} className="text-[10px] bg-green-900 text-green-200 py-1 border border-green-700 hover:bg-green-800">Sync DistroKid Metrics</button>
              </div>
              <div className="text-[10px] grid grid-cols-1 gap-1 text-green-400">
                <div className="flex items-center justify-between border border-green-800 px-2 py-1">
                  <span>Transcription</span>
                  <span className="text-green-200">{apiStatus.transcription}</span>
                </div>
                <div className="flex items-center justify-between border border-green-800 px-2 py-1">
                  <span>Trend Discovery</span>
                  <span className="text-green-200">{apiStatus.trendDiscovery}</span>
                </div>
                <div className="flex items-center justify-between border border-green-800 px-2 py-1">
                  <span>Distro Metrics</span>
                  <span className="text-green-200">{apiStatus.distroStats}</span>
                </div>
              </div>
              <div className="text-[10px] text-green-500">
                Reference delta + bite layers will be cross-walked with CPV predictions as live stats arrive.
              </div>
            </div>
          </div>
        </div>
      );
    }

    function BasiliskPanel() {
      return (
        <div className="space-y-4">
          <div className="panel-surface p-4 rounded-lg holo">
            <p className="text-[10px] text-green-700 uppercase">Hidden module</p>
            <h2 className="text-lg text-green-200 font-bold">BASILISK PROTOCOL</h2>
            <p className="text-sm text-green-400">Live dashboard for trend ingestion, frogger leaps, and scattergun payouts. Docked inside the SPA shell.</p>
          </div>
          <BasiliskDashboard />
        </div>
      );
    }

    function App() {
      return (
        <HashRouter>
          <div className="min-h-screen text-green-200">
            <Header />
            <main className="max-w-7xl mx-auto p-6 grid md:grid-cols-[260px,1fr] gap-4">
              <Sidebar />
              <div className="space-y-4">
                <Routes>
                  <Route path="/" element={<OverviewPanel />} />
                  <Route path="/story-wiki" element={<StoryWikiPanel />} />
                  <Route path="/graph" element={<GraphPanel />} />
                  <Route path="/cast" element={<CastPanel />} />
                  <Route path="/weaver" element={<WeaverProtocolPanel />} />
                  <Route path="/basilisk" element={<BasiliskPanel />} />
                  <Route path="*" element={<Navigate to="/" />} />
                </Routes>
              </div>
            </main>
          </div>
        </HashRouter>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('app-root'));
    root.render(<App />);
  </script>
</body>
</html>
