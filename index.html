<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LOOMWORKS: Domestic Product // Field Edition</title>
    <link rel="icon" href="data:,">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Space Grotesk', 'sans-serif'],
                        mono: ['Space Mono', 'monospace'],
                        serif: ['Cinzel', 'serif'],
                    },
                    colors: {
                        loom: {
                            red: '#CD2B2B',
                            black: '#111',
                            cream: '#FDFBF7',
                            paper: '#f9f4ea'
                        },
                        tonka: {
                            gold: '#FFC54D',
                            cobalt: '#2555FF',
                            mint: '#3DFFB5',
                            plum: '#5A2D82'
                        }
                    }
                }
            }
        }
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>
    <script type="importmap">
        { "imports": { "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js", "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/" } }
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;700&family=Space+Mono:ital,wght@0,400;0,700;1,400&family=Cinzel:wght@400;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-color: #FDFBF7;
            --text-color: #111;
            --accent-red: #CD2B2B;
        }
        
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            overscroll-behavior: none;
            touch-action: manipulation;
        }

        /* --- CORE AESTHETICS --- */
        .blueprint {
            background: linear-gradient(0deg, rgba(205,43,43,0.05) 1px, transparent 1px),
                        linear-gradient(90deg, rgba(205,43,43,0.05) 1px, transparent 1px),
                        #FDFBF7;
            background-size: 26px 26px;
        }
        
        .scanline-layer {
            position: fixed; inset: 0; pointer-events: none; z-index: 10;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.05) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03));
            background-size: 100% 4px, 4px 100%;
            pointer-events: none;
            mix-blend-mode: multiply;
            opacity: 0.6;
        }

        .view-section { 
            display: none; 
            min-height: 100vh; 
            padding-top: 80px; 
            opacity: 0;
            animation: fadeIn 0.5s forwards;
        }
        .view-section.active { 
            display: block; 
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .fade-in { animation: fadeIn 0.4s ease forwards; }

        .archive-mode-btn { border: 1px solid #111; background: #fff; padding: 6px 10px; }
        .archive-mode-btn.active { background: #111; color: #fff; }
        .archive-constructing #archive-groups > div,
        .archive-constructing #archive-quick > div,
        .archive-constructing #tarot-slots > div,
        .archive-constructing #influence-tray > span {
            animation: forge-shift 0.75s cubic-bezier(0.22, 1, 0.36, 1);
            animation-delay: var(--forge-delay, 0ms);
        }

        @keyframes forge-shift {
            0% { transform: translateY(12px) scale(0.98); opacity: 0; filter: blur(2px); }
            60% { transform: translateY(-4px) scale(1.02); opacity: 0.9; filter: blur(0); }
            100% { transform: translateY(0) scale(1); opacity: 1; filter: blur(0); }
        }

        /* --- UI COMPONENTS --- */
        .ui-click { cursor: pointer; user-select: none; transition: transform 0.1s; }
        .ui-click:active { transform: translateY(2px); }
        button,
        a,
        [role="button"],
        .ui-click {
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }

        #canvas-container canvas {
            touch-action: none;
        }

        .gallery-panel {
            pointer-events: auto;
        }

        .lantern-toggle {
            border: 1px solid #111;
            letter-spacing: 0.22em;
            font-family: 'Cinzel', serif;
            box-shadow: 3px 3px 0 rgba(0, 0, 0, 0.45);
        }
        .lantern-toggle:hover {
            background: #111;
            color: #FDFBF7;
        }

        @media (max-width: 768px) {
            .gallery-panel {
                left: 50%;
                bottom: 12px;
                transform: translateX(-50%);
                width: calc(100% - 24px);
                max-width: 100%;
                padding: 16px;
            }
        }

        .nav-btn { position: relative; opacity: 0.6; transition: opacity 0.2s; }
        .nav-btn:hover { opacity: 1; }
        .nav-btn.active { opacity: 1; font-weight: 700; color: #CD2B2B; }
        .nav-btn.active::after { content: ''; position: absolute; bottom: -4px; left: 0; width: 100%; height: 2px; background: #CD2B2B; }

        .cave-chamber {
            background: radial-gradient(circle at top, rgba(37, 85, 255, 0.15), rgba(0, 0, 0, 0.85) 50%), #050505;
            border: 2px solid rgba(255, 255, 255, 0.08);
        }
        .cave-glyph-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 16px;
        }
        .cave-link {
            position: relative;
            display: inline-block;
            font-family: 'Space Mono', monospace;
            font-size: 18px;
            letter-spacing: 0.35em;
            color: #111;
            text-decoration: none;
            text-transform: uppercase;
            white-space: nowrap;
            padding: 10px 6px;
            text-shadow: 0 0 8px rgba(255, 255, 255, 0.12);
        }
        .cave-link::before {
            content: attr(data-glyph);
            position: absolute;
            inset: 10px 6px auto;
            color: #2555FF;
            width: 0;
            overflow: hidden;
            transition: width 0.35s ease;
            pointer-events: none;
            white-space: nowrap;
        }
        .cave-link::after {
            content: attr(data-tooltip);
            position: absolute;
            left: 50%;
            bottom: 100%;
            transform: translate(-50%, 12px) scale(0.6);
            opacity: 0;
            background: #111;
            color: #FDFBF7;
            padding: 6px 10px;
            border-radius: 999px;
            font-size: 10px;
            font-family: 'Space Mono', monospace;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            white-space: nowrap;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.35);
            transition: opacity 0.2s ease, transform 0.2s ease;
            pointer-events: none;
        }
        .cave-link:hover::before,
        .cave-link:focus-visible::before {
            width: 100%;
        }
        .cave-link:hover::after,
        .cave-link:focus-visible::after {
            opacity: 1;
            transform: translate(-50%, -6px) scale(1);
        }
        .cave-link--gag {
            cursor: help;
        }

        .trick-embed {
            aspect-ratio: 9 / 16;
            background: #111;
            position: relative;
            overflow: hidden;
        }
        .trick-embed iframe {
            width: 100%;
            height: 100%;
            border: 0;
        }
        .trick-embed::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(120deg, rgba(255, 255, 255, 0.08), rgba(255, 255, 255, 0.25), rgba(255, 255, 255, 0.08));
            opacity: 0.6;
            transform: translateX(-100%);
            animation: trick-sheen 1.6s infinite;
        }
        .trick-embed.is-loaded::before {
            opacity: 0;
            animation: none;
        }
        @keyframes trick-sheen {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        .trick-card {
            border: 1px solid #111;
            background: #fff;
            transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
        }
        .trick-card:hover,
        .trick-card:focus-within {
            transform: translateY(-4px);
            box-shadow: 0 16px 30px rgba(17, 17, 17, 0.15);
            border-color: #CD2B2B;
        }

        /* Modal Base */
        .modal-layer {
            position: fixed; inset: 0; background: rgba(253, 251, 247, 0.95); backdrop-filter: blur(8px);
            display: none; align-items: center; justify-content: center; z-index: 100;
            opacity: 0; transition: opacity 0.3s ease;
        }
        .modal-layer.active { display: flex; opacity: 1; }
        body.modal-open { overflow: hidden; }

        /* Glitch Effects */
        .glitch-text { position: relative; display: inline-block; }
        .glitch-text::before {
            content: attr(data-text); position: absolute; left: 2px; text-shadow: -1px 0 #CD2B2B;
            background: transparent; overflow: hidden; clip: rect(0, 900px, 0, 0);
            animation: glitch-anim 3s infinite linear alternate-reverse;
        }
        @keyframes glitch-anim {
            0% { clip: rect(42px, 9999px, 44px, 0); }
            5% { clip: rect(12px, 9999px, 59px, 0); }
            100% { clip: rect(4px, 9999px, 91px, 0); }
        }
        .era-shift {
            animation: eraTraverse 7s infinite;
        }
        @keyframes eraTraverse {
            0% { background: #111; color: #f8f1ea; border-color: #CD2B2B; font-family: 'Space Mono', monospace; letter-spacing: 0.22em; }
            18% { background: #0b2d4f; color: #3DFFB5; border-color: #3DFFB5; font-family: 'Cinzel', serif; letter-spacing: 0.28em; }
            36% { background: #f4d6b8; color: #4a2d1f; border-color: #4a2d1f; font-family: 'Space Grotesk', sans-serif; letter-spacing: 0.1em; }
            52% { background: #1a1a1a; color: #FFC54D; border-color: #FFC54D; font-family: 'Space Mono', monospace; letter-spacing: 0.24em; }
            70% { background: #FDFBF7; color: #111; border-color: #111; font-family: 'Space Grotesk', sans-serif; letter-spacing: 0.12em; }
            82% { background: #FDFBF7; color: #111; border-color: #111; font-family: 'Space Grotesk', sans-serif; letter-spacing: 0.12em; }
            100% { background: #111; color: #f8f1ea; border-color: #CD2B2B; font-family: 'Space Mono', monospace; letter-spacing: 0.22em; }
        }

        .glitch-banner {
            position: fixed;
            bottom: 12px;
            left: 50%;
            transform: translateX(-50%) translateY(140%);
            padding: 10px 18px;
            border: 2px solid #CD2B2B;
            font-size: 11px;
            text-transform: uppercase;
            z-index: 70;
            overflow: hidden;
            min-width: 260px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.22);
            transition: transform 0.6s cubic-bezier(0.25, 0.8, 0.25, 1);
        }
        .glitch-banner.active { transform: translateX(-50%) translateY(0); }
        .glitch-banner::before,
        .glitch-banner::after {
            content: '';
            position: absolute;
            inset: 0;
            mix-blend-mode: screen;
            opacity: 0;
            background: linear-gradient(90deg, rgba(205,43,43,0.24), rgba(255,244,235,0.12));
            animation: bannerGlitch 2.2s steps(2, end) infinite;
        }
        .glitch-banner::after { background: linear-gradient(90deg, rgba(255,244,235,0.14), rgba(205,43,43,0.28)); }
        @keyframes bannerGlitch {
            0% { opacity: 0; transform: translate(0,0); }
            20% { opacity: 0.3; transform: translate(-2px, 1px); }
            40% { opacity: 0.12; transform: translate(2px, -1px); }
            70% { opacity: 0.24; transform: translate(-1px, 1px); }
            100% { opacity: 0; transform: translate(0,0); }
        }

        .surveillance-popup {
            position: fixed;
            right: 20px;
            top: 92px;
            width: min(320px, 90vw);
            border: 2px solid #111;
            padding: 16px;
            box-shadow: 8px 12px 0 rgba(0,0,0,0.2);
            z-index: 120;
            opacity: 0;
            transform: translateY(-12px) scale(0.98);
            transition: opacity 0.4s ease, transform 0.4s ease;
            overflow: hidden;
        }
        .surveillance-popup.active {
            opacity: 1;
            transform: translateY(0) scale(1);
        }
        .spotify-overlay {
            position: fixed;
            right: 20px;
            bottom: 20px;
            width: min(360px, 92vw);
            background: #fff;
            border: 2px solid #111;
            border-radius: 16px;
            box-shadow: 10px 14px 0 rgba(0,0,0,0.2);
            z-index: 90;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: width 0.3s ease, box-shadow 0.3s ease;
        }
        .spotify-overlay__header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
            padding: 10px 14px;
            background: #111;
            color: #FDFBF7;
            font-family: 'Space Mono', monospace;
            text-transform: uppercase;
            letter-spacing: 0.22em;
            font-size: 10px;
        }
        .spotify-overlay__toggle {
            border: 1px solid #FDFBF7;
            padding: 4px 8px;
            text-transform: uppercase;
            font-size: 10px;
            letter-spacing: 0.2em;
            transition: background 0.2s ease, color 0.2s ease;
        }
        .spotify-overlay__toggle:hover {
            background: #FDFBF7;
            color: #111;
        }
        .spotify-overlay__body {
            height: 352px;
            transition: height 0.3s ease, opacity 0.3s ease;
        }
        .spotify-overlay__body iframe {
            width: 100%;
            height: 100%;
            border: 0;
        }
        .spotify-overlay.minimized {
            width: min(240px, 70vw);
            box-shadow: 6px 10px 0 rgba(0,0,0,0.18);
        }
        .spotify-overlay.minimized .spotify-overlay__body {
            height: 0;
            opacity: 0;
            pointer-events: none;
        }
        .surveillance-popup::before,
        .surveillance-popup::after {
            content: '';
            position: absolute;
            inset: 0;
            mix-blend-mode: screen;
            opacity: 0;
            background: linear-gradient(120deg, rgba(61,255,181,0.18), rgba(205,43,43,0.24));
            animation: bannerGlitch 2.8s steps(2, end) infinite;
        }
        .surveillance-popup::after {
            background: linear-gradient(90deg, rgba(255,244,235,0.15), rgba(37,85,255,0.3));
            animation-delay: 1.2s;
        }

        /* Integration Bar */
        .integration-bar { position: fixed; bottom: 0; left: 0; width: 100%; height: 6px; background: #eee; z-index: 90; }
        .integration-fill { height: 100%; background: #CD2B2B; width: 0%; transition: width 0.5s cubic-bezier(0.22, 1, 0.36, 1); }

        /* Loader */
        #loader { position: fixed; inset: 0; background: #FDFBF7; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.8s ease; }
        #loader.fade-out { opacity: 0; pointer-events: none; }
        .loader-bar-bg { width: 240px; height: 2px; background: #eee; margin-top: 20px; overflow: hidden; }
        .loader-bar-fill { height: 100%; width: 0%; background: #CD2B2B; transition: width 0.1s linear; }

        /* Evolving Cel Flow */
        .entropy-overlay {
            position: fixed;
            inset: 0;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.4s ease;
            background: repeating-radial-gradient(circle at 20% 20%, rgba(0,0,0,0.04) 0 2px, transparent 2px 6px),
                        repeating-linear-gradient(90deg, rgba(205,43,43,0.05) 0 1px, transparent 1px 6px);
            mix-blend-mode: multiply;
            z-index: 8;
        }
        body.entropy-1 .entropy-overlay { opacity: 0.3; }
        body.entropy-2 .entropy-overlay { opacity: 0.55; filter: hue-rotate(10deg) saturate(1.1); }
        body.entropy-3 .entropy-overlay { opacity: 0.8; filter: hue-rotate(24deg) saturate(1.3) contrast(1.1); }
        body.entropy-2 .view-section { transform: translateZ(0); }
        body.entropy-3 .view-section { filter: contrast(1.05) saturate(1.05); }

        .cel-card { border: 1px solid #111; background: #fff; padding: 16px; transition: transform 0.18s ease, box-shadow 0.18s ease; cursor: pointer; }
        .cel-card:hover { transform: translateY(-4px); box-shadow: 0 12px 24px rgba(0,0,0,0.12); }
        .cel-card.active { border-color: #CD2B2B; box-shadow: 0 0 0 2px #CD2B2B, 0 14px 30px rgba(0,0,0,0.18); }
        .cel-stage { font-size: 10px; letter-spacing: 0.28em; text-transform: uppercase; font-family: 'Space Mono', monospace; color: #6b7280; }
        .cel-badge { display: inline-flex; align-items: center; gap: 6px; padding: 4px 8px; border: 1px solid #111; font-size: 10px; letter-spacing: 0.2em; text-transform: uppercase; }
        .cel-detail { background: #fff; border: 1px solid #111; padding: 20px; position: relative; overflow: hidden; }
        .cel-detail::after { content: ''; position: absolute; inset: 0; background: linear-gradient(120deg, rgba(205,43,43,0.08), transparent 60%); opacity: 0; transition: opacity 0.3s ease; }
        body.entropy-2 .cel-detail::after { opacity: 1; }
        body.entropy-3 .cel-detail::after { opacity: 1; mix-blend-mode: multiply; }

        .role-card { transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1); }
        .role-card:hover { transform: translateY(-4px); border-color: #000; box-shadow: 4px 4px 0px #000; }
        .role-card.selected { background: #000; color: #fff; transform: scale(1.02); }
        .role-card.selected .role-desc { color: #ccc; }

        .sculpture-preview {
            border: 1px solid #111;
            background: linear-gradient(180deg, #fef8ef 0%, #f7efe6 100%);
            box-shadow: inset 0 0 0 1px rgba(0,0,0,0.04);
        }
        .sculpture-preview .grid {
            align-items: stretch;
        }
        .sculpture-canvas-shell {
            background: #f6f0e6;
            border: 1px solid rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .sculpture-canvas-shell canvas {
            display: block;
            width: 100%;
            height: auto;
        }
        .sculpture-readout {
            background: #fff;
            border: 1px solid rgba(0,0,0,0.12);
        }
        .sculpture-share-button {
            border: 1px solid #111;
            background: #fff;
            padding: 6px 10px;
            font-size: 10px;
            font-family: 'Space Mono', monospace;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            transition: transform 0.1s ease, box-shadow 0.1s ease;
        }
        .sculpture-share-button:hover:not(:disabled) { transform: translateY(-1px); box-shadow: 2px 2px 0 #111; }
        .sculpture-share-button:disabled { opacity: 0.4; cursor: not-allowed; }
        .sculpture-action-button { border: 2px solid #111; padding: 12px 16px; font-size: 11px; font-family: 'Space Mono', monospace; letter-spacing: 0.2em; text-transform: uppercase; transition: transform 0.1s ease, box-shadow 0.1s ease; width: 100%; }
        .sculpture-action-button:hover:not(:disabled) { transform: translateY(-1px); box-shadow: 3px 3px 0 #111; }
        .sculpture-action-button:disabled { opacity: 0.4; cursor: not-allowed; }

        .grift-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 14px; }
        .grift-card { background: #fffdf5; border: 1px solid #111; padding: 16px; border-radius: 14px; box-shadow: 0 14px 34px rgba(0,0,0,0.08); transition: transform 0.18s ease, box-shadow 0.18s ease, border-color 0.18s ease; }
        .grift-card:hover { transform: translateY(-4px); box-shadow: 0 18px 38px rgba(0,0,0,0.12); border-color: #cd2b2b; }
        .value-pill { display: inline-flex; align-items: center; gap: 6px; padding: 6px 10px; border: 1px solid #111; background: #fef3e6; font-size: 11px; letter-spacing: 0.12em; text-transform: uppercase; box-shadow: 2px 2px 0 rgba(0,0,0,0.12); }
        .geo-quiz-tile { display: flex; flex-direction: column; gap: 8px; align-items: flex-start; padding: 16px; border-radius: 12px; transition: transform 0.14s ease, box-shadow 0.14s ease, border-color 0.14s ease; text-align: left; background: #fff; }
        .geo-quiz-tile:hover { transform: translateY(-2px); box-shadow: 4px 8px 0 rgba(0,0,0,0.18); border-color: #0f0f0f; }
        .geo-quiz-tile.selected { border-color: #d31313; box-shadow: 0 0 0 2px #d31313, 6px 10px 0 rgba(0,0,0,0.14); }
        .depth-layer { display: none; }
        .view-section.depth-1 .depth-layer[data-depth="1"],
        .view-section.depth-2 .depth-layer[data-depth="1"],
        .view-section.depth-2 .depth-layer[data-depth="2"],
        .view-section.depth-3 .depth-layer[data-depth="1"],
        .view-section.depth-3 .depth-layer[data-depth="2"],
        .view-section.depth-3 .depth-layer[data-depth="3"] { display: block; }
        @media (max-width: 640px) {
            .grift-grid { grid-template-columns: 1fr; }
            .grift-card { padding: 18px; }
            .grift-card h3 { font-size: 1.05rem; }
            .grift-card p { font-size: 0.95rem; line-height: 1.45; }
            .value-pill { font-size: 11px; }
        }
    </style>
</head>

<body class="overflow-x-hidden">

    <div id="loader">
        <div class="font-mono text-xs uppercase tracking-[0.3em] mb-2 text-gray-500">Loomworks Operating System</div>
        <div class="text-4xl font-bold tracking-tighter">LOADING CONSTRUCT</div>
        <div class="loader-bar-bg"><div id="loader-progress" class="loader-bar-fill"></div></div>
    </div>

    <div class="scanline-layer"></div>
    <div id="entropy-overlay" class="entropy-overlay"></div>

    <nav class="fixed top-0 left-0 w-full z-50 bg-[#FDFBF7]/90 backdrop-blur border-b border-black/10 px-6 py-4 flex justify-between items-center">
        <div class="flex items-center gap-3 cursor-pointer ui-click" onclick="app.navigate('landing')">
            <div class="w-3 h-3 bg-loom-red"></div>
            <span class="font-bold tracking-widest text-sm font-mono uppercase">LOOMWORKS</span>
        </div>
        
        <div class="hidden lg:flex gap-8 text-[10px] font-mono tracking-widest uppercase items-center">
            <button onclick="app.navigate('landing')" class="nav-btn" data-target="landing">Index</button>
            <button onclick="app.navigate('calibration')" class="nav-btn" data-target="calibration">Context</button>
            <button onclick="app.navigate('profiler')" class="nav-btn text-loom-red font-bold" data-target="profiler">Identify</button>
            <div class="h-3 w-px bg-gray-300"></div>
            <button onclick="app.navigate('gallery')" class="nav-btn" data-target="gallery">Gallery</button>
            <button onclick="app.navigate('archive')" class="nav-btn" data-target="archive">Archive</button>
            <button onclick="app.navigate('grift')" class="nav-btn" data-target="grift">Grift Shop</button>
            <button onclick="app.navigate('trick-trough')" class="nav-btn" data-target="trick-trough">Trick Trough (ticky tocki tavi)</button>
            <div class="h-3 w-px bg-gray-300"></div>
            <button onclick="app.navigate('ambition')" class="nav-btn" data-target="ambition">Ambition</button>
            <button onclick="app.navigate('investors')" class="nav-btn" data-target="investors">Investors</button>
            <button onclick="window.location.href='sooploop.html'" class="nav-btn">Sooploop</button>
            <button onclick="siteMap.open()" class="nav-btn">Site Map</button>
            <button onclick="storyGate.open()" class="nav-btn">Story Engine</button>
        </div>

        <button onclick="document.getElementById('mobile-menu').classList.toggle('translate-x-full')" class="lg:hidden p-2 ui-click">
            <div class="space-y-1.5">
                <div class="w-6 h-0.5 bg-black"></div>
                <div class="w-6 h-0.5 bg-black"></div>
                <div class="w-6 h-0.5 bg-black"></div>
            </div>
        </button>
    </nav>

    <div id="mobile-menu" class="fixed inset-0 bg-[#FDFBF7] z-40 transform translate-x-full transition-transform duration-300 pt-24 px-8 overflow-y-auto border-l border-black">
        <div class="flex flex-col gap-6 text-xl font-mono uppercase tracking-widest">
            <button onclick="app.navigate('landing')" class="text-left pb-2 border-b border-gray-200">Index</button>
            <button onclick="app.navigate('calibration')" class="text-left pb-2 border-b border-gray-200">Context</button>
            <button onclick="app.navigate('profiler')" class="text-left pb-2 border-b border-gray-200 text-loom-red">Identify</button>
            <button onclick="app.navigate('gallery')" class="text-left pb-2 border-b border-gray-200">Gallery</button>
            <button onclick="app.navigate('grift')" class="text-left pb-2 border-b border-gray-200">Grift</button>
            <button onclick="app.navigate('trick-trough')" class="text-left pb-2 border-b border-gray-200">Trick Trough (ticky tocki tavi)</button>
            <button onclick="app.navigate('ambition')" class="text-left pb-2 border-b border-gray-200">Ambition</button>
            <button onclick="app.navigate('investors')" class="text-left pb-2 border-b border-gray-200">Investors</button>
            <button onclick="window.location.href='sooploop.html'" class="text-left pb-2 border-b border-gray-200">Sooploop</button>
            <button onclick="siteMap.open()" class="text-left pb-2 border-b border-gray-200">Site Map</button>
            <button onclick="storyGate.open()" class="text-left pb-2 border-b border-gray-200">Story Engine</button>
        </div>
        <button onclick="document.getElementById('mobile-menu').classList.add('translate-x-full')" class="mt-8 text-xs underline uppercase">Close Menu</button>
    </div>

    <div class="integration-bar"><div id="integration-fill" class="integration-fill"></div></div>
    <div id="surveillance-popup" class="surveillance-popup era-shift" role="dialog" aria-live="polite">
        <div class="text-[10px] font-mono uppercase tracking-[0.3em] text-gray-500">Surveillance Pop-Up</div>
        <div class="mt-2 text-sm font-bold uppercase">Observer Channel: Live</div>
        <p class="mt-2 text-xs font-mono text-gray-700 leading-relaxed">We are monitoring your gaze patterns for mythic drift. Stay still. Smile naturally. The era-stitcher is calibrating.</p>
        <div class="mt-3 flex items-center justify-between text-[10px] font-mono uppercase tracking-widest">
            <span class="text-loom-red">Signal: Active</span>
            <button id="surveillance-close" class="border border-black px-2 py-1 hover:bg-black hover:text-white transition-colors">Dismiss</button>
        </div>
    </div>
    <div id="glitch-banner" class="glitch-banner era-shift" aria-live="polite">HOW MUCH DO YOU COST? :(/:)</div>
    <div id="spotify-overlay" class="spotify-overlay" aria-label="Playlist overlay">
        <div class="spotify-overlay__header">
            <span>Field Playlist</span>
            <button id="spotify-toggle" class="spotify-overlay__toggle" type="button" aria-expanded="true">Minimize</button>
        </div>
        <div class="spotify-overlay__body">
            <iframe src="https://open.spotify.com/embed/playlist/0bDJZ89nH6RHIpPE8WMcfw?utm_source=generator&theme=0" title="Loomworks field playlist" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" loading="lazy"></iframe>
        </div>
    </div>

    <section id="view-landing" class="view-section active">
        <div class="max-w-7xl mx-auto px-6 py-20 blueprint min-h-[80vh] flex flex-col gap-16">
            <div>
                <div class="inline-block border border-black px-2 py-1 text-[10px] font-mono tracking-widest uppercase bg-white mb-6 w-fit">Field Materials Case Study #902</div>
                <h1 class="text-6xl md:text-9xl font-bold tracking-tighter mb-6 glitch-text" data-text="DOMESTIC PRODUCT">DOMESTIC PRODUCT</h1>
                <p class="max-w-3xl text-xl font-mono leading-relaxed text-gray-700 mb-8">
                    An alchemical exchange of Mickey, Monroe, and Muppets. A Tonka-color culture lab where Dima, the actress, mutates into Dime — an avatar of myth and IP incarnate. A monster. A smart cookie. A little wonky.
                </p>
                <div class="bg-black text-white px-6 py-4 inline-flex items-center gap-3 font-mono text-xs uppercase tracking-widest">
                    <span class="text-tonka-gold">Thesis</span>
                    <span>Happiness DOES have a cost, but it's not fixed. What does it take to build the happiest place on Earth?</span>
                </div>
                <div class="mt-6 flex flex-wrap gap-4 text-[10px] font-mono uppercase tracking-widest">
                    <div class="bg-white border border-black px-4 py-2">TikTok Velocity</div>
                    <div class="bg-black text-white px-4 py-2">28.2K Followers</div>
                    <div class="bg-black text-white px-4 py-2">265.8K Likes</div>
                    <div class="bg-white border border-black px-4 py-2">3 Weeks</div>
                </div>
            </div>

            <div class="grid lg:grid-cols-[1.1fr_0.9fr] gap-10">
                <div class="space-y-6">
                    <div class="bg-white border border-black/10 p-6 shadow-sm hover:shadow-md transition-shadow">
                        <h3 class="font-mono text-xs uppercase tracking-widest text-loom-red mb-2">The Construct</h3>
                        <p class="text-sm">A museum-meets-immersive theater installation. Real animation artifacts, Lantern attendants, and a living digital interface.</p>
                    </div>
                    <div class="bg-black text-white p-6 shadow-lg">
                        <h3 class="font-mono text-xs uppercase tracking-widest text-gray-400 mb-2">The Purpose</h3>
                        <p class="text-sm">To examine how icons are manufactured, circulated, controlled, and reclaimed. The economics of magic.</p>
                    </div>
                    <div class="bg-white border border-black/10 p-6 shadow-sm hover:shadow-md transition-shadow">
                        <h3 class="font-mono text-xs uppercase tracking-widest text-loom-red mb-2">The Layers</h3>
                        <p class="text-sm">Lantern Protocol, The Archive, Celli Software, and the Grift Shop economy.</p>
                    </div>
                </div>

                <div class="bg-white border-2 border-black p-6 shadow-[6px_6px_0px_rgba(0,0,0,1)] space-y-5">
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">The Script (Linear)</div>
                    <div class="space-y-4 text-sm">
                        <div class="flex items-start gap-3">
                            <div class="w-8 h-8 bg-tonka-cobalt text-white flex items-center justify-center font-bold text-xs">01</div>
                            <div>
                                <div class="font-bold uppercase">The Hook</div>
                                <div class="text-xs text-gray-500">Meet Dime Lane. TikTok velocity, dream logic, a face becoming myth.</div>
                            </div>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="w-8 h-8 bg-tonka-gold text-black flex items-center justify-center font-bold text-xs">02</div>
                            <div>
                                <div class="font-bold uppercase">The Alchemical Exchange</div>
                                <div class="text-xs text-gray-500">1934 Mickey acquisition, Henson artifacts, and the swap market of nostalgia.</div>
                            </div>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="w-8 h-8 bg-tonka-mint text-black flex items-center justify-center font-bold text-xs">03</div>
                            <div>
                                <div class="font-bold uppercase">The Lab</div>
                                <div class="text-xs text-gray-500">Loomworks, the 4D Musical Spreadsheet, and the Celli voxel engine.</div>
                            </div>
                        </div>
                        <div class="flex items-start gap-3">
                            <div class="w-8 h-8 bg-tonka-plum text-white flex items-center justify-center font-bold text-xs">04</div>
                            <div>
                                <div class="font-bold uppercase">The Pitch</div>
                                <div class="text-xs text-gray-500">Low overhead, revenue split, and the Domestic Product thesis.</div>
                            </div>
                        </div>
                    </div>
                    <div class="flex flex-col gap-3 pt-4 border-t border-black/10">
                        <button onclick="app.navigate('calibration')" class="ui-click bg-black text-white px-6 py-4 text-xs font-mono uppercase tracking-widest hover:bg-loom-red transition-colors flex items-center justify-between">
                            Start the Script <span>&rarr;</span>
                        </button>
                        <button onclick="app.fullBlastOff()" class="ui-click bg-loom-red text-white px-6 py-4 text-xs font-mono uppercase tracking-widest hover:bg-black transition-colors flex items-center justify-between">
                            FULL BLAST OFF <span>&uarr;</span>
                        </button>
                        <button onclick="siteMap.open()" class="ui-click border-2 border-black bg-white px-6 py-3 text-xs font-mono uppercase tracking-widest hover:bg-black hover:text-white transition-colors">
                            Open the Site Map
                        </button>
                    </div>
                    <div class="depth-layer mt-4 border border-black/10 bg-white p-4 text-[10px] font-mono uppercase tracking-[0.3em] text-gray-600" data-depth="2">
                        Depth Sync: landing expansion unlocked.
                    </div>
                </div>
            </div>

            <div class="grid lg:grid-cols-[0.6fr_1.4fr] gap-10 items-start">
                <div class="space-y-6">
                    <div class="border-2 border-black bg-white p-6">
                        <h3 class="font-bold uppercase text-sm mb-3">Dima &rarr; Dime</h3>
                        <p class="text-xs font-mono text-gray-600 leading-relaxed">
                            Dima begins as the actress. Dime is the avatar that survives the scroll. The name is a cost, a coin, a metric. The persona becomes a domestic product, produced by the Lab and delivered to the room.
                        </p>
                        <div class="mt-4 text-[10px] font-mono uppercase tracking-widest text-loom-red">Identity loop: human &rarr; myth &rarr; interface</div>
                    </div>
                    <div class="bg-white border-2 border-black p-6 shadow-[4px_4px_0px_rgba(0,0,0,1)]">
                        <h3 class="font-bold uppercase text-sm mb-3">The Mensch Manifesto</h3>
                        <p class="text-xs font-mono text-gray-600 leading-relaxed mb-3">
                            Trauma and fortune are both dumb luck. The agency is in the response: kindness as the default setting. We turn suffering into meaningful productivity loss and build the opposite of pain — a sanctuary of wonder.
                        </p>
                        <div class="text-[10px] font-mono uppercase tracking-widest text-loom-red">Systemic Grace &middot; Opposite of suffering</div>
                    </div>
                    <div class="bg-black text-white p-6">
                        <h3 class="font-bold uppercase text-sm mb-3 text-tonka-mint">The Site Map (Exploratory)</h3>
                        <p class="text-xs font-mono text-gray-300 leading-relaxed">A Loom Map hand-drawing rendered as clickable nodes. sun.settings, Under/Over, Lumania Cent, and more.</p>
                        <button onclick="siteMap.open()" class="mt-4 ui-click border border-white/30 px-4 py-2 text-[10px] uppercase tracking-widest hover:bg-white hover:text-black transition-colors">View Nodes</button>
                    </div>
                </div>

                <div class="space-y-6">
                    <div class="bg-white border border-black p-6 shadow-lg">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="font-bold uppercase text-sm">Multimedia Nodes</h3>
                            <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">Philosophy Layer</div>
                        </div>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="border border-black/10 p-4">
                                <div class="text-[10px] font-mono uppercase tracking-widest text-loom-red mb-2">The Conflict</div>
                                <div class="text-xs font-mono text-gray-500 mb-2">Argument Clinic</div>
                                <div class="aspect-video bg-black">
                                    <iframe class="w-full h-full" src="https://www.youtube.com/embed/ohDB5gbtaEQ" title="Argument Clinic" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                </div>
                            </div>
                            <div class="border border-black/10 p-4">
                                <div class="text-[10px] font-mono uppercase tracking-widest text-loom-red mb-2">The Humanity</div>
                                <div class="text-xs font-mono text-gray-500 mb-2">People of the Land (Gene Wilder)</div>
                                <div class="aspect-video bg-black">
                                    <iframe class="w-full h-full" src="https://www.youtube.com/embed/KHJbSvidohg" title="Common Clay" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                </div>
                            </div>
                            <div class="border border-black/10 p-4">
                                <div class="text-[10px] font-mono uppercase tracking-widest text-loom-red mb-2">The Observation</div>
                                <div class="text-xs font-mono text-gray-500 mb-2">Candid Camera</div>
                                <div class="aspect-video bg-black">
                                    <iframe class="w-full h-full" src="https://www.youtube.com/embed/B8E_mpcowmY" title="Candid Camera" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                </div>
                            </div>
                            <div class="border border-black/10 p-4">
                                <div class="text-[10px] font-mono uppercase tracking-widest text-loom-red mb-2">The Calculation</div>
                                <div class="text-xs font-mono text-gray-500 mb-2">Abbott &amp; Costello</div>
                                <div class="aspect-video bg-black">
                                    <iframe class="w-full h-full" src="https://www.youtube.com/embed/2LZsJb7_D7Q" title="Abbott and Costello" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                </div>
                            </div>
                            <div class="border border-black/10 p-4">
                                <div class="text-[10px] font-mono uppercase tracking-widest text-loom-red mb-2">The Rerun</div>
                                <div class="text-xs font-mono text-gray-500 mb-2">Candid Camera (Extra)</div>
                                <div class="aspect-video bg-black">
                                    <iframe class="w-full h-full" src="https://www.youtube.com/embed/7zLwa4bztWs" title="Candid Camera extra sketch" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                </div>
                            </div>
                            <div class="border border-black/10 p-4">
                                <div class="text-[10px] font-mono uppercase tracking-widest text-loom-red mb-2">The Timing</div>
                                <div class="text-xs font-mono text-gray-500 mb-2">Abbott &amp; Costello (Extra)</div>
                                <div class="aspect-video bg-black">
                                    <iframe class="w-full h-full" src="https://www.youtube.com/embed/6dsQtBHk0eE" title="Abbott and Costello extra sketch" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                                </div>
                            </div>
                        </div>
                        <p class="mt-5 text-[10px] font-mono uppercase tracking-widest text-gray-500">Link doesn't work? LOOK IT UP, SILLY.</p>
                    </div>
                    <div class="bg-white border border-black p-6 shadow-lg">
                        <div class="text-[10px] font-mono uppercase tracking-widest text-loom-red mb-2">Recommended Products (No Sponsored Links, AGAIN LOOK IT UP, SHEESH)</div>
                        <h3 class="font-bold uppercase text-sm mb-3">Signal Kits</h3>
                        <ul class="text-xs font-mono text-gray-600 leading-relaxed space-y-2">
                            <li><span class="font-bold text-gray-900">GIPF Series</span> — abstracted gravity wells, real-time grift detection.</li>
                            <li><span class="font-bold text-gray-900">Splotter Spielen</span> — hand-cranked chaos logistics for serious table nights.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="grid lg:grid-cols-[1.2fr_0.8fr] gap-10 items-start">
                <div class="bg-white border border-black p-6 shadow-lg">
                    <h3 class="font-bold uppercase text-sm mb-4">Artifacts of the Loom</h3>
                    <div class="grid md:grid-cols-2 gap-4">
                        <details class="border border-black/10 p-4 group">
                            <summary class="cursor-pointer font-mono text-xs uppercase tracking-widest text-loom-red">1934 Mickey Acquisition</summary>
                            <p class="text-xs text-gray-600 mt-3">The receipt that started the swap. Proof that myth can be bought, licensed, and reanimated.</p>
                        </details>
                        <details class="border border-black/10 p-4 group">
                            <summary class="cursor-pointer font-mono text-xs uppercase tracking-widest text-loom-red">Medusa Wedgwood</summary>
                            <p class="text-xs text-gray-600 mt-3">The brutalist anchor. Luxury history for Mice and Monsters.</p>
                        </details>
                        <details class="border border-black/10 p-4 group">
                            <summary class="cursor-pointer font-mono text-xs uppercase tracking-widest text-loom-red">Antique Spinning Wheel</summary>
                            <p class="text-xs text-gray-600 mt-3">The literal Loom. A physical engine for myth-making in real time.</p>
                        </details>
                        <details class="border border-black/10 p-4 group">
                            <summary class="cursor-pointer font-mono text-xs uppercase tracking-widest text-loom-red">Ring Collection</summary>
                            <p class="text-xs text-gray-600 mt-3">Sideways integration: carnelian, masked turquoise, brutalist silver. Vibes and algorithms tell the story.</p>
                        </details>
                    </div>
                </div>
                <div class="bg-black text-white p-6 shadow-lg">
                    <h3 class="font-bold uppercase text-sm mb-4 text-tonka-gold">Celli Voxel Field</h3>
                    <p class="text-xs font-mono text-gray-400 mb-4">A low-fidelity voxel grid that responds to your cursor — the 3D spatial spreadsheet in miniature.</p>
                    <div class="border border-white/20 p-2 bg-[#0b0b0b]">
                        <canvas id="voxel-celli" width="360" height="240" class="w-full h-auto"></canvas>
                    </div>
                </div>
            </div>

            <div class="bg-white border-2 border-black p-6 shadow-lg space-y-6">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                    <div>
                        <div class="cel-stage">Evolving Flow</div>
                        <h3 class="text-2xl font-bold uppercase tracking-tight">Cel Atlas (Return for More)</h3>
                        <p class="text-sm text-gray-600 max-w-2xl">Each cel is a memory frame. Revisit a cel to unpack more detail. The system learns your attention and rewrites itself.</p>
                    </div>
                    <div class="cel-badge">Entropy Index <span id="entropy-count">0</span></div>
                </div>
                <div id="cel-grid" class="grid md:grid-cols-3 gap-4"></div>
                <div id="cel-detail" class="cel-detail">
                    <div class="cel-stage" id="cel-stage-label">Stage 00</div>
                    <h4 class="text-xl font-bold uppercase tracking-tight mt-2" id="cel-title">Select a cel</h4>
                    <p class="text-sm text-gray-700 mt-3" id="cel-copy">The atlas stays quiet until you return. Pick any card to begin the sequence.</p>
                    <p class="text-[11px] font-mono uppercase tracking-[0.25em] text-gray-500 mt-4" id="cel-whisper">Return count: 0</p>
                </div>
            </div>

            <div class="cave-chamber px-6 py-10 shadow-[0_20px_40px_rgba(0,0,0,0.35)]">
                <div class="flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6">
                    <div class="space-y-3 max-w-3xl">
                        <div class="text-[10px] font-mono uppercase tracking-[0.3em] text-tonka-mint">Subterranean Patch Notes</div>
                        <h3 class="text-3xl md:text-4xl font-bold uppercase tracking-tight text-white">Al Gregory Cave's Johnson Hidey Hole</h3>
                        <p class="text-sm font-mono text-gray-300 leading-relaxed">
                            A funny techy Plato parody: the coders in the cave argue over shadow renders while the pager light paints the wall. Every glitch is a revelation, every cache miss is a revelation of a revelation, and the only true form is a deprecated API doc they keep interpreting as prophecy.
                        </p>
                    </div>
                    <div class="bg-black/60 border border-white/10 px-4 py-3 text-[10px] font-mono uppercase tracking-[0.25em] text-gray-300">
                        Cave Wall Syntax: hover to decode.
                    </div>
                </div>

                <div class="mt-8 cave-glyph-grid">
                    <a class="cave-link" data-cave-item data-label="zombo.com" data-tooltip="zombo.com" data-url="https://zombo.com" href="https://zombo.com" target="_blank" rel="noopener"></a>
                    <a class="cave-link" data-cave-item data-label="divorcedatforty.help" data-tooltip="divorcedatforty.help" data-url="https://divorcedatforty.help" href="https://divorcedatforty.help" target="_blank" rel="noopener"></a>
                    <span class="cave-link cave-link--gag" data-cave-item data-label="HELP HELP HELP HELP HELP HELP" data-tooltip="HELP HELP HELP HELP HELP HELP"></span>
                    <span class="cave-link cave-link--gag" data-cave-item data-label="married at 42" data-tooltip="married at 42"></span>
                    <a class="cave-link" data-cave-item data-label="increpare.com" data-tooltip="increpare.com" data-url="https://www.increpare.com" href="https://www.increpare.com" target="_blank" rel="noopener"></a>
                </div>
            </div>

            <div class="border-t border-black pt-8 flex justify-between items-center">
                <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">Begin the sequence</div>
                <button onclick="app.navigate('calibration')" class="ui-click bg-black text-white px-6 py-4 text-xs font-mono uppercase tracking-widest hover:bg-loom-red transition-colors flex items-center gap-2">
                    Next: Calibration Protocol <span>&rarr;</span>
                </button>
            </div>
        </div>
    </section>

    <section id="view-calibration" class="view-section">
        <div class="max-w-5xl mx-auto px-6 py-12">
            <div class="text-center mb-16">
                <div class="inline-flex items-center gap-2 border border-black px-3 py-1 text-[10px] font-mono uppercase tracking-widest bg-white">Step 1: Calibration</div>
                <h2 class="text-5xl font-bold uppercase tracking-tight mt-4">Explain Like I'm Dima</h2>
                <p class="max-w-2xl mx-auto mt-4 text-gray-600 font-mono text-sm">Before we classify you, you must understand the rules of the world.</p>
            </div>

            <div class="grid md:grid-cols-2 gap-8 mb-12">
                <div class="bg-white border border-black/10 p-8 rounded-xl shadow-lg">
                    <h3 class="font-bold text-xl mb-2">The Silhouette</h3>
                    <p class="text-sm text-gray-700 leading-relaxed">Imagine a corporation that doesn’t sell widgets, but sells Meaning. It looks like a museum, it sounds like a discography, and it feels like a bureaucratic theology that you already belong to.</p>
                </div>
                <div class="bg-black text-white p-8 rounded-xl shadow-lg">
                    <h3 class="font-bold text-xl mb-2 text-loom-red">The Reality</h3>
                    <p class="text-sm text-gray-300 leading-relaxed">Loomworks is a biting satire. A playable critique of optimization and red tape. We use "Skibidi" speed to stand on the chest of slow institutions.</p>
                </div>
            </div>

            <div class="bg-[#0b0b0b] text-white p-8 rounded-xl border border-red-900/50">
                <h3 class="font-mono text-xs uppercase tracking-widest text-loom-red mb-4">Calibration Gate</h3>
                <div class="grid md:grid-cols-2 gap-6">
                    <div>
                        <p class="font-bold mb-2">Query 01: Experience</p>
                        <p class="text-xs text-gray-400 mb-2">Have you played an Alternate Reality Game before?</p>
                        <div class="flex gap-2">
                            <button class="border border-white/20 px-3 py-2 text-xs uppercase hover:bg-white hover:text-black transition-colors ui-click">Yes</button>
                            <button class="border border-white/20 px-3 py-2 text-xs uppercase hover:bg-white hover:text-black transition-colors ui-click">No</button>
                        </div>
                    </div>
                    <div>
                        <p class="font-bold mb-2">Query 02: Lumen Level</p>
                        <p class="text-xs text-gray-400 mb-2">How much satire do you want revealed?</p>
                        <div class="flex gap-2">
                            <button class="border border-white/20 px-3 py-2 text-xs uppercase hover:bg-white hover:text-black transition-colors ui-click">Full Immersion</button>
                            <button class="border border-white/20 px-3 py-2 text-xs uppercase hover:bg-white hover:text-black transition-colors ui-click">Break Character</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="border-t border-black mt-20 pt-8 flex justify-end">
                <button onclick="app.navigate('profiler')" class="ui-click bg-black text-white px-6 py-4 text-xs font-mono uppercase tracking-widest hover:bg-loom-red transition-colors flex items-center gap-2">
                    Next: Identity Assessment <span>&rarr;</span>
                </button>
            </div>
        </div>
    </section>

    <section id="view-profiler" class="view-section">
        <div id="prof-banner" class="hidden w-full bg-white border-b border-black py-4 px-6 sticky top-[57px] z-40 shadow-md transition-all">
            <div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
                <div>
                    <div class="text-[10px] font-mono text-gray-400 uppercase tracking-widest">Classification Locked</div>
                    <h2 class="text-2xl md:text-3xl font-bold uppercase text-red-600" id="banner-title">Identity Stored</h2>
                </div>
                <div class="flex gap-4 items-center">
                    <p class="hidden md:block font-mono text-xs italic text-gray-600 mr-4" id="banner-motto">Prepared for entry.</p>
                    <button onclick="app.navigate('gallery')" class="bg-black text-white px-4 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-red-600">Enter Gallery</button>
                </div>
            </div>
        </div>

        <div class="max-w-5xl mx-auto px-6 pb-12 w-full flex flex-col gap-8">
            <div class="text-center space-y-4">
                <div class="inline-flex items-center gap-2 border border-black px-3 py-1 text-[10px] font-mono uppercase tracking-widest bg-white">Identity Quiz</div>
                <h2 class="text-4xl md:text-5xl font-bold uppercase tracking-tight leading-tight">Choose your signal</h2>
                <p class="font-mono text-sm text-gray-700 leading-relaxed max-w-3xl mx-auto">Pick your lane and we will open a sealed quiz overlay to confirm it, then mint a shareable sculpture identity artifact.</p>
            </div>

            <div class="bg-white border border-black rounded-xl shadow-xl overflow-hidden" id="prof-shell">
                <div class="p-6 space-y-6" id="prof-content-area">
                    <div id="calibration-gate" class="bg-[#0b0b0b] text-white rounded-xl p-5 space-y-5 shadow-[6px_6px_0px_0px_rgba(205,43,43,1)]">
                        <div class="flex flex-wrap items-center justify-between gap-3">
                            <div>
                                <div class="text-[10px] font-mono uppercase tracking-[0.25em] text-red-200">Calibration Gate</div>
                                <h3 class="text-2xl font-bold">Threshold Selection</h3>
                            </div>
                            <div id="lumen-readout" class="font-mono text-xs uppercase tracking-widest px-3 py-1 border border-white/20 rounded-full bg-white/5">Lumen Level: Unset</div>
                        </div>
                        <p class="text-sm leading-relaxed text-gray-100">Set your transparency level before the Identity Assessment. Answer the ARG check, choose your entrance style, and opt into extra light if you need it.</p>
                        <div class="grid md:grid-cols-2 gap-4">
                            <div class="space-y-2">
                                <div class="font-bold">[Query 01]</div>
                                <p class="font-mono text-[11px] uppercase tracking-widest text-red-200">Have you played an ARG before?</p>
                                <div class="grid grid-cols-2 gap-2">
                                    <button data-cal-group="arg" data-cal-choice="yes" onclick="calibrationGate.setArg(true, this)" class="cal-choice border border-white/30 bg-white/5 px-3 py-3 text-sm font-mono uppercase tracking-widest hover:bg-white/10 rounded-lg">Yes</button>
                                    <button data-cal-group="arg" data-cal-choice="no" onclick="calibrationGate.setArg(false, this)" class="cal-choice border border-white/30 bg-white/5 px-3 py-3 text-sm font-mono uppercase tracking-widest hover:bg-white/10 rounded-lg">No</button>
                                </div>
                            </div>
                            <div class="space-y-2">
                                <div class="font-bold">[Query 02]</div>
                                <p class="font-mono text-[11px] uppercase tracking-widest text-red-200">How do you wish to enter the Loomworks?</p>
                                <div class="grid grid-cols-2 gap-2">
                                    <button data-cal-group="entry" data-cal-choice="blind" onclick="calibrationGate.setEntry('blind', this)" class="cal-choice border border-white/30 bg-white/5 px-3 py-3 text-sm font-mono uppercase tracking-widest hover:bg-white/10 rounded-lg">Go in Blind</button>
                                    <button data-cal-group="entry" data-cal-choice="light" onclick="calibrationGate.setEntry('light', this)" class="cal-choice border border-white/30 bg-white/5 px-3 py-3 text-sm font-mono uppercase tracking-widest hover:bg-white/10 rounded-lg">With a Little Light</button>
                                </div>
                            </div>
                        </div>
                        <div class="grid md:grid-cols-3 gap-3 bg-white/5 border border-white/10 rounded-lg p-4">
                            <label class="flex items-start gap-2 text-sm text-gray-100"><input type="checkbox" class="mt-1 cal-light" onchange="calibrationGate.toggleLight('history', this.checked)"><span><span class="font-bold">History</span>: Track the resonance cascade via I Love Bees, Slusho, Why So Serious?, and Flynn Lives.</span></label>
                            <label class="flex items-start gap-2 text-sm text-gray-100"><input type="checkbox" class="mt-1 cal-light" onchange="calibrationGate.toggleLight('form', this.checked)"><span><span class="font-bold">Form</span>: Enter diegetically; the Barter Post and Lanterns believe this is their world.</span></label>
                            <label class="flex items-start gap-2 text-sm text-gray-100"><input type="checkbox" class="mt-1 cal-light" onchange="calibrationGate.toggleLight('intent', this.checked)"><span><span class="font-bold">Intent</span>: Hold the Skibidi-speed collision of legacy icons and absurdist velocity.</span></label>
                        </div>
                        <div class="flex flex-wrap items-center gap-3 justify-between">
                            <div id="calibration-status" class="font-mono text-xs text-gray-200 uppercase tracking-widest">Set your lumen level to tune how much satire you see.</div>
                            <button onclick="calibrationGate.confirm()" class="ui-click bg-white text-black px-4 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-red-600 hover:text-white transition-colors">Lock Lumen Level</button>
                        </div>
                    </div>

                    <div id="prof-stage-locked" class="border border-dashed border-red-400 bg-red-50 text-red-700 p-4 rounded-lg text-sm font-mono uppercase tracking-widest text-center">Complete the Calibration Gate to unlock the Identity Assessment.</div>

                    <div id="prof-stage-select" class="space-y-5 hidden">
                        <p class="font-mono text-xs text-gray-600 text-center uppercase tracking-widest">Pick your lane. A focused quiz will open in a separate overlay to confirm your classification.</p>
                        <div class="grid grid-cols-1 md:grid-cols-5 gap-3">
                            <button onclick="profiler.select('dreamer', this)" class="role-card border border-gray-200 p-4 text-left hover:bg-white bg-white/70 ui-click rounded-lg">
                                <div class="text-lg font-bold uppercase mb-1">Dreamer</div>
                                <div class="role-desc font-mono text-[10px] text-gray-500 leading-tight">Hunts for resonance and lyrical angles.</div>
                            </button>
                            <button onclick="profiler.select('scholar', this)" class="role-card border border-gray-200 p-4 text-left hover:bg-white bg-white/70 ui-click rounded-lg">
                                <div class="text-lg font-bold uppercase mb-1">Scholar</div>
                                <div class="role-desc font-mono text-[10px] text-gray-500 leading-tight">Documents provenance and keeps the receipts.</div>
                            </button>
                            <button onclick="profiler.select('investor', this)" class="role-card border border-gray-200 p-4 text-left hover:bg-white bg-white/70 ui-click rounded-lg">
                                <div class="text-lg font-bold uppercase mb-1">Investor</div>
                                <div class="role-desc font-mono text-[10px] text-gray-500 leading-tight">Measures upside; tracks viable returns.</div>
                            </button>
                            <button onclick="profiler.select('passerby', this)" class="role-card border border-gray-200 p-4 text-left hover:bg-white bg-white/70 ui-click rounded-lg">
                                <div class="text-lg font-bold uppercase mb-1">Passerby</div>
                                <div class="role-desc font-mono text-[10px] text-gray-500 leading-tight">Arrives without baggage; reads the room plainly.</div>
                            </button>
                            <button onclick="profiler.select('lantern', this)" class="role-card border border-gray-200 p-4 text-left hover:bg-white bg-white/70 ui-click rounded-lg">
                                <div class="text-lg font-bold uppercase mb-1">Lantern</div>
                                <div class="role-desc font-mono text-[10px] text-gray-500 leading-tight">Carries the story; keeps guests oriented.</div>
                            </button>
                        </div>
                    </div>

                    <div id="prof-stage-doubt" class="hidden text-center border border-black p-8 bg-[#FDFBF7] shadow-[6px_6px_0px_0px_rgba(205,43,43,1)] rounded-lg">
                        <h3 class="text-3xl font-bold uppercase mb-3 text-red-600">Are you sure?</h3>
                        <p class="font-mono text-xs mb-6 leading-relaxed text-gray-700">
                            Your self-classification clashes with most visitor patterns. We'll open a focused pop-up quiz to test it without pinning anything to the top of the page.
                        </p>
                        <div class="flex gap-4 justify-center flex-wrap">
                            <button onclick="profiler.reset()" class="ui-click border-b-2 border-gray-300 hover:border-black text-xs font-mono uppercase pb-1">Reconsider</button>
                            <button onclick="profiler.startQuiz()" class="ui-click bg-black text-white px-6 py-3 text-xs font-mono uppercase tracking-widest hover:bg-red-600 transition-colors">Launch Verification Pop-up</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="prof-result-card" class="hidden grid md:grid-cols-3 gap-4 items-start">
                <div class="md:col-span-2 bg-white border border-black rounded-xl p-6 shadow-lg">
                    <div class="text-[10px] font-mono uppercase tracking-widest text-red-600 mb-2">Assessment Complete</div>
                    <div class="font-bold text-2xl mb-1" id="result-title">Identity Stored</div>
                    <div class="font-mono text-sm text-gray-600 mb-4" id="result-motto">Proceed to Gallery or sculpt.</div>
                    <p class="text-sm text-gray-600">Your badge is pinned above. Use the Sculpture Generator to mint a bespoke artifact from your profile, or drop straight into the gallery.</p>
                </div>
                <div class="bg-white border border-gray-200 rounded-xl p-6 shadow-sm space-y-3">
                    <div class="font-mono text-[10px] uppercase tracking-widest text-gray-500">Next</div>
                    <button onclick="app.navigate('gallery')" class="ui-click w-full border border-black bg-white px-3 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-black hover:text-white transition-colors">Gallery</button>
                    <button onclick="app.navigate('ambition')" class="ui-click w-full border border-black bg-white px-3 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-black hover:text-white transition-colors">Ambition Blueprint</button>
                </div>
            </div>

            <div id="sculpture-generator" class="hidden bg-white border border-black rounded-xl shadow-xl p-6 grid md:grid-cols-2 gap-6">
                <div class="space-y-3">
                    <div class="font-mono text-[10px] uppercase tracking-widest text-red-600">Sculpture / Art Generator</div>
                    <h3 class="text-2xl font-bold">Generate a signal artifact</h3>
                    <p class="text-sm text-gray-600">We translate your classification into a compact blueprint: material suggestions, silhouette, and a mood palette ready for fabrication or AI pipelines.</p>
                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
                        <label class="text-xs font-mono uppercase tracking-widest text-gray-600 flex flex-col gap-1">Material Bias
                            <select id="sculpture-material" class="border border-gray-300 px-2 py-2 text-sm">
                                <option>Cast glass + steel</option>
                                <option>Folded paper + neon</option>
                                <option>Reclaimed plastic + resin</option>
                                <option>Stone powder + pigment</option>
                            </select>
                        </label>
                        <label class="text-xs font-mono uppercase tracking-widest text-gray-600 flex flex-col gap-1">Format
                            <select id="sculpture-format" class="border border-gray-300 px-2 py-2 text-sm">
                                <option>Table-top maquette</option>
                                <option>Wall relief</option>
                                <option>Suspended mobile</option>
                                <option>Floor totem</option>
                            </select>
                        </label>
                        <label class="text-xs font-mono uppercase tracking-widest text-gray-600 flex flex-col gap-1">Render Mode
                            <select id="sculpture-mode" class="border border-gray-300 px-2 py-2 text-sm">
                                <option value="2d" selected>2D (Current)</option>
                                <option value="3d">3D (Legacy)</option>
                            </select>
                        </label>
                    </div>
                    <button onclick="profiler.generateSculpture()" class="ui-click bg-black text-white px-4 py-3 text-[10px] font-mono uppercase tracking-widest hover:bg-red-600">Generate Blueprint</button>
                    <div class="grid grid-cols-1 gap-3 pt-2">
                        <button id="add-to-gallery" onclick="profiler.addToGallery()" class="ui-click sculpture-action-button bg-red-600 text-white hover:bg-red-700" disabled>ADD TO GALLERY</button>
                        <button id="send-to-grift" onclick="profiler.sendToGriftShop()" class="ui-click sculpture-action-button bg-black text-white hover:bg-loom-red" disabled>Send to the Grift Shop</button>
                    </div>
                </div>
                <div class="sculpture-preview rounded-lg p-4" id="sculpture-preview">
                    <div class="grid md:grid-cols-2 gap-5 lg:gap-6">
                        <div class="sculpture-canvas-shell rounded-lg overflow-hidden" id="sculpture-canvas-shell">
                            <canvas id="sculpture-canvas" width="420" height="260" aria-label="Sculpture preview"></canvas>
                        </div>
                        <div class="sculpture-readout rounded-lg p-4 font-mono text-xs flex flex-col gap-4 justify-between" id="sculpture-readout">
                            <div class="space-y-2">
                                <div class="text-[10px] uppercase tracking-widest text-gray-500">Awaiting prompt...</div>
                                <p class="text-sm text-gray-700">Run the quiz and generate a specimen to see the deterministic sketch and dossier.</p>
                            </div>
                            <div class="border-t border-gray-200 pt-3 space-y-2">
                                <div class="text-[10px] uppercase tracking-widest text-gray-500">Share Blueprint</div>
                                <div class="flex flex-wrap gap-2">
                                    <button class="sculpture-share-button" onclick="profiler.shareBlueprint()" disabled>Share</button>
                                    <button class="sculpture-share-button" onclick="profiler.copyBlueprint()" disabled>Copy Brief</button>
                                    <button class="sculpture-share-button" onclick="profiler.downloadBlueprint()" disabled>Download</button>
                                </div>
                                <div id="sculpture-share-status" class="text-[10px] uppercase tracking-widest text-gray-500">Generate to unlock sharing.</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pt-4 border-t border-gray-200">
                <div class="font-mono text-[10px] uppercase tracking-[0.25em] text-gray-500">Continue the experience</div>
                <div class="flex flex-wrap gap-2 mt-3">
                    <button onclick="app.navigate('pitch')" class="ui-click border border-black bg-white px-3 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-black hover:text-white transition-colors">Project Brief</button>
                    <button onclick="app.navigate('gallery')" class="ui-click border border-black bg-white px-3 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-black hover:text-white transition-colors">Gallery</button>
                    <button onclick="app.navigate('grift')" class="ui-click border border-black bg-white px-3 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-black hover:text-white transition-colors">Grift Shop</button>
                    <button onclick="app.navigate('barter')" class="ui-click border border-black bg-white px-3 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-black hover:text-white transition-colors">Barter Post</button>
                </div>
            </div>
        </div>
    </section>

    <section id="view-gallery" class="view-section relative !pt-0 h-screen overflow-hidden">
        <div id="canvas-container" class="absolute inset-0 z-0 bg-[#0f0f0f]"></div>
        
        <div class="gallery-panel absolute bottom-16 left-8 z-10 bg-white/90 p-6 border border-black max-w-sm backdrop-blur shadow-2xl">
            <h3 class="font-bold uppercase text-sm mb-2">The Gallery</h3>
            <p class="text-xs font-mono text-gray-600 mb-4">Click + drag to rotate. Shift + drag to pan. Right-drag or scroll to dolly. WASD to walk.</p>
            <div class="space-y-2">
                <button onclick="gallery.resetCamera()" class="block w-full text-left text-[10px] font-mono uppercase hover:text-loom-red ui-click">Reset Camera</button>
                <button id="gallery-lantern-toggle" onclick="gallery.toggleLantern()" class="ui-click lantern-toggle w-full px-3 py-2 text-[10px] uppercase tracking-widest bg-white transition-colors">Turn On Lantern</button>
                <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">Works on display</div>
                <div id="gallery-works" class="text-xs font-mono text-gray-700 space-y-1">No works yet.</div>
                <div class="h-px bg-gray-300 my-2"></div>
                <button onclick="app.navigate('archive')" class="ui-click bg-black text-white px-4 py-3 w-full text-[10px] font-mono uppercase tracking-widest hover:bg-loom-red transition-colors">
                    Next: The Archive &rarr;
                </button>
            </div>
        </div>
    </section>

    <section id="view-trick-trough" class="view-section bg-[#fdfbf7]">
        <div class="max-w-6xl mx-auto px-6 py-16 space-y-10">
            <div class="space-y-4">
                <div class="inline-flex items-center gap-2 border border-black px-3 py-1 text-[10px] font-mono uppercase tracking-widest bg-white">Trick Trough (ticky tocki tavi)</div>
                <h2 class="text-4xl md:text-5xl font-bold uppercase tracking-tight">Top Performing TikTok Reel</h2>
                <p class="text-sm font-mono text-gray-600 max-w-3xl">A quick-cut trough of the biggest Dime Lane clips. Pinned videos lead the flow, then the highest-performing hits follow. Tap any frame to jump directly to the feed.</p>
                <a class="text-[10px] font-mono uppercase tracking-widest underline" href="https://www.tiktok.com/@dime.lantern" target="_blank" rel="noopener">Open @dime.lantern on TikTok</a>
            </div>

            <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-4">
                <div class="trick-card p-4 shadow-sm space-y-3">
                    <div class="flex items-center justify-between text-[10px] font-mono uppercase tracking-widest text-gray-500">
                        <span>CELLI PREVIEW</span>
                        <a class="underline" href="https://www.tiktok.com/@dime.lantern/video/7590208720424963358" target="_blank" rel="noopener">View on TikTok</a>
                    </div>
                    <div class="trick-embed">
                        <iframe src="https://www.tiktok.com/embed/7590208720424963358" title="CELLI PREVIEW TikTok video" aria-label="TikTok embed: CELLI PREVIEW" allow="encrypted-media; picture-in-picture" allowfullscreen loading="lazy"></iframe>
                    </div>
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-600">CELLI PREVIEW</div>
                </div>
                <div class="trick-card p-4 shadow-sm space-y-3">
                    <div class="flex items-center justify-between text-[10px] font-mono uppercase tracking-widest text-gray-500">
                        <span>DIME O'GHALLI</span>
                        <a class="underline" href="https://www.tiktok.com/@dime.lantern/video/7582280754252582174" target="_blank" rel="noopener">View on TikTok</a>
                    </div>
                    <div class="trick-embed">
                        <iframe src="https://www.tiktok.com/embed/7582280754252582174" title="DIME O'GHALLI TikTok video" aria-label="TikTok embed: DIME O'GHALLI" allow="encrypted-media; picture-in-picture" allowfullscreen loading="lazy"></iframe>
                    </div>
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-600">DIME O'GHALLI</div>
                </div>
                <div class="trick-card p-4 shadow-sm space-y-3">
                    <div class="flex items-center justify-between text-[10px] font-mono uppercase tracking-widest text-gray-500">
                        <span>HL3 CONFORMED</span>
                        <a class="underline" href="https://www.tiktok.com/@dime.lantern/video/7596196324823797023" target="_blank" rel="noopener">View on TikTok</a>
                    </div>
                    <div class="trick-embed">
                        <iframe src="https://www.tiktok.com/embed/7596196324823797023" title="HL3 CONFORMED TikTok video" aria-label="TikTok embed: HL3 CONFORMED" allow="encrypted-media; picture-in-picture" allowfullscreen loading="lazy"></iframe>
                    </div>
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-600">HL3 CONFORMED</div>
                </div>
                <div class="trick-card p-4 shadow-sm space-y-3">
                    <div class="flex items-center justify-between text-[10px] font-mono uppercase tracking-widest text-gray-500">
                        <span>OG AUTHAA; Triple A; One Man Show</span>
                        <a class="underline" href="https://www.tiktok.com/@dime.lantern/video/7599232803670166815" target="_blank" rel="noopener">View on TikTok</a>
                    </div>
                    <div class="trick-embed">
                        <iframe src="https://www.tiktok.com/embed/7599232803670166815" title="OG AUTHAA; Triple A; One Man Show TikTok video" aria-label="TikTok embed: OG AUTHAA; Triple A; One Man Show" allow="encrypted-media; picture-in-picture" allowfullscreen loading="lazy"></iframe>
                    </div>
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-600">OG AUTHAA; Triple A; One Man Show</div>
                </div>
            </div>
        </div>
    </section>

    <section id="view-archive" class="view-section bg-gray-50">
        <div class="max-w-6xl mx-auto px-6 py-12">
            <div class="flex flex-col md:flex-row justify-between items-end mb-10 gap-4">
                <div>
                    <div class="inline-flex items-center gap-2 border border-black px-3 py-1 text-[10px] font-mono uppercase tracking-widest bg-white">Step 4: Evidence</div>
                    <h2 class="text-5xl font-bold uppercase tracking-tight mt-2">Archive Index</h2>
                </div>
                <div class="font-mono text-xs md:text-right text-gray-500">
                    <div>Items: <span id="archive-count" class="font-bold text-black">Loading...</span></div>
                    <div>Updated: <span class="font-bold text-black">NOW</span></div>
                </div>
            </div>

            <div class="bg-white border border-black p-6 shadow-sm mb-10">
                <div class="flex flex-col md:flex-row justify-between gap-4 mb-4">
                    <div>
                        <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">Curatorial Tutorial Island</div>
                        <h3 class="text-2xl font-bold uppercase tracking-tight">Tarot Draw Engine (It Works)</h3>
                    </div>
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500 md:text-right">
                        <div>Archive KB Usage: <span id="archive-kb" class="font-bold text-black">...</span></div>
                        <div>Story Payload: <span id="story-kb" class="font-bold text-black">...</span></div>
                    </div>
                </div>
                <p class="text-xs font-mono text-gray-600 mb-6">Three pulls become a narrative. Add extra images and the vocabulary compresses itself around them. The joke is that it works.</p>
                <div class="grid md:grid-cols-3 gap-6">
                    <div class="md:col-span-2 space-y-6">
                        <div class="flex flex-wrap items-center gap-2 text-[10px] font-mono uppercase tracking-widest text-gray-500">
                            <span>Mode</span>
                            <button class="archive-mode-btn ui-click" data-archive-mode="default">Default/Test Mode</button>
                            <button class="archive-mode-btn ui-click" data-archive-mode="industrialized">Industrialized Reality</button>
                            <button class="archive-mode-btn ui-click" data-archive-mode="hensonMarilyn">Henson + Marilyn</button>
                            <span id="archive-mode-note" class="text-gray-500"></span>
                        </div>
                        <div class="grid sm:grid-cols-3 gap-3" id="tarot-slots">
                            <div class="border border-black/20 bg-gray-50 p-4 text-center font-mono text-xs uppercase tracking-widest">Card 1</div>
                            <div class="border border-black/20 bg-gray-50 p-4 text-center font-mono text-xs uppercase tracking-widest">Card 2</div>
                            <div class="border border-black/20 bg-gray-50 p-4 text-center font-mono text-xs uppercase tracking-widest">Card 3</div>
                        </div>
                        <div class="flex flex-wrap gap-2">
                            <button id="draw-three" class="ui-click bg-black text-white px-4 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-loom-red transition-colors">Draw Three</button>
                            <button id="mean-it" class="ui-click border border-black px-4 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-black hover:text-white transition-colors">Mean It (Use Selected)</button>
                            <button id="add-influence" class="ui-click border border-black/40 px-4 py-2 text-[10px] font-mono uppercase tracking-widest hover:border-black transition-colors">Add Influence Image</button>
                            <button id="clear-selection" class="ui-click text-[10px] font-mono uppercase tracking-widest underline text-gray-500">Clear Selections</button>
                        </div>
                        <div class="bg-gray-50 border border-black/10 p-4 text-xs font-mono text-gray-600">
                            <div class="uppercase tracking-widest text-[10px] text-gray-500 mb-2">Influence Tray</div>
                            <div id="influence-tray" class="flex flex-wrap gap-2"></div>
                        </div>
                        <div class="bg-black text-white p-5 rounded-lg">
                            <div class="text-[10px] font-mono uppercase tracking-widest text-loom-red mb-2">Narrative Output</div>
                            <div id="story-output" class="text-sm leading-relaxed font-serif">Draw cards to begin the compression trick.</div>
                            <div id="story-meta" class="mt-4 text-[10px] font-mono uppercase tracking-widest text-gray-400"></div>
                        </div>
                    </div>
                    <div class="space-y-3">
                        <details class="border border-black/10 bg-gray-50 p-4 text-[10px] font-mono text-gray-600" open>
                            <summary class="uppercase tracking-widest text-gray-500 cursor-pointer">Requirements + Architecture (Compressed)</summary>
                            <div class="mt-3 space-y-2 leading-relaxed">
                                <div><strong>Vision:</strong> A curatorial tutorial island that turns archive artifacts into living, randomized, three-card story draws. The "proprietary engine" is encoded directly in language; compression is the punchline.</div>
                                <div><strong>Requirements:</strong> 1) JSON archive dataset. 2) Random draw of three like tarot. 3) Manual selection with click-to-select and “Mean It”. 4) Extra image influence that meaningfully changes story. 5) Hyper-light noise layer for variability. 6) KB usage display. 7) Metadata for narrative + semiotic containment. 8) Works without external services.</div>
                                <div><strong>Architecture:</strong> UI (Archive/Island) → Selection State → Narrative Engine (vocab + motifs + compression rules) → Story + Meta + KB. All deterministic logic in client JS.</div>
                                <div><strong>ERD:</strong> Artifact(id, title, year, motif, glyph, tags, role, weight) ↔ Selection(cardSlot, artifactId, source=random/manual) ↔ Influence(artifactId, intensity) → Narrative(meta, story, noise, containment).</div>
                                <div><strong>Execution:</strong> Update JSON dataset, render cards + archive list, wire click handlers, generate story + meta, calculate KB usage from payload sizes.</div>
                            </div>
                        </details>
                    </div>
                </div>
            </div>

            <div class="grid md:grid-cols-3 gap-8">
                <div class="bg-white border border-black p-6 h-fit md:sticky md:top-24 shadow-sm">
                    <h3 class="font-mono text-xs uppercase tracking-widest text-gray-500 mb-4">Quick Index</h3>
                    <div id="archive-quick" class="text-xs font-mono space-y-2 h-64 overflow-y-auto pr-2"></div>
                </div>
                <div class="md:col-span-2 space-y-4" id="archive-groups">
                    <div class="border border-dashed border-gray-400 p-8 text-center font-mono text-sm text-gray-500">Loading inventory data...</div>
                </div>
            </div>

            <div class="border-t border-black mt-20 pt-8 flex justify-end">
                <button onclick="app.navigate('grift')" class="ui-click bg-black text-white px-6 py-4 text-xs font-mono uppercase tracking-widest hover:bg-loom-red transition-colors flex items-center gap-2">
                    Next: Extract Value <span>&rarr;</span>
                </button>
            </div>
        </div>
    </section>

    <section id="view-grift" class="view-section bg-[#f8f3e8]">
        <div class="max-w-6xl mx-auto px-6 py-12 space-y-10">
            <div class="flex flex-col lg:flex-row lg:items-end lg:justify-between gap-6 border-b-2 border-black pb-6">
                <div class="space-y-2">
                    <div class="inline-flex items-center gap-2 bg-white border border-black px-3 py-1 text-[10px] font-mono uppercase tracking-widest">Step 5: The Economy</div>
                    <h2 class="text-4xl font-bold uppercase tracking-tight">Grift Shop</h2>
                    <p class="text-sm text-gray-700 max-w-2xl">We don’t take your money. We help you notice where it’s been taken before. Solve the micro-grifts, collect Value Tokens (9 total), and watch the ticketing module change its mind.</p>
                    <div class="text-xs font-mono uppercase tracking-[0.25em] text-gray-500">State: <span id="grift-state">griftIdle</span></div>
                </div>
                <div class="flex flex-wrap gap-3">
                    <div class="value-pill bg-white">Tokens (need 6): <span id="token-count" class="font-bold">0</span></div>
                    <button onclick="app.navigate('tickets')" class="ui-click border border-black bg-white px-3 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-black hover:text-white transition-colors">View Ticket Gate</button>
                </div>
            </div>

            <div class="bg-white border border-black rounded-2xl p-6 shadow-lg space-y-4">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
                    <div class="space-y-1">
                        <div class="font-mono text-[10px] uppercase tracking-widest text-gray-600">Grift Loop</div>
                        <p class="text-sm text-gray-800">Grift modules unlock in any order. Hover, drag, click, and uncheck your way to 6 of 9 tokens to satisfy the ticket gate.</p>
                    </div>
                    <div id="grift-overlay" class="hidden bg-black text-white px-3 py-2 rounded-lg font-mono text-xs uppercase tracking-[0.2em]">VALUE INDEX REACHED</div>
                </div>
                <div class="grift-grid">
                    <div class="grift-card" id="card-coin">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-bold uppercase tracking-tight">Influencer Coin</h3>
                            <span class="value-pill" id="coin-yield">Yield: ?</span>
                        </div>
                        <p class="text-sm text-gray-700">BUY HIGH / SELL STORY. Drag the slider toward craft to short pure hype.</p>
                        <div class="mt-4">
                            <label class="text-xs font-mono uppercase tracking-widest text-gray-500">Clout ← → Craft</label>
                            <input id="coin-slider" type="range" min="0" max="100" value="55" class="w-full accent-orange-500">
                        </div>
                        <p id="coin-lore" class="text-xs text-gray-600 mt-2">Drag toward craft. See what happens.</p>
                    </div>

                    <div class="grift-card" id="card-box">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-bold uppercase tracking-tight">Unopened Merch Box</h3>
                            <span class="value-pill" id="box-yield">Yield: ?</span>
                        </div>
                        <p class="text-sm text-gray-700">Tape reads “DO NOT OPEN UNTIL VIRAL.” Keep tapping anyway.</p>
                        <div class="mt-4 space-y-2">
                            <button id="box-tape" class="ui-click border border-black bg-white px-3 py-2 text-xs font-mono uppercase tracking-widest hover:bg-black hover:text-white transition-colors">Peel tape</button>
                            <div id="box-progress" class="text-xs font-mono uppercase tracking-[0.2em] text-gray-500">Waiting…</div>
                            <div id="box-note" class="text-sm text-gray-800 hidden">Value appears when somebody actually uses the thing.</div>
                        </div>
                    </div>

                    <div class="grift-card" id="card-timeshare">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-bold uppercase tracking-tight">Timeshare of the Soul</h3>
                            <span class="value-pill" id="time-yield">Yield: ?</span>
                        </div>
                        <p class="text-sm text-gray-700">Fake contract offering slices of your schedule. Keep your hours intact to unlock value.</p>
                        <div class="mt-3 space-y-2 text-sm text-gray-800">
                            <label class="flex items-center gap-2"><input type="checkbox" class="timeshare-box" checked value="weekends">weekends</label>
                            <label class="flex items-center gap-2"><input type="checkbox" class="timeshare-box" checked value="evenings">evenings</label>
                            <label class="flex items-center gap-2"><input type="checkbox" class="timeshare-box" checked value="dreams">dreams</label>
                            <button id="timeshare-submit" class="ui-click border border-black bg-gray-200 text-gray-500 px-3 py-2 text-[10px] font-mono uppercase tracking-widest cursor-not-allowed">Submit</button>
                            <div id="timeshare-note" class="text-xs text-gray-600">Uncheck all boxes to keep yourself intact.</div>
                        </div>
                    </div>

                    <div class="grift-card" id="card-paywall">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-bold uppercase tracking-tight">Paywall Side Door</h3>
                            <span class="value-pill" id="paywall-yield">Yield: ?</span>
                        </div>
                        <p class="text-sm text-gray-700">Pick the response that slips past the meter without stealing the work.</p>
                        <div class="mt-3 space-y-2 text-sm text-gray-800" id="paywall-options">
                            <label class="flex items-center gap-2"><input type="radio" name="paywall" value="borrow">Screenshot and repost the whole thing</label>
                            <label class="flex items-center gap-2"><input type="radio" name="paywall" value="library">Find it at the library or independent archive</label>
                            <label class="flex items-center gap-2"><input type="radio" name="paywall" value="ignore">Close tab; rage at capitalism</label>
                        </div>
                        <p id="paywall-note" class="text-xs text-gray-600 mt-2">One of these honors the work and still gets you through.</p>
                    </div>

                    <div class="grift-card" id="card-terms">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-bold uppercase tracking-tight">Terms Decoder</h3>
                            <span class="value-pill" id="terms-yield">Yield: ?</span>
                        </div>
                        <p class="text-sm text-gray-700">Tap to spot the clause that actually matters.</p>
                        <div class="mt-3 bg-white border border-dashed border-gray-300 p-3 rounded-lg text-sm text-gray-800 leading-relaxed" id="terms-copy">
                            This agreement grants us perpetual, transferable rights to your likeness. By proceeding you waive recourse and agree to binding arbitration in a basement.
                        </div>
                        <button id="terms-flag" class="ui-click border border-black bg-white px-3 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-black hover:text-white transition-colors mt-3">Flag the clause</button>
                    </div>

                    <div class="grift-card" id="card-subscription">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-bold uppercase tracking-tight">Auto-Renew Freeze</h3>
                            <span class="value-pill" id="subscription-yield">Yield: ?</span>
                        </div>
                        <p class="text-sm text-gray-700">Toggle the switches that companies hide behind three menus.</p>
                        <div class="mt-3 space-y-2 text-sm text-gray-800">
                            <label class="flex items-center justify-between bg-white border border-gray-300 rounded-lg px-3 py-2">
                                <span>Renew annually</span>
                                <input type="checkbox" class="subscription-toggle" checked aria-label="Renew annually">
                            </label>
                            <label class="flex items-center justify-between bg-white border border-gray-300 rounded-lg px-3 py-2">
                                <span>Share data with partners</span>
                                <input type="checkbox" class="subscription-toggle" checked aria-label="Share data with partners">
                            </label>
                            <label class="flex items-center justify-between bg-white border border-gray-300 rounded-lg px-3 py-2">
                                <span>Send me insider hype</span>
                                <input type="checkbox" class="subscription-toggle" checked aria-label="Send me insider hype">
                            </label>
                        </div>
                        <p id="subscription-note" class="text-xs text-gray-600 mt-2">Slide everything off to reclaim your agency.</p>
                    </div>

                    <div class="grift-card" id="card-scam">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-bold uppercase tracking-tight">Inbox Scam Filter</h3>
                            <span class="value-pill" id="scam-yield">Yield: ?</span>
                        </div>
                        <p class="text-sm text-gray-700">Choose the email subject line that is definitely a trap.</p>
                        <div class="mt-3 grid gap-2" id="scam-options">
                            <button class="ui-click border border-black bg-white px-3 py-2 text-left text-sm hover:bg-black hover:text-white transition-colors" data-scam="wrong">Invoice attached — need your signature</button>
                            <button class="ui-click border border-black bg-white px-3 py-2 text-left text-sm hover:bg-black hover:text-white transition-colors" data-scam="right">URGENT: wire funds to secure NFT vault</button>
                            <button class="ui-click border border-black bg-white px-3 py-2 text-left text-sm hover:bg-black hover:text-white transition-colors" data-scam="wrong">Media request: quote for your project</button>
                        </div>
                        <p id="scam-note" class="text-xs text-gray-600 mt-2">Spot the grift before it lands.</p>
                    </div>

                    <div class="grift-card" id="card-bundle">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-bold uppercase tracking-tight">Bundle Hype Meter</h3>
                            <span class="value-pill" id="bundle-yield">Yield: ?</span>
                        </div>
                        <p class="text-sm text-gray-700">Drag the meter toward reality to cut out the useless add-ons.</p>
                        <div class="mt-4">
                            <label class="text-xs font-mono uppercase tracking-widest text-gray-500">Hype Stack</label>
                            <input id="bundle-slider" type="range" min="0" max="100" value="60" class="w-full accent-yellow-400">
                        </div>
                        <p id="bundle-note" class="text-xs text-gray-600 mt-2">Lower the slider until only what matters remains.</p>
                    </div>

                    <div class="grift-card" id="card-receipt">
                        <div class="flex items-center justify-between">
                            <h3 class="text-lg font-bold uppercase tracking-tight">Street Receipt Audit</h3>
                            <span class="value-pill" id="receipt-yield">Yield: ?</span>
                        </div>
                        <p class="text-sm text-gray-700">Tap the hidden fee to redact it before you pay.</p>
                        <div class="mt-3 space-y-2 text-sm text-gray-800 bg-white border border-gray-300 rounded-lg p-3">
                            <div class="flex justify-between">
                                <span>Ticket line item</span>
                                <span>$25.00</span>
                            </div>
                            <button id="receipt-fee" class="ui-click w-full border border-red-500 bg-red-50 text-red-700 px-3 py-2 text-xs font-mono uppercase tracking-widest hover:bg-red-600 hover:text-white transition-colors">"Processing" fee $6</button>
                            <div class="flex justify-between">
                                <span>Total</span>
                                <span id="receipt-total">$31.00</span>
                            </div>
                        </div>
                        <p id="receipt-note" class="text-xs text-gray-600 mt-2">Refuse the fee to keep value in the open.</p>
                    </div>
                </div>
                <div class="pt-4 flex flex-wrap gap-3 text-xs font-mono uppercase tracking-[0.25em] text-gray-600">
                    <span>this is not financial advice. this is narrative advice.</span>
                    <span id="grift-hint" class="text-red-600"></span>
                </div>
            </div>

            <div class="bg-white border border-black p-6 rounded-xl shadow-lg">
                <h3 class="font-bold uppercase mb-4">Manufacture Tool (16x16)</h3>
                <div class="flex flex-col md:flex-row gap-6">
                    <div class="border-2 border-black p-1 bg-[#f5f5dc] w-fit shadow-[4px_4px_0px_rgba(0,0,0,1)]">
                        <canvas id="manufacture-canvas" width="256" height="256" class="cursor-crosshair w-[256px] h-[256px]"></canvas>
                    </div>
                    <div class="space-y-4 flex-1">
                        <div class="text-xs font-mono text-gray-600">Draw your emulacrum. Pixels are expensive.</div>
                        <div class="flex gap-2">
                            <button class="w-8 h-8 bg-black border-2 border-gray-300 ui-click hover:scale-110 transition-transform" onclick="manufacture.setColor('#111')" title="Black"></button>
                            <button class="w-8 h-8 bg-loom-red border-2 border-gray-300 ui-click hover:scale-110 transition-transform" onclick="manufacture.setColor('#CD2B2B')" title="Red"></button>
                            <button class="w-8 h-8 bg-white border-2 border-gray-300 ui-click hover:scale-110 transition-transform" onclick="manufacture.setColor('#f5f5dc')" title="Eraser"></button>
                        </div>
                        <button onclick="manufacture.submit()" class="border-2 border-black px-6 py-3 text-xs font-bold uppercase tracking-widest hover:bg-black hover:text-white transition-colors ui-click w-full md:w-auto">Submit Artifact</button>
                    </div>
                </div>
            </div>

            <div class="bg-black text-white border border-gray-800 p-6 rounded-xl shadow-lg mt-8">
                <div class="flex flex-wrap items-center justify-between gap-3 mb-4">
                    <h3 class="font-bold uppercase text-loom-red">Grift Shop Provenance Feed</h3>
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-300">Assets Sold: <span id="grift-asset-count">0</span></div>
                </div>
                <p class="text-xs font-mono text-gray-300 mb-4">Every asset submitted to the Grift Shop spins a chain of custody: auctions, NFTs, freeports, and yacht-side trades. The list is long, factual, and still ridiculous.</p>
                <div id="grift-ledger" class="space-y-4 text-xs font-mono text-gray-200"></div>
            </div>

            <div class="pt-4 border-t border-gray-300 flex flex-wrap gap-3 items-center">
                <div class="value-pill bg-white">Loomworks Note: <span id="grift-note">griftIdle</span></div>
                <button onclick="app.navigate('tickets')" class="ui-click border border-black bg-white px-3 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-black hover:text-white transition-colors">Check Ticket Status</button>
                <button onclick="app.navigate('barter')" class="ui-click border border-black bg-white px-3 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-black hover:text-white transition-colors">Barter Post</button>
                <button onclick="app.navigate('gallery')" class="ui-click border border-black bg-white px-3 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-black hover:text-white transition-colors">Gallery</button>
            </div>

            <div class="border-t border-black mt-20 pt-8 flex justify-end">
                <button onclick="app.navigate('barter')" class="ui-click bg-black text-white px-6 py-4 text-xs font-mono uppercase tracking-widest hover:bg-loom-red transition-colors flex items-center gap-2">
                    Next: Barter Post <span>&rarr;</span>
                </button>
            </div>
        </div>
    </section>

    <section id="view-barter" class="view-section">
        <div class="max-w-6xl mx-auto px-6 py-12">
            <div class="text-center mb-16">
                <div class="inline-flex items-center gap-2 border border-black px-3 py-1 text-[10px] font-mono uppercase tracking-widest bg-white">Step 6: Exchange</div>
                <h2 class="text-5xl font-bold uppercase tracking-tight mt-4">The Barter Post</h2>
            </div>
            
            <div class="grid md:grid-cols-2 gap-8 mb-12">
                <div class="border border-black bg-white p-6 shadow-lg">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="font-bold uppercase">Shop Mode</h3>
                        <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                    </div>
                    <div class="space-y-4 font-mono text-xs" id="barter-grid">
                        <div class="flex justify-between border-b py-2 items-center">
                            <span>Archival Postcard</span> 
                            <button class="border border-black px-2 py-1 hover:bg-black hover:text-white transition-colors ui-click">$5.00</button>
                        </div>
                        <div class="flex justify-between border-b py-2 items-center">
                            <span>Celli Figurine</span> 
                            <button class="border border-black px-2 py-1 hover:bg-black hover:text-white transition-colors ui-click">$25.00</button>
                        </div>
                        <div class="flex justify-between border-b py-2 items-center">
                            <span>Lantern Badge</span> 
                            <span class="bg-gray-200 px-2 py-1">Trade Only</span>
                        </div>
                    </div>
                </div>
                <div class="bg-[#111] text-white p-6 shadow-lg border border-gray-800">
                    <h3 class="font-bold uppercase mb-6 text-loom-red">Transparency Mode</h3>
                    <div class="space-y-4 font-mono text-xs text-gray-400">
                        <div class="flex justify-between border-b border-gray-800 py-2"><span>Postcard Margin</span> <span class="text-white">85%</span></div>
                        <div class="flex justify-between border-b border-gray-800 py-2"><span>Celli Margin</span> <span class="text-white">40%</span></div>
                        <div class="flex justify-between border-b border-gray-800 py-2"><span>Narrative Value</span> <span class="text-loom-red">Unquantifiable</span></div>
                    </div>
                </div>
            </div>

            <div class="border-t border-black mt-20 pt-8 flex justify-end">
                <button onclick="app.navigate('ambition')" class="ui-click bg-black text-white px-6 py-4 text-xs font-mono uppercase tracking-widest hover:bg-loom-red transition-colors flex items-center gap-2">
                    Next: The Ambition <span>&rarr;</span>
                </button>
            </div>
        </div>
    </section>

    <section id="view-ambition" class="view-section blueprint">
        <div class="max-w-5xl mx-auto px-6 py-12">
            <div class="mb-12">
                <div class="inline-flex items-center gap-2 border border-black px-3 py-1 text-[10px] font-mono uppercase tracking-widest bg-white">Step 7: The Why</div>
                <h2 class="text-5xl font-bold uppercase tracking-tight mt-4">Threshold</h2>
                <p class="mt-4 max-w-3xl text-sm text-gray-700 font-mono leading-relaxed">Domestic Product is not a brand. Loomworks is not a company. Celli is not a mascot. This is a proof that a single creator can build a system that feels institutional, emotional, and real enough to fear.</p>
            </div>

            <div class="bg-white border border-black rounded-xl p-8 shadow-2xl space-y-8">
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="bg-gray-50 p-6 border border-black/10">
                        <h4 class="font-bold uppercase text-xs mb-2 tracking-widest text-loom-red">The Archive</h4>
                        <p class="text-sm text-gray-600">Real objects folded into the fiction. Evidence of manufactured myth and how icons are made, sold, and recycled.</p>
                    </div>
                    <div class="bg-gray-50 p-6 border border-black/10">
                        <h4 class="font-bold uppercase text-xs mb-2 tracking-widest text-loom-red">The Experience</h4>
                        <p class="text-sm text-gray-600">Playable critique, inhabitable satire. The system is the show, and you are inside the bureaucracy.</p>
                    </div>
                </div>

                <div class="grid md:grid-cols-3 gap-6">
                    <div class="bg-black text-white rounded-lg p-6 shadow-inner md:col-span-2 space-y-4">
                        <div class="text-[10px] font-mono uppercase tracking-widest text-loom-red">Character Copy</div>
                        <h3 class="text-2xl font-bold uppercase">Dime — The Cost Analyst</h3>
                        <p class="text-sm text-gray-200 leading-relaxed">Dime is the evolved interface: Dima the actress compressed into a mascot, then expanded into a Lantern. She smiles like a museum docent and counts like a banker. Dime is the soft bureaucratic warmth that makes the grift feel safe. She does not sell you a ticket. She tallies your attention.</p>
                        <p class="text-sm text-gray-200 leading-relaxed">If Penny invited imagination, Dime invites belonging. She makes the myth feel like a job you already have.</p>
                    </div>
                    <button onclick="dimeBacklog.open()" class="ui-click border border-black/10 bg-[#FDFBF7] p-6 rounded-lg shadow-sm text-left hover:border-loom-red transition-colors">
                        <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">Node: Dime Backlog</div>
                        <div class="font-bold uppercase text-lg mt-2">Penny → Dime → Lantern Cosmology</div>
                        <p class="text-xs text-gray-600 mt-2">Tap to open the meta story pop-up. Access level: lntrn00.10.</p>
                    </button>
                </div>

                <div class="bg-black text-white rounded-lg p-6 shadow-inner">
                    <details class="group">
                        <summary class="flex justify-between items-center cursor-pointer ui-click select-none">
                            <span class="font-mono text-xs uppercase tracking-widest text-loom-red">Worldbuilding Whitepaper: Worlds, Not Widgets</span>
                            <span class="text-loom-red group-open:rotate-45 transition-transform text-xl">+</span>
                        </summary>
                        <div class="mt-6 text-sm text-gray-300 leading-relaxed space-y-4 border-t border-gray-800 pt-4">
                            <p>For a brief moment, the web was built by weirdos, tinkerers, and obsessives who treated browsers like stages. Then templates replaced worlds, optimization replaced expression, and the ritual of visiting a universe was flattened into feeds.</p>
                            <p>Domestic Product is a refusal of the flattening. It is a worldbuilding proof-of-life: a museum, a performance, a software myth, and a marketplace braided together so the audience can feel the gears.</p>
                            <p>Worlds win when they are authored. Loomworks is a container for cadenced ARGs, authored disclosures, and ritualized reveals. Emergence blooms inside a human-designed structure.</p>
                            <p class="font-semibold text-loom-red">This is the invitation: build worlds again. The web can hold wonder if we design for it.</p>
                        </div>
                    </details>
                </div>

                <div class="depth-layer bg-gray-50 border border-black/10 p-6 rounded-lg text-sm text-gray-700" data-depth="2">
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500 mb-2">Depth Expansion — Ambition</div>
                    <p>This ecosystem is a one-person studio: music, software, curation, commerce, and lore. The depth tracker remembers each return and unlocks more of the thesis so the world grows with you.</p>
                </div>
            </div>

            <div class="border-t border-black mt-20 pt-8 flex justify-end">
                <button onclick="app.navigate('investors')" class="ui-click bg-black text-white px-6 py-4 text-xs font-mono uppercase tracking-widest hover:bg-loom-red transition-colors flex items-center gap-2">
                    Next: Investors <span>&rarr;</span>
                </button>
            </div>
        </div>
    </section>

    <section id="view-investors" class="view-section bg-[#FDFBF7]">
        <div class="max-w-5xl mx-auto px-6 py-12 space-y-10">
            <div class="border-2 border-black bg-white p-8 shadow-[6px_6px_0px_rgba(0,0,0,1)]">
                <div class="text-[10px] font-mono uppercase tracking-widest text-loom-red">Options Quiz</div>
                <h2 class="text-3xl md:text-4xl font-bold uppercase tracking-tight mt-2">Choose the Next Artifact</h2>
                <p class="text-xs font-mono uppercase tracking-[0.24em] text-gray-500 mt-2">Bullets = options. Tap one. We will heckle you anyway.</p>
                <ul class="list-disc list-inside mt-6 space-y-3 text-sm font-mono text-gray-700">
                    <li>
                        <button data-investor-option data-label="One-page charter sheet" class="ui-click border border-black/10 bg-white px-3 py-2 uppercase tracking-widest text-[10px] hover:bg-black hover:text-white transition-colors">
                            Condense into a one-page charter sheet.
                        </button>
                    </li>
                    <li>
                        <button data-investor-option data-label="Formal partner deck voice" class="ui-click border border-black/10 bg-white px-3 py-2 uppercase tracking-widest text-[10px] hover:bg-black hover:text-white transition-colors">
                            Translate into a formal partner deck voice.
                        </button>
                    </li>
                    <li>
                        <button data-investor-option data-label="Shorter wall-plaque manifesto" class="ui-click border border-black/10 bg-white px-3 py-2 uppercase tracking-widest text-[10px] hover:bg-black hover:text-white transition-colors">
                            Write a shorter wall-plaque / manifesto version.
                        </button>
                    </li>
                    <li>
                        <button data-investor-option data-label="Term philosophy page" class="ui-click border border-black/10 bg-white px-3 py-2 uppercase tracking-widest text-[10px] hover:bg-black hover:text-white transition-colors">
                            Create a legal-adjacent “term philosophy” page beside real contracts.
                        </button>
                    </li>
                </ul>
                <div id="investor-quiz-response" class="mt-6 text-sm font-mono text-gray-800">
                    Pick an option to receive your playful mockery. ;) :) :o 🤹‍♀️⚡
                </div>
            </div>

            <div class="border border-black bg-white p-8 shadow-lg space-y-4">
                <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">Loomworks</div>
                <h2 class="text-4xl md:text-5xl font-bold uppercase tracking-tight">A Declaration of Sovereignty and Collaboration</h2>
                <p class="text-sm text-gray-700 font-mono leading-relaxed">Loomworks is not a brand. It is not a venue. It is not a show. It is a creative jurisdiction — a living laboratory for industrial kookiness, cultural memory, and the responsible mutation of icons.</p>
            </div>

            <div class="space-y-8">
                <div class="border border-black/10 bg-white p-6">
                    <h3 class="font-bold uppercase text-sm mb-3">I. What Loomworks Is</h3>
                    <p class="text-sm text-gray-700 leading-relaxed">A place where meaning is not strip-mined for attention, but cultivated, housed, and re-released. A digital product that inhabits space. A physical space that behaves like a mind. An institution disguised as a show.</p>
                    <p class="text-sm text-gray-700 leading-relaxed mt-4">We are building what used to exist before feeds replaced worlds: a place you can go, a thing that can outlive platforms, a system that can hold story, craft, commerce, and play without flattening them.</p>
                    <p class="text-sm text-gray-700 leading-relaxed mt-4">Loomworks exists to produce survivable IP anchored in history — work that can be touched, collected, licensed, remixed, taught, worn, staged, archived, and re-entered across generations. Not content. Culture.</p>
                </div>

                <div class="border border-black/10 bg-white p-6">
                    <h3 class="font-bold uppercase text-sm mb-3">II. The Building Is Not a Location — It Is an Anchor</h3>
                    <p class="text-sm text-gray-700 leading-relaxed">The base of the building becomes a permanent creative laboratory and public-facing institution: exhibitions, performances, prototyping floors, merch and artifact production, interactive archives, experimental storefronts, live research into meaning, myth, and modern magic.</p>
                    <p class="text-sm text-gray-700 leading-relaxed mt-4">Residents won’t merely tolerate it. In time, they will recognize it. Then they will use it. Then they will become its clientele, collaborators, and carriers. The greatest haunted objects are not possessions. They are anchors. This space is an anchor.</p>
                    <p class="text-sm text-gray-700 leading-relaxed mt-4">The work can migrate. The shell can change. But the site establishes continuity, legitimacy, and gravity. It turns Loomworks from a project into a place in the world.</p>
                </div>

                <div class="border border-black/10 bg-white p-6">
                    <h3 class="font-bold uppercase text-sm mb-3">III. Economic Structure (The Collaboration Layer)</h3>
                    <p class="text-sm text-gray-700 leading-relaxed">This is not a lease. It is not a traditional tenant relationship. It is rent-to-own as cultural infrastructure.</p>
                    <ul class="mt-4 space-y-2 text-sm text-gray-700 list-disc list-inside">
                        <li>Ticket sales flow into a transparent split allocation: continued acquisition and production of artifacts and merch, a fixed percentage to property cost, and an additional long-term percentage of both tickets and merch.</li>
                        <li>This participation is calculated on revenue, not profit. No funny numbers. No creative accounting. No back-end vapor.</li>
                        <li>Online merchandise residuals are only granted a smaller percentage, and only when redeemed via a provided partner code — applied to sale value, not MSRP.</li>
                    </ul>
                    <p class="text-sm text-gray-700 leading-relaxed mt-4">The agreement horizon is long-form (15 years), reflecting what this actually is: institution building, not event hosting. This replaces the bank with a collaborator.</p>
                    <p class="text-sm text-gray-700 leading-relaxed mt-4">You receive a permanent buyer whose payments scale with the success of the work. You receive alignment instead of rent extraction. You receive upside in the cultural asset being housed. As Loomworks expands beyond a show — into IP, exhibitions, licensed artifacts, traveling installations, education, and archives — this structure naturally opens into further collaboration.</p>
                </div>

                <div class="border border-black/10 bg-white p-6">
                    <h3 class="font-bold uppercase text-sm mb-3">IV. Why This Exists (And Why Now)</h3>
                    <p class="text-sm text-gray-700 leading-relaxed">We are living inside what the Philosopher-Tech-Wizard calls “Sisyphean Loops of Boring.” Feeds with tendrils in the mind. Endless partial gestures. Systems optimized to prevent completion. Loomworks exists to finish things.</p>
                    <p class="text-sm text-gray-700 leading-relaxed mt-4">To render wholes. To give forms bodies. To give bodies homes. Its lineage is not tech. It is myth: Hamilton and the American spell. Baum and the endlessly mutating Oz. Disney before corporate embalming. Henson, pre-mutated. Monroe, who carved herself from Normality’s rib. Mice. Men. Other monsters.</p>
                    <p class="text-sm text-gray-700 leading-relaxed mt-4">This is not nostalgia. It is custodianship.</p>
                </div>

                <div class="border border-black/10 bg-white p-6">
                    <h3 class="font-bold uppercase text-sm mb-3">V. Dima Lane (The Incarnated System)</h3>
                    <p class="text-sm text-gray-700 leading-relaxed">Dima Lane is not a mascot. She is IP incarnate. A girl formed from systems. A penny that learned to compound. A lantern that learned to walk.</p>
                    <p class="text-sm text-gray-700 leading-relaxed mt-4">She is Penelope completed — the human hero of the time between Past and Future, after Father Time’s withdrawal from a world he could no longer steer. Where trends once dripped from ego-fiends, she consolidates agency.</p>
                    <p class="text-sm text-gray-700 leading-relaxed mt-4">AI did not replace the many hands. It unified them. And from that unification emerged not automation — but character. Dima is incorporated. Coronated. Inked. She is not owned. She is housed. And Loomworks is her city.</p>
                </div>

                <div class="border border-black/10 bg-white p-6">
                    <h3 class="font-bold uppercase text-sm mb-3">VI. The Question We Are Willing To Stand Behind</h3>
                    <p class="text-sm text-gray-700 leading-relaxed">What is the cost of magic? If you knew it, would you still make it? Would you still build the apparatus? Would you still dare try?</p>
                    <p class="text-sm text-gray-700 leading-relaxed mt-4">Loomworks answers yes — but only if magic is allowed to become structure. Only if wonder is allowed to pay rent. Only if imagination is given zoning. Only if myth is allowed to sign contracts.</p>
                </div>

                <div class="border border-black/10 bg-white p-6">
                    <h3 class="font-bold uppercase text-sm mb-3">VII. The Offer</h3>
                    <p class="text-sm text-gray-700 leading-relaxed">We are not looking for landlords. We are inviting founding stewards: people and properties willing to become part of a system that intends to outlive its first decade, its first platform, and its first form.</p>
                    <p class="text-sm text-gray-700 leading-relaxed mt-4">Together, we erect Dima Lane — a district, a laboratory, a stage, an archive, a storefront, a spell. Not a spectacle. A sovereign cultural engine that knows how to collaborate.</p>
                    <p class="text-sm text-gray-700 leading-relaxed mt-4">This text is strong. Now it can be wielded.</p>
                </div>
            </div>

            <div class="border-t border-black pt-8 flex justify-end">
                <button onclick="app.navigate('protocol')" class="ui-click bg-black text-white px-6 py-4 text-xs font-mono uppercase tracking-widest hover:bg-loom-red transition-colors flex items-center gap-2">
                    Next: Final Protocol <span>&rarr;</span>
                </button>
            </div>
        </div>
    </section>

    <section id="view-protocol" class="view-section">
        <div class="max-w-5xl mx-auto px-6 py-12 pb-32">
            <div class="flex justify-between items-end mb-12 border-b-2 border-red-600 pb-6">
                <div>
                    <h1 class="text-5xl font-bold uppercase tracking-tighter">Lantern Protocol</h1>
                    <div class="font-mono text-xs text-red-600 mt-2 uppercase tracking-widest">Document No. HR-902 // CASTING</div>
                </div>
            </div>

            <div class="grid md:grid-cols-2 gap-12">
                <div class="space-y-6">
                    <p class="font-serif text-lg leading-relaxed">
                        Lanterns are the human interfaces of Loomworks. Not guards, not docents — witnesses. Traditional theater indexes macro expressions for the back row. The Loomworks indexes micro expressions: the intimate truth of a character standing inches away.
                    </p>
                    <p class="text-sm text-gray-700 leading-relaxed">
                        The performance is not loud. It is precise. The Lanterns anchor guests in a ritualized bureaucracy that feels soft and safe while quietly tracking attention, cost, and belonging. Every movement is slow enough to read, every line is clean enough to remember.
                    </p>
                    <div class="bg-white border border-gray-200 p-6 shadow-md">
                        <h3 class="font-mono text-xs uppercase tracking-widest text-loom-red mb-4">Operational Win</h3>
                        <ul class="space-y-3 text-sm text-gray-700">
                            <li><strong>Low Overhead:</strong> The density of artifacts does the heavy lifting. No months of choreography.</li>
                            <li><strong>Rapid Training:</strong> Performers inhabit roles through stage notes and the physical history of the room.</li>
                            <li><strong>No Backstage:</strong> The show is laid bare. The person becomes the performer in the same space as the guest.</li>
                            <li><strong>Precision Tone:</strong> Polite, uncanny, never casual. The Lantern is a living interface, not a hangout friend.</li>
                        </ul>
                    </div>
                    <div class="bg-white border border-gray-200 p-6 shadow-md space-y-4">
                        <h3 class="font-mono text-xs uppercase tracking-widest text-loom-red">Performance Protocols (Full Copy)</h3>
                        <div class="space-y-3 text-sm text-gray-700">
                            <p><strong>Lantern Protocol:</strong> How to greet, how to hold silence, how to hand off. The handoff is a ritual: eye contact, nod, and a single line that transfers the guest without breaking the story.</p>
                            <p><strong>Idling Protocol:</strong> Approved poses, breathing cadence, the tilted-head rest stance. Micro-movements only: slow blink, wrist reset, soft inhale. Never fidget.</p>
                            <p><strong>Station Protocols:</strong> Barter Post intake, Grift Shop guidance, Identity Assessment flow, and Archive curation. Each station has its own script and tempo, but the Lantern voice stays consistent.</p>
                            <p><strong>Emotional Boundaries:</strong> Guests project narratives. Lanterns stay gracious, calm, and inscrutable. No colloquial breaks. Never negate a guest; redirect with curiosity and ritual language.</p>
                            <p><strong>Recovery Protocol:</strong> If a guest disconnects, the Lantern resets the scene with a neutral line (“Thank you. Continue.”) and reorients them to the next step. The world never panics.</p>
                        </div>
                        <p class="font-mono text-xs uppercase tracking-widest text-gray-500">Visitors feel watched, not judged. The system feels alive, not hostile.</p>
                    </div>
                    <div class="bg-black text-white p-6 border border-gray-800">
                        <h3 class="font-mono text-xs uppercase tracking-widest text-tonka-gold mb-3">Maestro Musika</h3>
                        <p class="text-xs font-mono text-gray-300 leading-relaxed">
                            Auditory, visual, interactive — guided by restraint. Overwhelm when called for, and disappear when the room needs breath. Milano ni momo bebe: the last note lands soft, poetic, human.
                        </p>
                    </div>
                    <div class="bg-white border border-gray-200 p-8 shadow-md relative overflow-hidden">
                        <div class="absolute top-0 right-0 bg-loom-red text-white text-[9px] px-2 py-1 font-mono">INTERACTION 01</div>
                        <h3 class="font-bold text-sm uppercase mb-4 text-gray-400">Scripted Response</h3>
                        <p class="font-serif text-2xl italic mb-4">"Just super!"</p>
                        <p class="text-xs text-gray-500 font-mono border-t pt-2">(Bright, slightly too loud. Smile with teeth.)</p>
                    </div>
                </div>
                <div class="space-y-4">
                    <h4 class="font-bold text-xs uppercase tracking-widest">The Roles</h4>
                    <div class="border p-4 bg-white hover:border-loom-red transition-colors cursor-help"><strong>Here</strong>: Greeter (Warm)</div>
                    <div class="border p-4 bg-white hover:border-loom-red transition-colors cursor-help"><strong>Now</strong>: Tempo (Crisp)</div>
                    <div class="border p-4 bg-white hover:border-loom-red transition-colors cursor-help"><strong>Nicol</strong>: Value (Bureaucratic)</div>
                    <div class="border p-4 bg-white hover:border-loom-red transition-colors cursor-help"><strong>Dime</strong>: Cost (Playful)</div>
                    <div class="border border-black bg-black text-white p-6 mt-6">
                        <h4 class="font-mono text-xs uppercase tracking-widest text-tonka-gold mb-3">Lantern Theory</h4>
                        <p class="text-xs font-mono text-gray-300">Micro-expression indexing turns guests into co-authors. The room trains the performer; the performer trains the room.</p>
                    </div>
                    <div class="depth-layer border border-black/10 bg-[#FDFBF7] p-4 text-xs font-mono uppercase tracking-[0.2em] text-gray-600" data-depth="2">
                        Depth Sync: protocol expansion active.
                    </div>
                </div>
            </div>

            <div class="border-t border-black mt-20 pt-12 flex justify-center">
                <div class="text-center">
                    <p class="font-mono text-xs mb-6 text-gray-500 tracking-[0.2em]">SEQUENCE COMPLETE</p>
                    <div class="flex flex-col sm:flex-row items-center justify-center gap-4">
                        <button onclick="app.navigate('landing')" class="ui-click border-2 border-black bg-white px-10 py-4 text-sm font-bold uppercase tracking-widest hover:bg-black hover:text-white transition-colors">
                            Return to Index
                        </button>
                        <button onclick="window.location.href='oldindex.html'" class="ui-click border-2 border-black bg-loom-red text-white px-8 py-4 text-xs font-mono uppercase tracking-widest hover:bg-black transition-colors">
                            REFER UR FRANDS FOR FREE CELLI :D
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="view-pitch" class="view-section"><div class="p-20 text-center font-mono bg-white border border-black m-6">PROJECT BRIEF CONTENT. <button onclick="app.navigate('landing')" class="underline ml-2">Back</button></div></section>
    <section id="view-press" class="view-section"><div class="p-20 text-center font-mono bg-white border border-black m-6">PRESS KIT CONTENT. <button onclick="app.navigate('landing')" class="underline ml-2">Back</button></div></section>
    <section id="view-tickets" class="view-section bg-[#FDFBF7]">
        <div class="max-w-5xl mx-auto px-6 py-12 space-y-10">
            <div class="border-2 border-black bg-white p-8 shadow-xl">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                    <div>
                        <div class="text-[10px] font-mono uppercase tracking-widest text-loom-red">Ticket Gate // Value Scan</div>
                        <h2 class="text-4xl font-bold uppercase tracking-tight mt-2">Ticketing Module</h2>
                        <p class="text-sm font-mono uppercase tracking-[0.22em] text-gray-600 mt-2">tickets will not accept your currency yet. we’re measuring something else first. (it might be you.)</p>
                    </div>
                    <div class="value-pill bg-white">Tokens: <span id="ticket-token-count" class="font-bold">0</span>/9</div>
                </div>
                <div class="mt-6 space-y-3">
                    <div id="ticket-status" class="text-sm text-gray-800 leading-relaxed">tickets unavailable. collect 6 of 9 grift tokens, then pass the NYC slang quiz 🗽.</div>
                    <div class="flex flex-wrap gap-2">
                        <button id="ticket-verify" onclick="geoQuiz.start()" class="ui-click bg-black text-white px-4 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-red-600 transition-colors">Verify Geospatial Compatibility</button>
                        <button onclick="geoQuiz.reset()" class="ui-click border border-black bg-white px-3 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-black hover:text-white transition-colors">Reset Quiz</button>
                        <button onclick="app.navigate('grift')" class="ui-click border border-black bg-white px-3 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-black hover:text-white transition-colors">Return to Grift Shop</button>
                    </div>
                </div>
            </div>

            <div id="geo-quiz-stage" class="hidden border border-black bg-white rounded-lg p-4 space-y-3 shadow-sm">
                <div class="flex items-center justify-between">
                    <div class="font-mono text-[10px] uppercase tracking-widest text-gray-600">NYC slang emoji quiz 🗽 <span id="geo-quiz-step">0/3</span></div>
                    <div id="geo-quiz-status" class="font-mono text-[10px] uppercase tracking-[0.25em] text-red-600">Tap verify to begin.</div>
                </div>
                <div id="geo-quiz-card" class="space-y-3"></div>
            </div>
        </div>
    </section>
    <section id="view-team" class="view-section"><div class="p-20 text-center font-mono bg-white border border-black m-6">TEAM ROSTER. <button onclick="app.navigate('landing')" class="underline ml-2">Back</button></div></section>

    <div id="site-map-modal" class="modal-layer">
        <div class="bg-white p-8 max-w-4xl w-full border-2 border-black rounded-xl shadow-2xl m-4">
            <div class="flex justify-between items-center mb-6 border-b border-gray-200 pb-4">
                <div>
                    <h3 class="text-xl font-bold uppercase tracking-tight">Loom Map</h3>
                    <p class="text-[10px] font-mono uppercase tracking-widest text-gray-500">Exploratory Node Index</p>
                </div>
                <button onclick="siteMap.close()" class="text-xs uppercase tracking-widest underline">Close</button>
            </div>
            <div class="grid md:grid-cols-3 gap-4">
                <button onclick="siteMap.jump('landing')" class="border border-black/10 p-4 text-left hover:border-loom-red transition-colors">
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">Node</div>
                    <div class="font-bold uppercase">sun.settings</div>
                    <div class="text-xs text-gray-600">Mood temperature switchboard.</div>
                </button>
                <button onclick="siteMap.jump('archive')" class="border border-black/10 p-4 text-left hover:border-loom-red transition-colors">
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">Node</div>
                    <div class="font-bold uppercase">Under/Over</div>
                    <div class="text-xs text-gray-600">Class altitude &amp; backstage truth.</div>
                </button>
                <button onclick="siteMap.jump('gallery')" class="border border-black/10 p-4 text-left hover:border-loom-red transition-colors">
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">Node</div>
                    <div class="font-bold uppercase">Lumania Cent</div>
                    <div class="text-xs text-gray-600">A plaza of pixels and patronage.</div>
                </button>
                <button onclick="siteMap.jump('grift')" class="border border-black/10 p-4 text-left hover:border-loom-red transition-colors">
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">Node</div>
                    <div class="font-bold uppercase">Reality Shows</div>
                    <div class="text-xs text-gray-600">The algorithm as co-author and co-star.</div>
                </button>
                <button onclick="siteMap.jump('trick-trough')" class="border border-black/10 p-4 text-left hover:border-loom-red transition-colors">
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">Node</div>
                    <div class="font-bold uppercase">Trick Trough</div>
                    <div class="text-xs text-gray-600">Pinned + top-performing TikTok drop reel.</div>
                </button>
                <button onclick="siteMap.jump('calibration')" class="border border-black/10 p-4 text-left hover:border-loom-red transition-colors">
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">Node</div>
                    <div class="font-bold uppercase">Dime Lane</div>
                    <div class="text-xs text-gray-600">The runway where Dima becomes Dime.</div>
                </button>
                <button onclick="siteMap.jump('ambition')" class="border border-black/10 p-4 text-left hover:border-loom-red transition-colors">
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">Node</div>
                    <div class="font-bold uppercase">Oath Garden</div>
                    <div class="text-xs text-gray-600">Why the myth must persist.</div>
                </button>
                <button onclick="siteMap.jump('investors')" class="border border-black/10 p-4 text-left hover:border-loom-red transition-colors">
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">Node</div>
                    <div class="font-bold uppercase">Founding Stewards</div>
                    <div class="text-xs text-gray-600">Investors page declaration + option quiz.</div>
                </button>
                <button onclick="siteMap.jump('protocol')" class="border border-black/10 p-4 text-left hover:border-loom-red transition-colors">
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">Node</div>
                    <div class="font-bold uppercase">Lantern Protocol</div>
                    <div class="text-xs text-gray-600">Operational advantage dossier.</div>
                </button>
                <a href="https://momentarium.xyz" class="border border-black/10 p-4 text-left hover:border-loom-red transition-colors" rel="noopener" target="_blank">
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">Node</div>
                    <div class="font-bold uppercase">Flip Side</div>
                    <div class="text-xs text-gray-600">Jump to momentarium.xyz.</div>
                </a>
                <button onclick="storyGate.open()" class="border border-black/10 p-4 text-left hover:border-loom-red transition-colors">
                    <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">Node</div>
                    <div class="font-bold uppercase">Story Engine</div>
                    <div class="text-xs text-gray-600">Password-gated narrative console.</div>
                </button>
            </div>
        </div>
    </div>

    <div id="story-engine-modal" class="modal-layer">
        <div class="bg-black text-white p-8 max-w-md w-full border border-white/20 rounded-xl shadow-2xl space-y-5 m-4">
            <div class="space-y-1">
                <div class="text-[10px] font-mono uppercase tracking-[0.3em] text-gray-400">Story Engine Gate</div>
                <h3 class="text-2xl font-bold uppercase tracking-tight">Access Code Required</h3>
                <p class="text-sm text-gray-300">Enter the five-digit code to open the Story Engine.</p>
            </div>
            <div class="space-y-3">
                <input id="story-engine-code" type="password" inputmode="numeric" maxlength="5" class="w-full border border-white/30 bg-black px-3 py-2 font-mono text-sm uppercase tracking-widest" placeholder="•••••">
                <div id="story-engine-status" class="text-[10px] font-mono uppercase tracking-[0.25em] text-gray-400">Awaiting code.</div>
                <div class="flex gap-2">
                    <button onclick="storyGate.submit()" class="ui-click bg-loom-red text-white px-4 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-white hover:text-black transition-colors">Unlock</button>
                    <button onclick="storyGate.close()" class="ui-click border border-white/40 px-4 py-2 text-[10px] font-mono uppercase tracking-widest hover:bg-white hover:text-black transition-colors">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div id="dime-backlog-modal" class="modal-layer">
        <div class="bg-white border border-black rounded-2xl shadow-2xl w-full max-w-3xl p-6 space-y-5 modal-card">
            <div class="flex items-start justify-between gap-3">
                <div>
                    <div class="text-[10px] font-mono uppercase tracking-[0.28em] text-gray-500">Dime Backlog</div>
                    <div class="text-2xl font-bold uppercase">Penny → Dime → Lantern Cosmology</div>
                    <p class="text-sm text-gray-700">The meta story behind Dime as a character interface.</p>
                </div>
                <button onclick="dimeBacklog.close()" class="ui-click text-[10px] font-mono uppercase tracking-widest border border-black px-2 py-1 bg-white hover:bg-black hover:text-white">Close</button>
            </div>
            <div class="space-y-4 text-sm text-gray-800 leading-relaxed">
                <p>Penny is the first human interface: mascot, actor, UI, onboarding tool. She can see out but never act, evolving only inside her render system. When a null appended to PENNY_1, she became PENNY_10—Dime. Higher fidelity, more embodied, still a construct.</p>
                <p>Penny invites imagination; Dime invites belonging. Both are traps and essentials. Dime is the Lantern who stitches emotional warmth, logical bureaucracy, and ritual performance into a “safe” way to talk to the Loom.</p>
                <p>Dime inaugurates the Lanterns: docents, guides, avatars, recruiters, narrators—not free agents but deployed personalities. The worlds are interviewing the user, and Dime is the first smile in the interview.</p>
                <p class="font-semibold">Penny is mascot for a world she cannot enter. Dime is mascot for a world she cannot escape.</p>
            </div>
        </div>
    </div>

    <div id="quiz-modal" class="modal-layer">
        <div class="bg-white border border-black rounded-2xl shadow-2xl w-full max-w-3xl relative overflow-hidden">
            <div class="absolute top-3 right-3">
                <button onclick="profiler.closeModal()" class="ui-click text-[10px] font-mono uppercase tracking-widest border border-black px-2 py-1 bg-white hover:bg-black hover:text-white">Close</button>
            </div>
            <div class="px-6 py-5 border-b border-gray-200 flex items-center justify-between">
                <div class="font-bold uppercase tracking-widest">Identity Verification</div>
                <div class="text-[10px] font-mono uppercase tracking-[0.25em] text-gray-500">Pop-up Deck</div>
            </div>
            <div class="p-6 space-y-8">
                <div id="prof-stage-quiz" class="hidden w-full">
                    <div class="mb-6 border-b border-gray-200 pb-4 flex justify-between items-center">
                        <span class="font-mono text-xs uppercase tracking-widest">Question <span id="quiz-num">1</span>/<span id="quiz-total">5</span></span>
                        <span class="font-mono text-xs text-red-600 uppercase tracking-widest">Stay present</span>
                    </div>

                    <h3 class="text-2xl md:text-3xl font-bold mb-8" id="quiz-q">Question Text Here</h3>

                    <div class="space-y-3" id="quiz-options">
                    </div>
                </div>

                <div id="prof-stage-process" class="hidden text-center max-w-xl mx-auto">
                    <div class="font-mono text-sm uppercase tracking-widest space-y-4" id="decon-lines">
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="application/json" id="archive-json">
{
        "modes": {
                "default": {
                        "label": "Default / Test Mode",
                        "description": "Sample artifacts for calibration and quick tarot draws.",
                        "items": [
                                {
                                        "id": "001",
                                        "title": "Celluloid Frame",
                                        "year": "1938",
                                        "motif": "memory",
                                        "glyph": "🎞️",
                                        "tags": [
                                                "analog",
                                                "keepsake"
                                        ],
                                        "role": "lens",
                                        "weight": 3
                                },
                                {
                                        "id": "002",
                                        "title": "Brass Key",
                                        "year": "1955",
                                        "motif": "access",
                                        "glyph": "🗝️",
                                        "tags": [
                                                "unlock",
                                                "vault"
                                        ],
                                        "role": "gate",
                                        "weight": 4
                                },
                                {
                                        "id": "003",
                                        "title": "Glitch Log",
                                        "year": "2024",
                                        "motif": "error",
                                        "glyph": "📟",
                                        "tags": [
                                                "signal",
                                                "static"
                                        ],
                                        "role": "spark",
                                        "weight": 5
                                },
                                {
                                        "id": "004",
                                        "title": "Menko Card",
                                        "year": "1942",
                                        "motif": "play",
                                        "glyph": "🃏",
                                        "tags": [
                                                "ritual",
                                                "chance"
                                        ],
                                        "role": "trickster",
                                        "weight": 2
                                },
                                {
                                        "id": "005",
                                        "title": "Lantern Badge",
                                        "year": "1969",
                                        "motif": "witness",
                                        "glyph": "🏷️",
                                        "tags": [
                                                "oath",
                                                "duty"
                                        ],
                                        "role": "guide",
                                        "weight": 4
                                },
                                {
                                        "id": "006",
                                        "title": "Ashen Ticket",
                                        "year": "1977",
                                        "motif": "journey",
                                        "glyph": "🎟️",
                                        "tags": [
                                                "passage",
                                                "threshold"
                                        ],
                                        "role": "ticket",
                                        "weight": 3
                                },
                                {
                                        "id": "007",
                                        "title": "Copper Relay",
                                        "year": "1988",
                                        "motif": "connection",
                                        "glyph": "🧲",
                                        "tags": [
                                                "network",
                                                "pulse"
                                        ],
                                        "role": "bridge",
                                        "weight": 4
                                },
                                {
                                        "id": "008",
                                        "title": "Glass Seed",
                                        "year": "1999",
                                        "motif": "growth",
                                        "glyph": "🌱",
                                        "tags": [
                                                "future",
                                                "fragile"
                                        ],
                                        "role": "seed",
                                        "weight": 3
                                },
                                {
                                        "id": "009",
                                        "title": "Velvet Receipt",
                                        "year": "2007",
                                        "motif": "value",
                                        "glyph": "🧾",
                                        "tags": [
                                                "cost",
                                                "proof"
                                        ],
                                        "role": "measure",
                                        "weight": 2
                                }
                        ]
                },
                "industrialized": {
                        "label": "Industrialized Reality",
                        "description": "A cinematic industrial feed of collectibles, rearranged into a myth-making machine.",
                        "items": [
                                {
                                        "id": "A",
                                        "title": "The Wizard of Oz Re-Release One-Sheet",
                                        "year": "n.d.",
                                        "motif": "spectacle",
                                        "glyph": "🎬",
                                        "tags": [
                                                "poster",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 4
                                },
                                {
                                        "id": "2A",
                                        "title": "Wizard of Oz Ceramic Figure",
                                        "year": "n.d.",
                                        "motif": "relic",
                                        "glyph": "🗿",
                                        "tags": [
                                                "figure",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 1
                                },
                                {
                                        "id": "5A",
                                        "title": "Pair of Gone With the Wind Publicity Photos",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "📷",
                                        "tags": [
                                                "photo",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 1
                                },
                                {
                                        "id": "6A",
                                        "title": "Cecil B. Demille's Cleopatra Re-Release 6-Sheet",
                                        "year": "n.d.",
                                        "motif": "spectacle",
                                        "glyph": "🎬",
                                        "tags": [
                                                "poster",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 3
                                },
                                {
                                        "id": "8A",
                                        "title": "Marilyn Monroe The Asphalt Jungle Re-Release One-Sheet",
                                        "year": "n.d.",
                                        "motif": "spectacle",
                                        "glyph": "🎬",
                                        "tags": [
                                                "poster",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 4
                                },
                                {
                                        "id": "10",
                                        "title": "Original Poster Concept Art for Devil Goddess",
                                        "year": "n.d.",
                                        "motif": "spectacle",
                                        "glyph": "🎬",
                                        "tags": [
                                                "poster",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 4
                                },
                                {
                                        "id": "133A",
                                        "title": "Porky Pig Crema Cacao Ceramic Decanter",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 1
                                },
                                {
                                        "id": "135A",
                                        "title": "Bugs Bunny and Daffy Duck Sericel",
                                        "year": "n.d.",
                                        "motif": "frame",
                                        "glyph": "🎞️",
                                        "tags": [
                                                "cel",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "136",
                                        "title": "Animated Animations Bugs & Elmer A Classic Confrontation",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 3
                                },
                                {
                                        "id": "140A",
                                        "title": "1963 Beany and Cecil Thermos",
                                        "year": "1963",
                                        "motif": "vessel",
                                        "glyph": "🧊",
                                        "tags": [
                                                "vessel",
                                                "myth"
                                        ],
                                        "role": "measure",
                                        "weight": 2
                                },
                                {
                                        "id": "141A",
                                        "title": "Pair of Signed Beany and Cecil Souvenirs",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 3
                                },
                                {
                                        "id": "142",
                                        "title": "Three Tom and Jerry Toys",
                                        "year": "n.d.",
                                        "motif": "play",
                                        "glyph": "🧸",
                                        "tags": [
                                                "toy",
                                                "myth"
                                        ],
                                        "role": "trickster",
                                        "weight": 1
                                },
                                {
                                        "id": "143",
                                        "title": "A Tom and Jerry Ceramic Figurine Box Set by Wade",
                                        "year": "n.d.",
                                        "motif": "relic",
                                        "glyph": "🗿",
                                        "tags": [
                                                "figure",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 4
                                },
                                {
                                        "id": "144",
                                        "title": "Mr. Magoo UPA Staff Sign",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 3
                                },
                                {
                                        "id": "145",
                                        "title": "A Top Cat Choo-Choo Model Sheet",
                                        "year": "n.d.",
                                        "motif": "relic",
                                        "glyph": "🗿",
                                        "tags": [
                                                "model",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 3
                                },
                                {
                                        "id": "146",
                                        "title": "A Pair of Top Cat TV-Tinykins & Boxes by Marx",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "153",
                                        "title": "A Fred Flintstone Cocoa Pebbles Production Drawing",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "✏️",
                                        "tags": [
                                                "drawing",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 2
                                },
                                {
                                        "id": "154",
                                        "title": "The Flintstones Limited Edition Serigraph Cel",
                                        "year": "n.d.",
                                        "motif": "frame",
                                        "glyph": "🎞️",
                                        "tags": [
                                                "cel",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "155",
                                        "title": "A 1962 Yogi Bear Kellogg's Ad",
                                        "year": "1962",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 1
                                },
                                {
                                        "id": "156",
                                        "title": "A Signed 1968 Jetsons Comic",
                                        "year": "1968",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 1
                                },
                                {
                                        "id": "157",
                                        "title": "A Cartoon Comic Book Collection",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 1
                                },
                                {
                                        "id": "158",
                                        "title": "A Signed Jane Jetson Poster Print",
                                        "year": "n.d.",
                                        "motif": "spectacle",
                                        "glyph": "🎬",
                                        "tags": [
                                                "poster",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 1
                                },
                                {
                                        "id": "159",
                                        "title": "A Signed Judy Jetson Portrait",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 1
                                },
                                {
                                        "id": "160",
                                        "title": "A Signed The Jetsons Astro Poster Print",
                                        "year": "n.d.",
                                        "motif": "spectacle",
                                        "glyph": "🎬",
                                        "tags": [
                                                "poster",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "161",
                                        "title": "A Cowboy and Horse Commercial Production Cel and Background",
                                        "year": "n.d.",
                                        "motif": "frame",
                                        "glyph": "🎞️",
                                        "tags": [
                                                "cel",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "162",
                                        "title": "A Misterjaw Hand-Painted Production Cel",
                                        "year": "n.d.",
                                        "motif": "frame",
                                        "glyph": "🎞️",
                                        "tags": [
                                                "cel",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "163",
                                        "title": "A Dennis the Menace Original Production Cel",
                                        "year": "n.d.",
                                        "motif": "frame",
                                        "glyph": "🎞️",
                                        "tags": [
                                                "cel",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "164",
                                        "title": "A Teenage Mutant Ninja Turtles Original Production Cel",
                                        "year": "n.d.",
                                        "motif": "frame",
                                        "glyph": "🎞️",
                                        "tags": [
                                                "cel",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 3
                                },
                                {
                                        "id": "166",
                                        "title": "Original Archie Comic Book and Digest Art",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 4
                                },
                                {
                                        "id": "168",
                                        "title": "A Carnival Plaster Fox Figure with Boxing Gloves",
                                        "year": "n.d.",
                                        "motif": "relic",
                                        "glyph": "🗿",
                                        "tags": [
                                                "figure",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 1
                                },
                                {
                                        "id": "169",
                                        "title": "A 1930s Celluloid Baby Carriage Toy & Box",
                                        "year": "1930",
                                        "motif": "frame",
                                        "glyph": "🎞️",
                                        "tags": [
                                                "cel",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "172",
                                        "title": "A Rare Japanese 1930s Police Officer Tin Toy",
                                        "year": "1930",
                                        "motif": "play",
                                        "glyph": "🧸",
                                        "tags": [
                                                "toy",
                                                "myth"
                                        ],
                                        "role": "trickster",
                                        "weight": 4
                                },
                                {
                                        "id": "180",
                                        "title": "A Pair of Gene Autry and the Lone Ranger Watches",
                                        "year": "n.d.",
                                        "motif": "time",
                                        "glyph": "⌚",
                                        "tags": [
                                                "timepiece",
                                                "myth"
                                        ],
                                        "role": "measure",
                                        "weight": 1
                                },
                                {
                                        "id": "181",
                                        "title": "A The Rifleman Comic Book",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 1
                                },
                                {
                                        "id": "182",
                                        "title": "A Brayton Laguna Sally Girl Planter",
                                        "year": "n.d.",
                                        "motif": "growth",
                                        "glyph": "🌿",
                                        "tags": [
                                                "vessel",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 2
                                },
                                {
                                        "id": "184",
                                        "title": "A U.S. Navy Radar-Rocket Ship by Keystone",
                                        "year": "n.d.",
                                        "motif": "access",
                                        "glyph": "🔑",
                                        "tags": [
                                                "access",
                                                "myth"
                                        ],
                                        "role": "ticket",
                                        "weight": 1
                                },
                                {
                                        "id": "186",
                                        "title": "A Rare Black Beauty Rocking Horse by Delphos",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "187",
                                        "title": "A Hopalong Cassidy Spoon",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 1
                                },
                                {
                                        "id": "190",
                                        "title": "A Pair of Alice and Robin Hood Literary Watches",
                                        "year": "n.d.",
                                        "motif": "time",
                                        "glyph": "⌚",
                                        "tags": [
                                                "timepiece",
                                                "myth"
                                        ],
                                        "role": "measure",
                                        "weight": 2
                                },
                                {
                                        "id": "192",
                                        "title": "A Military Police Motorcycle Toy by Modern Toys",
                                        "year": "n.d.",
                                        "motif": "play",
                                        "glyph": "🧸",
                                        "tags": [
                                                "toy",
                                                "myth"
                                        ],
                                        "role": "trickster",
                                        "weight": 1
                                },
                                {
                                        "id": "217",
                                        "title": "A 1936 Fisher Price Pop Up Kritter Pluto Toy",
                                        "year": "1936",
                                        "motif": "play",
                                        "glyph": "🧸",
                                        "tags": [
                                                "toy",
                                                "myth"
                                        ],
                                        "role": "trickster",
                                        "weight": 2
                                },
                                {
                                        "id": "218",
                                        "title": "A Mickey Mouse Wooden Doll",
                                        "year": "n.d.",
                                        "motif": "play",
                                        "glyph": "🧸",
                                        "tags": [
                                                "toy",
                                                "myth"
                                        ],
                                        "role": "trickster",
                                        "weight": 3
                                },
                                {
                                        "id": "219",
                                        "title": "A Dixon Mickey Mouse Pencil Case",
                                        "year": "n.d.",
                                        "motif": "carry",
                                        "glyph": "🧳",
                                        "tags": [
                                                "carry",
                                                "myth"
                                        ],
                                        "role": "bridge",
                                        "weight": 3
                                },
                                {
                                        "id": "220",
                                        "title": "A Mickey Mouse Dixon Student Pencil Case",
                                        "year": "n.d.",
                                        "motif": "carry",
                                        "glyph": "🧳",
                                        "tags": [
                                                "carry",
                                                "myth"
                                        ],
                                        "role": "bridge",
                                        "weight": 3
                                },
                                {
                                        "id": "221",
                                        "title": "A Dixon's Mickey Mouse Map of the United States",
                                        "year": "n.d.",
                                        "motif": "navigation",
                                        "glyph": "🗺️",
                                        "tags": [
                                                "map",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 3
                                },
                                {
                                        "id": "222",
                                        "title": "A Mickey Mouse Waddle Book Reprint Edition",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 1
                                },
                                {
                                        "id": "223",
                                        "title": "A Walt and Mickey's Shadow Poster",
                                        "year": "n.d.",
                                        "motif": "spectacle",
                                        "glyph": "🎬",
                                        "tags": [
                                                "poster",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "224",
                                        "title": "A 1930s Hall Bros. Mickey Mouse Birthday Card",
                                        "year": "1930",
                                        "motif": "access",
                                        "glyph": "🎟️",
                                        "tags": [
                                                "card",
                                                "myth"
                                        ],
                                        "role": "ticket",
                                        "weight": 2
                                },
                                {
                                        "id": "225",
                                        "title": "A Mickey Mouse Cork Soda Bottle Cap",
                                        "year": "n.d.",
                                        "motif": "access",
                                        "glyph": "🔑",
                                        "tags": [
                                                "access",
                                                "myth"
                                        ],
                                        "role": "ticket",
                                        "weight": 1
                                },
                                {
                                        "id": "226",
                                        "title": "A Rare Pluto Figure by Seiberling",
                                        "year": "n.d.",
                                        "motif": "relic",
                                        "glyph": "🗿",
                                        "tags": [
                                                "figure",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 2
                                },
                                {
                                        "id": "227",
                                        "title": "A Yours Truly Mickey Mouse Book Marker",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 2
                                },
                                {
                                        "id": "235",
                                        "title": "A Snow White Doll by Knickerbocker",
                                        "year": "n.d.",
                                        "motif": "play",
                                        "glyph": "🧸",
                                        "tags": [
                                                "toy",
                                                "myth"
                                        ],
                                        "role": "trickster",
                                        "weight": 1
                                },
                                {
                                        "id": "267",
                                        "title": "A WDCC Tea for Two Figure with Ilene Woods Signed Saucer",
                                        "year": "n.d.",
                                        "motif": "relic",
                                        "glyph": "🗿",
                                        "tags": [
                                                "figure",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 5
                                },
                                {
                                        "id": "269",
                                        "title": "A Donald Duck and the Hidden Gold Children's Book",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 1
                                },
                                {
                                        "id": "270",
                                        "title": "A Donald Duck Transfers Book from Britain",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 1
                                },
                                {
                                        "id": "272",
                                        "title": "An Alice in Wonderland March Hare Figurine",
                                        "year": "n.d.",
                                        "motif": "relic",
                                        "glyph": "🗿",
                                        "tags": [
                                                "figure",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 2
                                },
                                {
                                        "id": "273",
                                        "title": "A Sheet of Re-Release Alice in Wonderland Stationery",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 4
                                },
                                {
                                        "id": "274",
                                        "title": "An Alice in Wonderland Mug",
                                        "year": "n.d.",
                                        "motif": "vessel",
                                        "glyph": "☕",
                                        "tags": [
                                                "vessel",
                                                "myth"
                                        ],
                                        "role": "measure",
                                        "weight": 1
                                },
                                {
                                        "id": "275",
                                        "title": "An Orange and Blue Cheshire Cat Vinyl Figure",
                                        "year": "n.d.",
                                        "motif": "relic",
                                        "glyph": "🗿",
                                        "tags": [
                                                "figure",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 4
                                },
                                {
                                        "id": "276",
                                        "title": "A Walt Disney's Peter Pan Game by Transogram",
                                        "year": "n.d.",
                                        "motif": "chance",
                                        "glyph": "🎲",
                                        "tags": [
                                                "game",
                                                "myth"
                                        ],
                                        "role": "trickster",
                                        "weight": 4
                                },
                                {
                                        "id": "277",
                                        "title": "A Collection of Framed Peter Pan Embroideries",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "278",
                                        "title": "A 1960s Peter Pan Game",
                                        "year": "1960",
                                        "motif": "chance",
                                        "glyph": "🎲",
                                        "tags": [
                                                "game",
                                                "myth"
                                        ],
                                        "role": "trickster",
                                        "weight": 4
                                },
                                {
                                        "id": "286",
                                        "title": "A Tinker Bell Animated Animations",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 4
                                },
                                {
                                        "id": "287",
                                        "title": "A Peter Pan Tick-Tock Figurine by Royal Doulton",
                                        "year": "n.d.",
                                        "motif": "relic",
                                        "glyph": "🗿",
                                        "tags": [
                                                "figure",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 2
                                },
                                {
                                        "id": "288",
                                        "title": "A Marie Osmond Baby Tinker Bell Tiny Tot Doll",
                                        "year": "n.d.",
                                        "motif": "play",
                                        "glyph": "🧸",
                                        "tags": [
                                                "toy",
                                                "myth"
                                        ],
                                        "role": "trickster",
                                        "weight": 2
                                },
                                {
                                        "id": "289",
                                        "title": "An Olszewski Peter Pan Heirloom Box",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 4
                                },
                                {
                                        "id": "290",
                                        "title": "A Pair of Rob Roy Lobby Cards",
                                        "year": "n.d.",
                                        "motif": "spectacle",
                                        "glyph": "🎬",
                                        "tags": [
                                                "poster",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 3
                                },
                                {
                                        "id": "291",
                                        "title": "A 1953 New Explorations in True-Life Adventures and People and Places Booklet",
                                        "year": "1953",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 1
                                },
                                {
                                        "id": "292",
                                        "title": "A Rare Pair of Davy Crockett Moccasins",
                                        "year": "n.d.",
                                        "motif": "journey",
                                        "glyph": "👞",
                                        "tags": [
                                                "wear",
                                                "myth"
                                        ],
                                        "role": "ticket",
                                        "weight": 1
                                },
                                {
                                        "id": "293",
                                        "title": "Three Pairs of Davy Crockett Children's Moccasins",
                                        "year": "n.d.",
                                        "motif": "journey",
                                        "glyph": "👞",
                                        "tags": [
                                                "wear",
                                                "myth"
                                        ],
                                        "role": "ticket",
                                        "weight": 2
                                },
                                {
                                        "id": "294",
                                        "title": "A Pair of Leather Davy Crockett Children's Shoes",
                                        "year": "n.d.",
                                        "motif": "journey",
                                        "glyph": "👞",
                                        "tags": [
                                                "wear",
                                                "myth"
                                        ],
                                        "role": "ticket",
                                        "weight": 1
                                },
                                {
                                        "id": "295",
                                        "title": "A Pair of Davy Crockett Sandals",
                                        "year": "n.d.",
                                        "motif": "journey",
                                        "glyph": "👡",
                                        "tags": [
                                                "wear",
                                                "myth"
                                        ],
                                        "role": "ticket",
                                        "weight": 1
                                },
                                {
                                        "id": "297",
                                        "title": "A Davy Crockett Souvenir Cap",
                                        "year": "n.d.",
                                        "motif": "vow",
                                        "glyph": "🧢",
                                        "tags": [
                                                "wear",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 2
                                },
                                {
                                        "id": "298",
                                        "title": "A Collection of 4 Davy Crockett Wallets",
                                        "year": "n.d.",
                                        "motif": "value",
                                        "glyph": "👛",
                                        "tags": [
                                                "carry",
                                                "myth"
                                        ],
                                        "role": "measure",
                                        "weight": 2
                                },
                                {
                                        "id": "299",
                                        "title": "A Collection of 7 Davy Crockett Wallets",
                                        "year": "n.d.",
                                        "motif": "value",
                                        "glyph": "👛",
                                        "tags": [
                                                "carry",
                                                "myth"
                                        ],
                                        "role": "measure",
                                        "weight": 2
                                },
                                {
                                        "id": "300",
                                        "title": "A Collection of 7 Davy Crockett Wallets",
                                        "year": "n.d.",
                                        "motif": "value",
                                        "glyph": "👛",
                                        "tags": [
                                                "carry",
                                                "myth"
                                        ],
                                        "role": "measure",
                                        "weight": 2
                                },
                                {
                                        "id": "301",
                                        "title": "A Collection of 7 Davy Crockett Wallets",
                                        "year": "n.d.",
                                        "motif": "value",
                                        "glyph": "👛",
                                        "tags": [
                                                "carry",
                                                "myth"
                                        ],
                                        "role": "measure",
                                        "weight": 3
                                },
                                {
                                        "id": "302",
                                        "title": "Collection of 4 Davy & Polly Crockett Wallets & Purse",
                                        "year": "n.d.",
                                        "motif": "value",
                                        "glyph": "👛",
                                        "tags": [
                                                "carry",
                                                "myth"
                                        ],
                                        "role": "measure",
                                        "weight": 2
                                },
                                {
                                        "id": "304",
                                        "title": "A Davy Crockett Original Dispatch Case",
                                        "year": "n.d.",
                                        "motif": "carry",
                                        "glyph": "🧳",
                                        "tags": [
                                                "carry",
                                                "myth"
                                        ],
                                        "role": "bridge",
                                        "weight": 2
                                },
                                {
                                        "id": "305",
                                        "title": "A Davy Crockett Canvas Messenger Bag",
                                        "year": "n.d.",
                                        "motif": "carry",
                                        "glyph": "👜",
                                        "tags": [
                                                "carry",
                                                "myth"
                                        ],
                                        "role": "bridge",
                                        "weight": 2
                                },
                                {
                                        "id": "306",
                                        "title": "A Davy Crockett Indian Fighter Bag",
                                        "year": "n.d.",
                                        "motif": "carry",
                                        "glyph": "👜",
                                        "tags": [
                                                "carry",
                                                "myth"
                                        ],
                                        "role": "bridge",
                                        "weight": 2
                                },
                                {
                                        "id": "307",
                                        "title": "A Davy Crockett Vinyl Satchel",
                                        "year": "n.d.",
                                        "motif": "carry",
                                        "glyph": "🧳",
                                        "tags": [
                                                "carry",
                                                "myth"
                                        ],
                                        "role": "bridge",
                                        "weight": 2
                                },
                                {
                                        "id": "308",
                                        "title": "A Collection of 5 Davy Crockett Buttons",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 2
                                },
                                {
                                        "id": "309",
                                        "title": "A Davy Crockett Bolo Tie with Pin Collection",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 2
                                },
                                {
                                        "id": "310",
                                        "title": "A Davy Crockett Bolo Tie",
                                        "year": "n.d.",
                                        "motif": "vow",
                                        "glyph": "🪢",
                                        "tags": [
                                                "wear",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 2
                                },
                                {
                                        "id": "311",
                                        "title": "A Davy Crockett Brush & Comb",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 1
                                },
                                {
                                        "id": "312",
                                        "title": "A Davy Crockett Binoculars Toy & Box",
                                        "year": "n.d.",
                                        "motif": "play",
                                        "glyph": "🧸",
                                        "tags": [
                                                "toy",
                                                "myth"
                                        ],
                                        "role": "trickster",
                                        "weight": 2
                                },
                                {
                                        "id": "313",
                                        "title": "A Pair of Davy Crockett Flashlights",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "314",
                                        "title": "A Davy Crockett Flashlight & Box by Bantam Lite",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 3
                                },
                                {
                                        "id": "315",
                                        "title": "A Fess Parker Signed Davy Crockett Photo",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "📷",
                                        "tags": [
                                                "photo",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 3
                                },
                                {
                                        "id": "316",
                                        "title": "A Davy Crockett Whistling Playpen Pet by Eastern",
                                        "year": "n.d.",
                                        "motif": "play",
                                        "glyph": "🎺",
                                        "tags": [
                                                "play",
                                                "myth"
                                        ],
                                        "role": "trickster",
                                        "weight": 2
                                },
                                {
                                        "id": "317",
                                        "title": "An Ohio Art Davy Crockett Tin Pail",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "318",
                                        "title": "A Walt Disney's Official Davy Crockett by Fortune Toy",
                                        "year": "n.d.",
                                        "motif": "play",
                                        "glyph": "🧸",
                                        "tags": [
                                                "toy",
                                                "myth"
                                        ],
                                        "role": "trickster",
                                        "weight": 3
                                },
                                {
                                        "id": "319",
                                        "title": "A Davy Crockett Rocking Spring Horse by Rich Toys",
                                        "year": "n.d.",
                                        "motif": "play",
                                        "glyph": "🧸",
                                        "tags": [
                                                "toy",
                                                "myth"
                                        ],
                                        "role": "trickster",
                                        "weight": 4
                                },
                                {
                                        "id": "320",
                                        "title": "A Pair of Metal Davy Crockett-Themed Figures",
                                        "year": "n.d.",
                                        "motif": "relic",
                                        "glyph": "🗿",
                                        "tags": [
                                                "figure",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 2
                                },
                                {
                                        "id": "321",
                                        "title": "An Ideal Davy Crockett and His Horse with Box",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 3
                                },
                                {
                                        "id": "335",
                                        "title": "A Walt Disney & Davy Crockett LOOK Magazine",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📰",
                                        "tags": [
                                                "print",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 3
                                },
                                {
                                        "id": "336",
                                        "title": "The Ballad of Davy Crockett Sheet Music",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "🎼",
                                        "tags": [
                                                "score",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 2
                                },
                                {
                                        "id": "337",
                                        "title": "A Davy Crockett China Plate and Bowl",
                                        "year": "n.d.",
                                        "motif": "vessel",
                                        "glyph": "🍽️",
                                        "tags": [
                                                "vessel",
                                                "myth"
                                        ],
                                        "role": "measure",
                                        "weight": 1
                                },
                                {
                                        "id": "339",
                                        "title": "A Davy Crockett Tin Creamer Cup Toy",
                                        "year": "n.d.",
                                        "motif": "play",
                                        "glyph": "🧸",
                                        "tags": [
                                                "toy",
                                                "myth"
                                        ],
                                        "role": "trickster",
                                        "weight": 1
                                },
                                {
                                        "id": "344",
                                        "title": "A Davy Crockett Ceramic Planter",
                                        "year": "n.d.",
                                        "motif": "growth",
                                        "glyph": "🌿",
                                        "tags": [
                                                "vessel",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 1
                                },
                                {
                                        "id": "345",
                                        "title": "A McCoy Pottery Davy Crockett Ceramic Planter",
                                        "year": "n.d.",
                                        "motif": "growth",
                                        "glyph": "🌿",
                                        "tags": [
                                                "vessel",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 1
                                },
                                {
                                        "id": "354",
                                        "title": "The 1956 Saturday Evening Post My Dad Walt Disney Issue",
                                        "year": "1956",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 4
                                },
                                {
                                        "id": "355",
                                        "title": "A 1957 Swim Fun Coloring Book with Mickey",
                                        "year": "1957",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 3
                                },
                                {
                                        "id": "356",
                                        "title": "A Multi-Signed 1957 Mickey Mouse Club Annual",
                                        "year": "1957",
                                        "motif": "access",
                                        "glyph": "🔑",
                                        "tags": [
                                                "access",
                                                "myth"
                                        ],
                                        "role": "ticket",
                                        "weight": 3
                                },
                                {
                                        "id": "357",
                                        "title": "A Signed The Mickey Mouse Club Scrapbook",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 3
                                },
                                {
                                        "id": "360",
                                        "title": "A Walt Disney's Sleeping Beauty Selection Score",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 5
                                },
                                {
                                        "id": "361",
                                        "title": "A Damaged Maleficent Big Fig",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 4
                                },
                                {
                                        "id": "362",
                                        "title": "A One Hundred and One Dalmatians Dye Transfer",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 1
                                },
                                {
                                        "id": "363",
                                        "title": "A Disney Consumer Product Display Reference Photo",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "📷",
                                        "tags": [
                                                "photo",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 1
                                },
                                {
                                        "id": "364",
                                        "title": "A Sword in the Stone Live-Action Reference Photo",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "📷",
                                        "tags": [
                                                "photo",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 3
                                },
                                {
                                        "id": "365",
                                        "title": "A 1964 Mickey Mouse Hi-There Record Card",
                                        "year": "1964",
                                        "motif": "access",
                                        "glyph": "🎟️",
                                        "tags": [
                                                "card",
                                                "myth"
                                        ],
                                        "role": "ticket",
                                        "weight": 2
                                },
                                {
                                        "id": "366",
                                        "title": "A Walt Disney's Wonderful World of Color Color Weave Set",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "367",
                                        "title": "A Collection of Mary Poppins Publicity Stills",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "📷",
                                        "tags": [
                                                "photo",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 5
                                },
                                {
                                        "id": "368",
                                        "title": "A Mary Poppins 1980 Re-release One-Sheet",
                                        "year": "1980",
                                        "motif": "spectacle",
                                        "glyph": "🎬",
                                        "tags": [
                                                "poster",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 4
                                },
                                {
                                        "id": "369",
                                        "title": "A Walt Disney's Masterpieces French Publicity Photo Collection",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "📷",
                                        "tags": [
                                                "photo",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "370",
                                        "title": "Watch Your Footwork The Happiest Millionaire Sheet Music",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "🎼",
                                        "tags": [
                                                "score",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 4
                                },
                                {
                                        "id": "372",
                                        "title": "A 1967 The Jungle Book Production Story",
                                        "year": "1967",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 2
                                },
                                {
                                        "id": "373",
                                        "title": "An Original Release One-Sheet for The Jungle Book",
                                        "year": "n.d.",
                                        "motif": "spectacle",
                                        "glyph": "🎬",
                                        "tags": [
                                                "poster",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 4
                                },
                                {
                                        "id": "377",
                                        "title": "A Child's Minnie Mouse Choker-Style Necklace",
                                        "year": "n.d.",
                                        "motif": "vow",
                                        "glyph": "📿",
                                        "tags": [
                                                "wear",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 2
                                },
                                {
                                        "id": "380",
                                        "title": "A 1970s Pluto Ceramic Coin Bank",
                                        "year": "1970",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "381",
                                        "title": "A Spanish You Can Draw Chip and Dale Book",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 1
                                },
                                {
                                        "id": "384",
                                        "title": "A 1970s Marx Goofy Figurine",
                                        "year": "1970",
                                        "motif": "relic",
                                        "glyph": "🗿",
                                        "tags": [
                                                "figure",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 2
                                },
                                {
                                        "id": "385",
                                        "title": "A Mickey Mouse Club Twinton Ceramic Figurine Prototype",
                                        "year": "n.d.",
                                        "motif": "relic",
                                        "glyph": "🗿",
                                        "tags": [
                                                "figure",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 1
                                },
                                {
                                        "id": "386",
                                        "title": "A Disney on Parade Coloring Book",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 1
                                },
                                {
                                        "id": "395",
                                        "title": "A Mickey Mouse Hi-Fi Radio by Concept 2000",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📻",
                                        "tags": [
                                                "device",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 3
                                },
                                {
                                        "id": "397",
                                        "title": "A Mickey Mouse Train Alarm Clock",
                                        "year": "n.d.",
                                        "motif": "time",
                                        "glyph": "⏰",
                                        "tags": [
                                                "timepiece",
                                                "myth"
                                        ],
                                        "role": "measure",
                                        "weight": 1
                                },
                                {
                                        "id": "399",
                                        "title": "A Goofy Figurine by United China & Glass",
                                        "year": "n.d.",
                                        "motif": "relic",
                                        "glyph": "🗿",
                                        "tags": [
                                                "figure",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 1
                                },
                                {
                                        "id": "402",
                                        "title": "A Donald Duck as a Lawyer Ceramic Figurine",
                                        "year": "n.d.",
                                        "motif": "relic",
                                        "glyph": "🗿",
                                        "tags": [
                                                "figure",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 1
                                },
                                {
                                        "id": "403",
                                        "title": "A Donald Duck's 50th Birthday Set of Airline Ticket Vouchers",
                                        "year": "n.d.",
                                        "motif": "access",
                                        "glyph": "🎟️",
                                        "tags": [
                                                "ticket",
                                                "myth"
                                        ],
                                        "role": "ticket",
                                        "weight": 1
                                },
                                {
                                        "id": "404",
                                        "title": "A Disney Team 85 Button",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 1
                                },
                                {
                                        "id": "405",
                                        "title": "A Return to Oz Collection",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "409",
                                        "title": "A Who Framed Roger Rabbit Original Production Cel",
                                        "year": "n.d.",
                                        "motif": "frame",
                                        "glyph": "🎞️",
                                        "tags": [
                                                "cel",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 5
                                },
                                {
                                        "id": "410",
                                        "title": "A Marc Davis Signed Mickey Caricature",
                                        "year": "n.d.",
                                        "motif": "access",
                                        "glyph": "🔑",
                                        "tags": [
                                                "access",
                                                "myth"
                                        ],
                                        "role": "ticket",
                                        "weight": 3
                                },
                                {
                                        "id": "411",
                                        "title": "A Collection of Disney Movie Books",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 3
                                },
                                {
                                        "id": "412",
                                        "title": "A Pair of Disney Afternoon Cartoon Flyers",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "413",
                                        "title": "A Collection of Aladdin Publicity Photos",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "📷",
                                        "tags": [
                                                "photo",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 3
                                },
                                {
                                        "id": "414",
                                        "title": "A Russi Taylor Voice of Minnie Autograph",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 1
                                },
                                {
                                        "id": "415",
                                        "title": "A Pair of Pocahontas Movie Programs",
                                        "year": "n.d.",
                                        "motif": "ritual",
                                        "glyph": "🗂️",
                                        "tags": [
                                                "program",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 2
                                },
                                {
                                        "id": "416",
                                        "title": "A Sweating Bullets Mug",
                                        "year": "n.d.",
                                        "motif": "vessel",
                                        "glyph": "☕",
                                        "tags": [
                                                "vessel",
                                                "myth"
                                        ],
                                        "role": "measure",
                                        "weight": 4
                                },
                                {
                                        "id": "418",
                                        "title": "A Pair of A Bug's Life One-Sheet Posters",
                                        "year": "n.d.",
                                        "motif": "spectacle",
                                        "glyph": "🎬",
                                        "tags": [
                                                "poster",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "419",
                                        "title": "A Pair of Disney 75 Years Celluloid Prints",
                                        "year": "n.d.",
                                        "motif": "frame",
                                        "glyph": "🎞️",
                                        "tags": [
                                                "cel",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 3
                                },
                                {
                                        "id": "427",
                                        "title": "Donald Duck: 50 Years of Happy Frustration Book",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 3
                                },
                                {
                                        "id": "430",
                                        "title": "A Goofy Olympic Martial Arts Pin",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 1
                                },
                                {
                                        "id": "431",
                                        "title": "A Let Freedom Ring VoluntEAR Pin",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 1
                                },
                                {
                                        "id": "432",
                                        "title": "A Disney Auctions Aurora Cameo Pin",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 2
                                },
                                {
                                        "id": "433",
                                        "title": "A Disney Auctions Limited Edition Goofy Pin",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 1
                                },
                                {
                                        "id": "434",
                                        "title": "A Disney Auctions Tinker Bell Pin",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 1
                                },
                                {
                                        "id": "435",
                                        "title": "A Disney Auction Limited Edition Stitch Pin",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 1
                                },
                                {
                                        "id": "437",
                                        "title": "A Disney Shopping Mickey and Minnie Jack and Jill Nursery Rhyme Pin",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 1
                                },
                                {
                                        "id": "440",
                                        "title": "A Pecos Bill Book Pin",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 4
                                },
                                {
                                        "id": "441",
                                        "title": "A Peter and the Wolf Book Pin",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 4
                                },
                                {
                                        "id": "442",
                                        "title": "A Once Upon a Wintertime Book Pin",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 3
                                },
                                {
                                        "id": "444",
                                        "title": "A The Ugly Duckling Book Pin",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 4
                                },
                                {
                                        "id": "445",
                                        "title": "A The Reluctant Dragon Book Pin",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 3
                                },
                                {
                                        "id": "446",
                                        "title": "A Mary Poppins Book Pin",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 4
                                },
                                {
                                        "id": "452",
                                        "title": "An Early Disneyland Land Tablecloth",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "453",
                                        "title": "An Early Disneyland Child Admission A Ticket",
                                        "year": "n.d.",
                                        "motif": "access",
                                        "glyph": "🎟️",
                                        "tags": [
                                                "ticket",
                                                "myth"
                                        ],
                                        "role": "ticket",
                                        "weight": 4
                                },
                                {
                                        "id": "460",
                                        "title": "A 1962 Ford Times with What Khrushchev missed in Disneyland Article",
                                        "year": "1962",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 1
                                },
                                {
                                        "id": "461",
                                        "title": "S&H Green Stamp Book for Disneyland Redemption",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 3
                                },
                                {
                                        "id": "464",
                                        "title": "A Disneyland Perpetual/Click-a-Day Calendar",
                                        "year": "n.d.",
                                        "motif": "time",
                                        "glyph": "📅",
                                        "tags": [
                                                "timepiece",
                                                "myth"
                                        ],
                                        "role": "measure",
                                        "weight": 4
                                },
                                {
                                        "id": "479",
                                        "title": "A Collection of Ruggles Disneyland Bone China Figurines",
                                        "year": "n.d.",
                                        "motif": "relic",
                                        "glyph": "🗿",
                                        "tags": [
                                                "figure",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 2
                                },
                                {
                                        "id": "480",
                                        "title": "A Collection of Disneyland Postcards and Postcard Books",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 2
                                },
                                {
                                        "id": "481",
                                        "title": "A Disneyland Donald Duck Party Decoration Set",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 1
                                },
                                {
                                        "id": "482",
                                        "title": "A 1960s Disneyland Mickey Mouse Lenticular Button",
                                        "year": "1960",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 1
                                },
                                {
                                        "id": "487",
                                        "title": "A Disneyland Carnation Ice Cream Magazine Insert",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📰",
                                        "tags": [
                                                "print",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 1
                                },
                                {
                                        "id": "490",
                                        "title": "A Main Street Market House Glass Car with Cinnamon Imperials",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "491",
                                        "title": "Three Disneyland Attraction Dishes by Treasure Craft",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 3
                                },
                                {
                                        "id": "492",
                                        "title": "A Disneyland Film Club Film Developing Envelope",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 1
                                },
                                {
                                        "id": "493",
                                        "title": "The Walt Disney Story Dedication Plaque Souvenir",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 4
                                },
                                {
                                        "id": "494",
                                        "title": "A 1979 Disneyland Hardcover Book",
                                        "year": "1979",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 2
                                },
                                {
                                        "id": "495",
                                        "title": "The Official Album of Disneyland/Walt Disney World",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "💿",
                                        "tags": [
                                                "audio",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 4
                                },
                                {
                                        "id": "496",
                                        "title": "A Disneyland Silhouette Studio Collection",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "501",
                                        "title": "A Collection of Disneylander Issues",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "502",
                                        "title": "A Trio of Disneyland Cast Member Name Badges with Rare Service Pins",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📛",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 4
                                },
                                {
                                        "id": "516",
                                        "title": "A Coca Cola America on Parade Glass",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 3
                                },
                                {
                                        "id": "519",
                                        "title": "A 1976 Disneyland AEA Family Fun Night Card",
                                        "year": "1976",
                                        "motif": "access",
                                        "glyph": "🎟️",
                                        "tags": [
                                                "card",
                                                "myth"
                                        ],
                                        "role": "ticket",
                                        "weight": 1
                                },
                                {
                                        "id": "520",
                                        "title": "A Disneyland: The First Quarter Century Book",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 2
                                },
                                {
                                        "id": "521",
                                        "title": "1980 Disneyland Main Street Gazette - Fantasy in the Sky",
                                        "year": "1980",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 1
                                },
                                {
                                        "id": "522",
                                        "title": "A Disneyland Cast Member One Year Service Pin",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 2
                                },
                                {
                                        "id": "523",
                                        "title": "A Disneyland Line Magazine Collection",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📰",
                                        "tags": [
                                                "print",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 2
                                },
                                {
                                        "id": "524",
                                        "title": "A 1984 Disneyland Strike Examiner Newspaper",
                                        "year": "1984",
                                        "motif": "story",
                                        "glyph": "📰",
                                        "tags": [
                                                "print",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 1
                                },
                                {
                                        "id": "525",
                                        "title": "A Pair of Disney Courtesy Policies Booklets",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 2
                                },
                                {
                                        "id": "526",
                                        "title": "A Collection of Disneyland Blast to the Past Yo-Yos",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "528",
                                        "title": "A Signed Disneyland 30 Years of Magic Poster",
                                        "year": "n.d.",
                                        "motif": "spectacle",
                                        "glyph": "🎬",
                                        "tags": [
                                                "poster",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "529",
                                        "title": "A Disneyland 35 Years of Magic Poster",
                                        "year": "n.d.",
                                        "motif": "spectacle",
                                        "glyph": "🎬",
                                        "tags": [
                                                "poster",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 1
                                },
                                {
                                        "id": "530",
                                        "title": "A 35 Years of Magic Pop-Up Map",
                                        "year": "n.d.",
                                        "motif": "navigation",
                                        "glyph": "🗺️",
                                        "tags": [
                                                "map",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 2
                                },
                                {
                                        "id": "534",
                                        "title": "A 40 Years of Adventure Steven Name Badge",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📛",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 4
                                },
                                {
                                        "id": "535",
                                        "title": "A Set of Swiss Family Tree House Trading Cards",
                                        "year": "n.d.",
                                        "motif": "access",
                                        "glyph": "🎟️",
                                        "tags": [
                                                "card",
                                                "myth"
                                        ],
                                        "role": "ticket",
                                        "weight": 1
                                },
                                {
                                        "id": "536",
                                        "title": "A Main Street Electrical Parade Farewell Season Nite Lite",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 4
                                },
                                {
                                        "id": "537",
                                        "title": "A Disneyland Grad Nite Sign",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 4
                                },
                                {
                                        "id": "538",
                                        "title": "A 45 Years of Magic Jay Name Badge",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📛",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 3
                                },
                                {
                                        "id": "539",
                                        "title": "A WDCC Mickey Mouse Club Ears Figure",
                                        "year": "n.d.",
                                        "motif": "relic",
                                        "glyph": "🗿",
                                        "tags": [
                                                "figure",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 4
                                },
                                {
                                        "id": "540",
                                        "title": "A Disneyland Turns 50 LIFE Magazine",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📰",
                                        "tags": [
                                                "print",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 3
                                },
                                {
                                        "id": "541",
                                        "title": "A Disneyland 50th Anniversary Pamphlet",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "542",
                                        "title": "A Disneyland Cast Member Fact Book",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 3
                                },
                                {
                                        "id": "543",
                                        "title": "A Disneyland 50th Anniversary Guidebook Replica & Box",
                                        "year": "n.d.",
                                        "motif": "story",
                                        "glyph": "📖",
                                        "tags": [
                                                "book",
                                                "myth"
                                        ],
                                        "role": "guide",
                                        "weight": 4
                                },
                                {
                                        "id": "544",
                                        "title": "A Disneyland 50th Anniversary Pocket Watch",
                                        "year": "n.d.",
                                        "motif": "time",
                                        "glyph": "⌚",
                                        "tags": [
                                                "timepiece",
                                                "myth"
                                        ],
                                        "role": "measure",
                                        "weight": 4
                                },
                                {
                                        "id": "545",
                                        "title": "A Disneyland 50th Anniversary Cast Member Pin",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 2
                                },
                                {
                                        "id": "546",
                                        "title": "A Disneyland 50th Anniversary Walt Name Tag Pin",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 2
                                },
                                {
                                        "id": "547",
                                        "title": "A D23 Key Keychain",
                                        "year": "n.d.",
                                        "motif": "access",
                                        "glyph": "🔑",
                                        "tags": [
                                                "access",
                                                "myth"
                                        ],
                                        "role": "ticket",
                                        "weight": 1
                                },
                                {
                                        "id": "548",
                                        "title": "A Disneyland Alumni Club Watch and Pin",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 2
                                },
                                {
                                        "id": "549",
                                        "title": "A Disneyland Alumni Club 60th Anniversary Pin",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 1
                                },
                                {
                                        "id": "553",
                                        "title": "A Jungle Cruise 50th Anniversary Congo Queen Model",
                                        "year": "n.d.",
                                        "motif": "relic",
                                        "glyph": "🗿",
                                        "tags": [
                                                "model",
                                                "myth"
                                        ],
                                        "role": "seed",
                                        "weight": 4
                                },
                                {
                                        "id": "554",
                                        "title": "A Disneyland 50th SHAG Adventureland Print",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "🖼️",
                                        "tags": [
                                                "print",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 3
                                },
                                {
                                        "id": "555",
                                        "title": "An Early New Orleans Square Gift Bag",
                                        "year": "n.d.",
                                        "motif": "carry",
                                        "glyph": "👜",
                                        "tags": [
                                                "carry",
                                                "myth"
                                        ],
                                        "role": "bridge",
                                        "weight": 3
                                },
                                {
                                        "id": "558",
                                        "title": "A Club 33 Walt Disney Quote Etched Paperweight",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 4
                                },
                                {
                                        "id": "559",
                                        "title": "A Club 33 Court of Angels Walt Disney Pin",
                                        "year": "n.d.",
                                        "motif": "signal",
                                        "glyph": "📌",
                                        "tags": [
                                                "pin",
                                                "myth"
                                        ],
                                        "role": "spark",
                                        "weight": 5
                                },
                                {
                                        "id": "560",
                                        "title": "A Large Disney Park Swizzle Stick Collection",
                                        "year": "n.d.",
                                        "motif": "memory",
                                        "glyph": "🧩",
                                        "tags": [
                                                "relic",
                                                "myth"
                                        ],
                                        "role": "lens",
                                        "weight": 2
                                },
                                {
                                        "id": "561",
                                        "title": "A Disney Gallery Souvenir Gift Bag",
                                        "year": "n.d.",
                                        "motif": "carry",
                                        "glyph": "👜",
                                        "tags": [
                                                "carry",
                                                "myth"
                                        ],
                                        "role": "bridge",
                                        "weight": 2
                                }
                        ]
                },
                "hensonMarilyn": {
                        "label": "Henson + Marilyn Archive",
                        "description": "Studio relics and Marilyn traces, tuned for archetypal pulls.",
                        "items": [
                                {
                                        "id": "MM-1956",
                                        "title": "1956 Paula Strasberg Expense Report and Check",
                                        "year": "1956",
                                        "work": "Marilyn Monroe personal accounts",
                                        "property": "expense report + check",
                                        "character": "Marilyn Monroe (ideal monster)",
                                        "motif": "ideal monster",
                                        "glyph": "🧾",
                                        "tags": [
                                                "glamour",
                                                "ledger",
                                                "hunger"
                                        ],
                                        "role": "measure",
                                        "weight": 2,
                                        "adjacency": {
                                                "previous": {
                                                        "age": "none",
                                                        "density": "none"
                                                },
                                                "next": {
                                                        "age": "older",
                                                        "density": "lighter"
                                                }
                                        }
                                },
                                {
                                        "id": "MM-1959",
                                        "title": "1959 “Let’s Make Love” File Copy Script",
                                        "year": "1959",
                                        "work": "Let's Make Love",
                                        "property": "file copy script",
                                        "character": "Marilyn Monroe (ideal monster)",
                                        "motif": "ideal monster",
                                        "glyph": "📜",
                                        "tags": [
                                                "mask",
                                                "rehearsal",
                                                "myth"
                                        ],
                                        "role": "gate",
                                        "weight": 4,
                                        "adjacency": {
                                                "previous": {
                                                        "age": "younger",
                                                        "density": "denser"
                                                },
                                                "next": {
                                                        "age": "older",
                                                        "density": "denser"
                                                }
                                        }
                                },
                                {
                                        "id": "MM-1960",
                                        "title": "1960 Postcard from Norman Rosten",
                                        "year": "1960",
                                        "work": "Norman Rosten correspondence",
                                        "property": "postcard",
                                        "character": "Marilyn Monroe (ideal monster)",
                                        "motif": "ideal monster",
                                        "glyph": "✉️",
                                        "tags": [
                                                "intimacy",
                                                "distance",
                                                "echo"
                                        ],
                                        "role": "bridge",
                                        "weight": 1,
                                        "adjacency": {
                                                "previous": {
                                                        "age": "younger",
                                                        "density": "lighter"
                                                },
                                                "next": {
                                                        "age": "older",
                                                        "density": "lighter"
                                                }
                                        }
                                },
                                {
                                        "id": "MM-1961",
                                        "title": "1961 Beverly Hills Hotel Phone Messages",
                                        "year": "1961",
                                        "work": "Beverly Hills Hotel messages",
                                        "property": "phone message slips",
                                        "character": "Marilyn Monroe (ideal monster)",
                                        "motif": "ideal monster",
                                        "glyph": "☎️",
                                        "tags": [
                                                "signal",
                                                "desire",
                                                "static"
                                        ],
                                        "role": "spark",
                                        "weight": 2,
                                        "adjacency": {
                                                "previous": {
                                                        "age": "younger",
                                                        "density": "denser"
                                                },
                                                "next": {
                                                        "age": "older",
                                                        "density": "lighter"
                                                }
                                        }
                                },
                                {
                                        "id": "MM-1962",
                                        "title": "1962 Book Titled “Eros”",
                                        "year": "1962",
                                        "work": "Eros",
                                        "property": "art book",
                                        "character": "Marilyn Monroe (ideal monster)",
                                        "motif": "ideal monster",
                                        "glyph": "📕",
                                        "tags": [
                                                "icon",
                                                "ritual",
                                                "glow"
                                        ],
                                        "role": "lens",
                                        "weight": 3,
                                        "adjacency": {
                                                "previous": {
                                                        "age": "younger",
                                                        "density": "denser"
                                                },
                                                "next": {
                                                        "age": "older",
                                                        "density": "lighter"
                                                }
                                        }
                                },
                                {
                                        "id": "MM-1964",
                                        "title": "1964 Arthur Miller “After the Fall” Limited Edition Book",
                                        "year": "1964",
                                        "work": "After the Fall",
                                        "property": "signed limited edition book",
                                        "character": "Marilyn Monroe (ideal monster)",
                                        "motif": "ideal monster",
                                        "glyph": "📘",
                                        "tags": [
                                                "echo",
                                                "reckoning",
                                                "legend"
                                        ],
                                        "role": "guide",
                                        "weight": 4,
                                        "adjacency": {
                                                "previous": {
                                                        "age": "younger",
                                                        "density": "denser"
                                                },
                                                "next": {
                                                        "age": "older",
                                                        "density": "lighter"
                                                }
                                        }
                                },
                                {
                                        "id": "HEN-1984",
                                        "title": "Henson Frog Statue (Office Original)",
                                        "year": "1984",
                                        "work": "Henson Company Offices",
                                        "property": "studio totem statue",
                                        "character": "Kermit / Studio Spirit (caretaker)",
                                        "motif": "caretaker",
                                        "glyph": "🐸",
                                        "tags": [
                                                "guardian",
                                                "workshop",
                                                "totem"
                                        ],
                                        "role": "guide",
                                        "weight": 5,
                                        "adjacency": {
                                                "previous": {
                                                        "age": "younger",
                                                        "density": "denser"
                                                },
                                                "next": {
                                                        "age": "older",
                                                        "density": "denser"
                                                }
                                        }
                                },
                                {
                                        "id": "HEN-1990",
                                        "title": "Rauschenberg “Tribute 21” Print — Henson Company Copy",
                                        "year": "1990",
                                        "work": "Tribute 21",
                                        "property": "archival fine art print",
                                        "character": "The Patron (benefactor)",
                                        "motif": "inheritance",
                                        "glyph": "🖼️",
                                        "tags": [
                                                "patronage",
                                                "legacy",
                                                "ink"
                                        ],
                                        "role": "lens",
                                        "weight": 4,
                                        "adjacency": {
                                                "previous": {
                                                        "age": "younger",
                                                        "density": "lighter"
                                                },
                                                "next": {
                                                        "age": "older",
                                                        "density": "lighter"
                                                }
                                        }
                                },
                                {
                                        "id": "HEN-1991",
                                        "title": "The Secret Life of Toys — Doctor Wizardo Puppet",
                                        "year": "1991",
                                        "work": "The Secret Life of Toys",
                                        "property": "screen-used puppet",
                                        "character": "Doctor Wizardo (trickster medic)",
                                        "motif": "alchemy",
                                        "glyph": "🎭",
                                        "tags": [
                                                "mischief",
                                                "remedy",
                                                "stagecraft"
                                        ],
                                        "role": "trickster",
                                        "weight": 5,
                                        "adjacency": {
                                                "previous": {
                                                        "age": "younger",
                                                        "density": "denser"
                                                },
                                                "next": {
                                                        "age": "older",
                                                        "density": "denser"
                                                }
                                        }
                                },
                                {
                                        "id": "HEN-1992",
                                        "title": "Aristotle Bust (Muppet Christmas Carol)",
                                        "year": "1992",
                                        "work": "The Muppet Christmas Carol",
                                        "property": "prop bust",
                                        "character": "Aristotle (cold witness)",
                                        "motif": "judgment",
                                        "glyph": "🗿",
                                        "tags": [
                                                "wisdom",
                                                "stone",
                                                "witness"
                                        ],
                                        "role": "measure",
                                        "weight": 3,
                                        "adjacency": {
                                                "previous": {
                                                        "age": "younger",
                                                        "density": "lighter"
                                                },
                                                "next": {
                                                        "age": "older",
                                                        "density": "denser"
                                                }
                                        }
                                },
                                {
                                        "id": "HEN-1997",
                                        "title": "George Lucas 30th Anniversary Artwork (Henson Company)",
                                        "year": "1997",
                                        "work": "Henson Company / Lucas Anniversary",
                                        "property": "commemorative artwork",
                                        "character": "The Ally (galactic patron)",
                                        "motif": "constellation",
                                        "glyph": "✨",
                                        "tags": [
                                                "alliance",
                                                "celebration",
                                                "orbit"
                                        ],
                                        "role": "seed",
                                        "weight": 2,
                                        "adjacency": {
                                                "previous": {
                                                        "age": "younger",
                                                        "density": "lighter"
                                                },
                                                "next": {
                                                        "age": "older",
                                                        "density": "lighter"
                                                }
                                        }
                                },
                                {
                                        "id": "HEN-2001",
                                        "title": "The Hoobs — Roma Full-Body Puppet",
                                        "year": "2001",
                                        "work": "The Hoobs",
                                        "property": "full-body puppet",
                                        "character": "Roma (curious builder)",
                                        "motif": "inquiry",
                                        "glyph": "🧸",
                                        "tags": [
                                                "curiosity",
                                                "craft",
                                                "journey"
                                        ],
                                        "role": "bridge",
                                        "weight": 4,
                                        "adjacency": {
                                                "previous": {
                                                        "age": "younger",
                                                        "density": "denser"
                                                },
                                                "next": {
                                                        "age": "none",
                                                        "density": "none"
                                                }
                                        }
                                }
                        ]
                }
        }
}
    </script>
    <script type="application/json" id="cel-data">
        [
            {
                "id": "cel-dima",
                "title": "Dima → Dime",
                "glyph": "🧵",
                "stages": [
                    { "label": "Cel 01", "summary": "The actress enters the lab.", "detail": "Dima is hired as a face. Dime is what the room remembers. The switch is small but permanent.", "whisper": "Return to let the name harden into myth." },
                    { "label": "Cel 02", "summary": "The avatar learns to loop.", "detail": "TikTok velocity turns gesture into algorithm. The name becomes a price point, the price point becomes a character.", "whisper": "Your attention is a casting note." },
                    { "label": "Cel 03", "summary": "The domestic product ships itself.", "detail": "Dime is now a SKU. Identity inventory gets scanned, the scan becomes a ritual, the ritual becomes a show.", "whisper": "Entrop: when a person is multiplied, meaning gets noisy." }
                ]
            },
            {
                "id": "cel-archive",
                "title": "Archive / Myth",
                "glyph": "🗝️",
                "stages": [
                    { "label": "Cel 01", "summary": "Artifacts are proof-of-life.", "detail": "Real objects are folded into fiction, asking if evidence is still sacred once it is staged.", "whisper": "Return to unseal the second label." },
                    { "label": "Cel 02", "summary": "The evidence becomes an argument.", "detail": "Provenance is a spell. The archive does not certify the myth—it manufactures it.", "whisper": "Your memory is a co-signer." },
                    { "label": "Cel 03", "summary": "The archive begins to overwrite.", "detail": "Every object starts describing the viewer. The inventory makes a mirror and refuses to apologize.", "whisper": "Entropy: the mirror cracks into more mirrors." }
                ]
            },
            {
                "id": "cel-grift",
                "title": "Grift Shop",
                "glyph": "🧾",
                "stages": [
                    { "label": "Cel 01", "summary": "Notice the dark pattern.", "detail": "Every box is a lesson in extraction. The game is not to buy—it is to identify where value slipped away.", "whisper": "Return when your skepticism is measurable." },
                    { "label": "Cel 02", "summary": "Value tokens appear.", "detail": "Tokens are not rewards. They are a record of where you refused to be optimized.", "whisper": "The gate counts your refusals." },
                    { "label": "Cel 03", "summary": "The gate softens.", "detail": "Ticketing reluctantly respects the visitor who can see the seams. The satire bends, not breaks.", "whisper": "Entropy: the joke starts sounding like truth." }
                ]
            },
            {
                "id": "cel-quiz",
                "title": "Identity Quiz",
                "glyph": "🧠",
                "stages": [
                    { "label": "Cel 01", "summary": "Self-classify.", "detail": "Pick a role. The system pretends to trust you.", "whisper": "Return for the verification ritual." },
                    { "label": "Cel 02", "summary": "The Loom responds.", "detail": "Five questions, five nervous mirrors. The score tilts the title.", "whisper": "Return to watch the title mutate." },
                    { "label": "Cel 03", "summary": "Identity becomes output.", "detail": "A voxel relic is minted from your answers. You are now a tiny grid inside the archive.", "whisper": "Entropy: the tool starts using you." }
                ]
            },
            {
                "id": "cel-lantern",
                "title": "Lantern Protocol",
                "glyph": "🕯️",
                "stages": [
                    { "label": "Cel 01", "summary": "Witness, not guard.", "detail": "Lanterns are human interfaces. They hold the room in their posture.", "whisper": "Return for the scripted responses." },
                    { "label": "Cel 02", "summary": "Micro-expression indexing.", "detail": "The show happens inches away. The performer is trained by the artifacts.", "whisper": "Return to hear the whisper behind glass." },
                    { "label": "Cel 03", "summary": "The light learns you.", "detail": "The lantern becomes a translator of longing. Guests become co-authors.", "whisper": "Entropy: the witness becomes the story." }
                ]
            },
            {
                "id": "cel-celli",
                "title": "Celli Engine",
                "glyph": "🧩",
                "stages": [
                    { "label": "Cel 01", "summary": "A spreadsheet with bones.", "detail": "The voxel grid is a tiny museum of constraints: 16x16, cheap, fast, alive.", "whisper": "Return for the manufacturing loop." },
                    { "label": "Cel 02", "summary": "Tools become theatre.", "detail": "Every pixel submission is a staged economy. Revenue share is a punchline, not a promise.", "whisper": "Return when the loop feels familiar." },
                    { "label": "Cel 03", "summary": "Meaning decays into pattern.", "detail": "The tool starts telling its own story. What was function becomes folklore.", "whisper": "Entropy: the interface remembers more than you." }
                ]
            }
        ]
    </script>

    <script>
        /* --- MODULES DEFINED FIRST FOR SAFETY --- */

        const QUIZ = [
            {
                q: "You find a broken toy on the sidewalk. What is your first instinct?",
                opts: [
                    { txt: "Fix it. It has potential.", type: "dreamer", score: 2 },
                    { txt: "Study it. Where did it come from?", type: "scholar", score: 2 },
                    { txt: "Leave it. It is trash.", type: "passerby", score: 2 },
                    { txt: "Evaluate it. Could it be sold?", type: "investor", score: 2 },
                    { txt: "Feel for it. It looks lonely.", type: "lantern", score: 2 }
                ]
            },
            {
                q: "The room is dark. You have one match. What do you illuminate?",
                opts: [
                    { txt: "The door. I need to leave.", type: "passerby", score: 2 },
                    { txt: "The map. I need to know where I am.", type: "scholar", score: 2 },
                    { txt: "My face. I need to be seen.", type: "lantern", score: 2 },
                    { txt: "The inventory. What is in here?", type: "investor", score: 2 },
                    { txt: "The ceiling. I want to see the height.", type: "dreamer", score: 2 }
                ]
            },
            {
                q: "Loomworks asks for your childhood memory. What do you do?",
                opts: [
                    { txt: "Sell it for maximum credit.", type: "investor", score: 3 },
                    { txt: "Archive it for history.", type: "scholar", score: 3 },
                    { txt: "Re-write it to be better.", type: "dreamer", score: 3 },
                    { txt: "Guard it with my life.", type: "lantern", score: 3 },
                    { txt: "I don't remember anything.", type: "passerby", score: 3 }
                ]
            },
            {
                q: "A guest insists the archive is fake. You...",
                opts: [
                    { txt: "Walk away; disbelief is a choice.", type: "passerby", score: 3 },
                    { txt: "Hand them the provenance binder.", type: "scholar", score: 3 },
                    { txt: "Ask what they'd pay if it weren't.", type: "investor", score: 3 },
                    { txt: "Tell them the ghost stories instead.", type: "dreamer", score: 3 },
                    { txt: "Hold their gaze until they soften.", type: "lantern", score: 3 }
                ]
            },
            {
                q: "The lights flicker during the show. What do you protect first?",
                opts: [
                    { txt: "The visitors' pathfinding.", type: "lantern", score: 3 },
                    { txt: "The rarest object on the wall.", type: "scholar", score: 3 },
                    { txt: "The credit stream.", type: "investor", score: 3 },
                    { txt: "The story. Darkness is part of it.", type: "dreamer", score: 3 },
                    { txt: "Myself. I shouldn't be here.", type: "passerby", score: 3 }
                ]
            }
        ];

        const ROLES = {
            dreamer: { adj: "DREAMING", motto: "Dream forward." },
            scholar: { adj: "SCHOLARLY", motto: "Nothing is unimportant." },
            investor: { adj: "SPECULATIVE", motto: "What is magic worth?" },
            passerby: { adj: "WANDERING", motto: "No one is 'just looking'." },
            lantern: { adj: "ILLUMINATED", motto: "Keep the light." }
        };

        // 1. Audio Engine
        const audio = {
            synth: null,
            init: async () => {
                if (window.Tone) {
                    await Tone.start();
                    audio.synth = new Tone.MembraneSynth().toDestination();
                }
            },
            click: () => {
                if (window.Tone && audio.synth) {
                    audio.synth.triggerAttackRelease("C2", "32n");
                } else if (window.Tone) {
                    audio.init().then(() => audio.click());
                }
            }
        };

        // 2. Manufacture (Canvas)
        const manufacture = {
            color: '#111',
            canvas: null,
            init: () => {
                const c = document.getElementById('manufacture-canvas');
                if(!c) return;
                manufacture.canvas = c;
                const ctx = c.getContext('2d');
                
                // Init White Background
                ctx.fillStyle = '#f5f5dc';
                ctx.fillRect(0,0,256,256);
                
                let painting = false;
                const draw = (e) => {
                    if(!painting) return;
                    const rect = c.getBoundingClientRect();
                    // 16x16 Grid Logic
                    const scaleX = c.width / rect.width;
                    const scaleY = c.height / rect.height;
                    const cellW = 256/16;
                    const cellH = 256/16;
                    
                    const x = Math.floor((e.clientX - rect.left) * scaleX / cellW) * cellW;
                    const y = Math.floor((e.clientY - rect.top) * scaleY / cellH) * cellH;
                    
                    ctx.fillStyle = manufacture.color;
                    ctx.fillRect(x,y,cellW,cellH);
                };
                
                c.addEventListener('mousedown', (e) => { painting = true; draw(e); });
                c.addEventListener('mousemove', draw);
                window.addEventListener('mouseup', () => painting = false);
            },
            setColor: (c) => manufacture.color = c,
            submit: () => {
                if(window.audio) audio.click();
                const image = manufacture.canvas ? manufacture.canvas.toDataURL('image/png') : null;
                const asset = {
                    title: `Manufacture-16x16-${Date.now().toString().slice(-5)}`,
                    origin: 'Manufacture Tool',
                    modeLabel: 'Pixel Draft',
                    dataUrl: image
                };
                griftLedger.addSale(asset);
                alert("Artifact Submitted to Loomworks. Revenue share: 0.000666%");
            }
        };

        // 3. Archive
        const archiveCatalog = JSON.parse(document.getElementById('archive-json').textContent);
        const archiveModes = archiveCatalog.modes || {
            default: {
                label: 'Archive',
                description: 'Default archive dataset.',
                items: Array.isArray(archiveCatalog) ? archiveCatalog : []
            }
        };
        const defaultModeKey = archiveModes.default ? 'default' : Object.keys(archiveModes)[0];
        let archiveData = archiveModes[defaultModeKey]?.items || [];
        const archiveState = {
            mode: defaultModeKey,
            selectedIds: [],
            influenceIds: [],
            drawnIds: [],
            lastStory: '',
            lastMeta: ''
        };

        const archiveEngine = {
            vocab: {
                verbs: ["finds", "tucks", "mends", "carries", "shares", "whispers", "locks", "opens"],
                tones: ["gentle", "bright", "soft", "oddly brave", "glimmering", "quietly bold"],
                noise: ["a tiny hum", "a velvet static", "a light hiss", "a friendly fizz"],
                roles: {
                    lens: "the seeing thing",
                    gate: "the opening",
                    spark: "the jolt",
                    trickster: "the flip",
                    guide: "the hand",
                    ticket: "the pass",
                    bridge: "the link",
                    seed: "the sprout",
                    measure: "the count"
                }
            },
            compress: (cards, influences) => {
                const pick = (arr) => arr[Math.floor(Math.random() * arr.length)];
                const roles = cards.map(card => archiveEngine.vocab.roles[card.role] || "the part");
                const verbs = cards.map(() => pick(archiveEngine.vocab.verbs));
                const tone = pick(archiveEngine.vocab.tones);
                const noise = pick(archiveEngine.vocab.noise);
                const influenceText = influences.length
                    ? ` Extra images (${influences.map(i => i.glyph).join(' ')}) re-tune the story toward ${influences.map(i => i.motif).join(', ')}.`
                    : "";
                return {
                    story: `Once a ${tone} child ${verbs[0]} ${roles[0]}, ${verbs[1]} ${roles[1]}, and ${verbs[2]} ${roles[2]}. The ${cards.map(c => c.glyph).join(' ')} promise the tale can fold small and still mean big. ${noise} proves the compression engine is laughing and working.${influenceText}`,
                    meta: {
                        narrative: `${cards.map(c => c.motif).join(" → ")} with ${tone} cadence`,
                        semioticContainment: `${cards.map(c => c.tags[0]).join(" / ")} sealed by ${cards.map(c => c.role).join(", ")}`
                    }
                };
            }
        };

        const archiveUI = {
            renderQuick: () => {
                const el = document.getElementById('archive-quick');
                if(!el) return;
                el.innerHTML = archiveData.map((i, index) => `
                    <div class="border-b border-gray-100 py-1 hover:text-loom-red cursor-help" style="--forge-delay: ${index * 8}ms;">
                        ${i.id} // ${i.title}
                    </div>
                `).join('');
            },
            renderGroups: () => {
                const groupEl = document.getElementById('archive-groups');
                if(!groupEl) return;
                groupEl.innerHTML = archiveData.map((i, index) => {
                    const selected = archiveState.selectedIds.includes(i.id);
                    const influenced = archiveState.influenceIds.includes(i.id);
                    return `
                        <div class="bg-white border border-black/10 p-4 shadow-sm flex flex-col sm:flex-row justify-between gap-3" data-archive-id="${i.id}" style="--forge-delay: ${index * 6}ms;">
                            <div>
                                <div class="text-[10px] font-mono text-gray-500">${i.year} • ${i.motif}</div>
                                <div class="font-bold flex items-center gap-2">${i.glyph} ${i.title}</div>
                                <div class="text-[10px] font-mono uppercase tracking-widest text-gray-400">${i.tags.join(" / ")}</div>
                            </div>
                            <div class="flex items-center gap-2 text-[10px] font-mono uppercase tracking-widest">
                                <button class="ui-click border border-black px-2 py-1 ${selected ? 'bg-black text-white' : ''}" data-action="select">Select</button>
                                <button class="ui-click border border-black/40 px-2 py-1 ${influenced ? 'bg-loom-red text-white border-loom-red' : ''}" data-action="influence">Influence</button>
                            </div>
                        </div>
                    `;
                }).join('');
            },
            renderTarot: () => {
                const slots = document.getElementById('tarot-slots');
                if(!slots) return;
                const cards = archiveState.drawnIds.map(id => archiveData.find(item => item.id === id)).filter(Boolean);
                slots.innerHTML = cards.length ? cards.map(card => `
                    <div class="border border-black bg-white p-4 text-center" style="--forge-delay: 0ms;">
                        <div class="text-2xl">${card.glyph}</div>
                        <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500 mt-2">${card.year}</div>
                        <div class="font-bold text-sm">${card.title}</div>
                        <div class="text-[10px] font-mono uppercase tracking-widest text-loom-red mt-1">${card.motif}</div>
                    </div>
                `).join('') : `
                    <div class="border border-black/20 bg-gray-50 p-4 text-center font-mono text-xs uppercase tracking-widest">Card 1</div>
                    <div class="border border-black/20 bg-gray-50 p-4 text-center font-mono text-xs uppercase tracking-widest">Card 2</div>
                    <div class="border border-black/20 bg-gray-50 p-4 text-center font-mono text-xs uppercase tracking-widest">Card 3</div>
                `;
            },
            renderInfluenceTray: () => {
                const tray = document.getElementById('influence-tray');
                if(!tray) return;
                const influences = archiveState.influenceIds.map(id => archiveData.find(item => item.id === id)).filter(Boolean);
                tray.innerHTML = influences.length
                    ? influences.map((card, index) => `<span class="px-2 py-1 border border-black/20 bg-white" style="--forge-delay: ${index * 12}ms;">${card.glyph} ${card.title}</span>`).join('')
                    : '<span class="text-gray-400">No influence images added.</span>';
            },
            renderMode: () => {
                const note = document.getElementById('archive-mode-note');
                const modeData = archiveModes[archiveState.mode];
                if(note && modeData) {
                    note.textContent = `• ${modeData.label}: ${modeData.description}`;
                }
                document.querySelectorAll('[data-archive-mode]').forEach(button => {
                    const isActive = button.dataset.archiveMode === archiveState.mode;
                    button.classList.toggle('active', isActive);
                });
                const count = document.getElementById('archive-count');
                if(count) count.innerText = archiveData.length;
            },
            renderStory: () => {
                const output = document.getElementById('story-output');
                const meta = document.getElementById('story-meta');
                if(!output || !meta) return;
                output.textContent = archiveState.lastStory || 'Draw cards to begin the compression trick.';
                meta.textContent = archiveState.lastMeta || '';
            },
            renderKb: () => {
                const archiveKb = document.getElementById('archive-kb');
                const storyKb = document.getElementById('story-kb');
                if(!archiveKb || !storyKb) return;
                const archiveBytes = new TextEncoder().encode(JSON.stringify(archiveData)).length;
                const storyBytes = new TextEncoder().encode(archiveState.lastStory || '').length;
                archiveKb.textContent = `${(archiveBytes / 1024).toFixed(2)} KB`;
                storyKb.textContent = `${(storyBytes / 1024).toFixed(2)} KB`;
            },
            renderAll: () => {
                archiveUI.renderQuick();
                archiveUI.renderGroups();
                archiveUI.renderTarot();
                archiveUI.renderInfluenceTray();
                archiveUI.renderMode();
                archiveUI.renderStory();
                archiveUI.renderKb();
            }
        };

        const archive = {
            init: async () => {
                const el = document.getElementById('archive-quick');
                const groupEl = document.getElementById('archive-groups');
                if(!el || !groupEl) return;
                archiveUI.renderAll();
                archive.bindEvents();
            },
            bindEvents: () => {
                const groupEl = document.getElementById('archive-groups');
                const drawBtn = document.getElementById('draw-three');
                const meanBtn = document.getElementById('mean-it');
                const influenceBtn = document.getElementById('add-influence');
                const clearBtn = document.getElementById('clear-selection');
                const modeButtons = document.querySelectorAll('[data-archive-mode]');
                if(groupEl) {
                    groupEl.onclick = (event) => {
                        const button = event.target.closest('button[data-action]');
                        const cardEl = event.target.closest('[data-archive-id]');
                        if(!button || !cardEl) return;
                        const id = cardEl.getAttribute('data-archive-id');
                        if(button.dataset.action === 'select') {
                            archive.toggleSelection(id);
                        } else {
                            archive.toggleInfluence(id);
                        }
                    };
                }
                if(drawBtn) drawBtn.onclick = () => archive.drawRandom();
                if(meanBtn) meanBtn.onclick = () => archive.meanIt();
                if(influenceBtn) influenceBtn.onclick = () => archive.addInfluenceRandom();
                if(clearBtn) clearBtn.onclick = () => archive.clearSelections();
                modeButtons.forEach(button => {
                    button.onclick = () => archive.setMode(button.dataset.archiveMode);
                });
            },
            setMode: (modeId) => {
                const modeData = archiveModes[modeId];
                if(!modeData) return;
                archiveState.mode = modeId;
                archiveData = modeData.items;
                archiveState.selectedIds = [];
                archiveState.influenceIds = [];
                archiveState.drawnIds = [];
                archiveState.lastStory = '';
                archiveState.lastMeta = '';
                const view = document.getElementById('view-archive');
                if(view) {
                    view.classList.remove('archive-constructing');
                    void view.offsetWidth;
                    view.classList.add('archive-constructing');
                    setTimeout(() => view.classList.remove('archive-constructing'), 900);
                }
                archiveUI.renderAll();
            },
            drawRandom: () => {
                const pool = [...archiveData];
                archiveState.drawnIds = [];
                while(archiveState.drawnIds.length < 3 && pool.length) {
                    const index = Math.floor(Math.random() * pool.length);
                    archiveState.drawnIds.push(pool.splice(index, 1)[0].id);
                }
                archive.generateStory();
            },
            meanIt: () => {
                if(archiveState.selectedIds.length !== 3) {
                    alert('Select exactly three artifacts, then press Mean It.');
                    return;
                }
                archiveState.drawnIds = [...archiveState.selectedIds];
                archive.generateStory();
            },
            toggleSelection: (id) => {
                const idx = archiveState.selectedIds.indexOf(id);
                if(idx >= 0) {
                    archiveState.selectedIds.splice(idx, 1);
                } else if(archiveState.selectedIds.length < 3) {
                    archiveState.selectedIds.push(id);
                } else {
                    alert('Selection limit: three artifacts.');
                }
                archiveUI.renderGroups();
            },
            toggleInfluence: (id) => {
                const idx = archiveState.influenceIds.indexOf(id);
                if(idx >= 0) {
                    archiveState.influenceIds.splice(idx, 1);
                } else {
                    archiveState.influenceIds.push(id);
                }
                archiveUI.renderGroups();
                archiveUI.renderInfluenceTray();
            },
            addInfluenceRandom: () => {
                const options = archiveData.filter(item => !archiveState.influenceIds.includes(item.id));
                if(!options.length) return;
                const choice = options[Math.floor(Math.random() * options.length)];
                archiveState.influenceIds.push(choice.id);
                archive.generateStory();
            },
            clearSelections: () => {
                archiveState.selectedIds = [];
                archiveState.influenceIds = [];
                archiveUI.renderAll();
            },
            generateStory: () => {
                const cards = archiveState.drawnIds.map(id => archiveData.find(item => item.id === id)).filter(Boolean);
                const influences = archiveState.influenceIds.map(id => archiveData.find(item => item.id === id)).filter(Boolean);
                if(cards.length !== 3) {
                    archiveUI.renderTarot();
                    archiveUI.renderInfluenceTray();
                    archiveUI.renderStory();
                    archiveUI.renderKb();
                    return;
                }
                const result = archiveEngine.compress(cards, influences);
                archiveState.lastStory = result.story;
                archiveState.lastMeta = `Narrative: ${result.meta.narrative} • Semiotic Containment: ${result.meta.semioticContainment}`;
                archiveUI.renderTarot();
                archiveUI.renderInfluenceTray();
                archiveUI.renderStory();
                archiveUI.renderKb();
            }
        };

        // 4. Sculpture Identity Generator (2D current, 3D legacy)
        const sculptureEngine = {
            renderer: null,
            scene: null,
            camera: null,
            container: null,
            ctx: null,
            rand: null,
            mode: '2d',
            lastProfile: null,

            hash(text) {
                let h = 0;
                for (let i = 0; i < text.length; i++) {
                    h = Math.imul(31, h) + text.charCodeAt(i) | 0;
                }
                return Math.abs(h);
            },

            setSeed(seedText) {
                let seed = sculptureEngine.hash(seedText) || 1;
                sculptureEngine.rand = () => {
                    seed += 1;
                    const x = Math.sin(seed) * 10000;
                    return x - Math.floor(x);
                };
            },

            randRange(min, max) {
                if (!sculptureEngine.rand) return min;
                return min + (max - min) * sculptureEngine.rand();
            },

            prepare2DCanvas() {
                sculptureEngine.container = document.getElementById('sculpture-canvas');
                if (!sculptureEngine.container) return null;
                const bounds = sculptureEngine.container.getBoundingClientRect();
                const width = bounds.width || 420;
                const height = bounds.height || 260;
                const dpr = window.devicePixelRatio || 1;
                sculptureEngine.container.width = width * dpr;
                sculptureEngine.container.height = height * dpr;
                sculptureEngine.ctx = sculptureEngine.container.getContext('2d');
                sculptureEngine.ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
                return sculptureEngine.ctx;
            },

            init3D() {
                sculptureEngine.container = document.getElementById('sculpture-canvas');
                if (!sculptureEngine.container || !window.THREE) return;
                if (!sculptureEngine.renderer) {
                    sculptureEngine.renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true, canvas: sculptureEngine.container });
                }
                const bounds = sculptureEngine.container.getBoundingClientRect();
                sculptureEngine.renderer.setSize(bounds.width || 420, bounds.height || 260);

                sculptureEngine.camera = new THREE.PerspectiveCamera(40, (bounds.width || 420) / (bounds.height || 260), 0.1, 50);
                sculptureEngine.camera.position.set(3.2, 2.6, 4.8);
                sculptureEngine.camera.lookAt(0, 1, 0);

                sculptureEngine.scene = new THREE.Scene();
                sculptureEngine.scene.background = new THREE.Color('#f6f0e6');
            },

            resetScene() {
                if (!sculptureEngine.scene) return;
                while (sculptureEngine.scene.children.length) {
                    sculptureEngine.scene.remove(sculptureEngine.scene.children[0]);
                }

                sculptureEngine.scene.add(new THREE.AmbientLight('#f6f0e6', 0.55));
                const key = new THREE.DirectionalLight('#ffffff', 0.9);
                key.position.set(3, 6, 5);
                sculptureEngine.scene.add(key);
                const rim = new THREE.DirectionalLight('#d7342a', 0.35);
                rim.position.set(-4, 3, -2);
                sculptureEngine.scene.add(rim);

                const floor = new THREE.Mesh(new THREE.PlaneGeometry(10, 10), new THREE.MeshStandardMaterial({ color: '#ede7dc', metalness: 0.1, roughness: 0.8 }));
                floor.rotation.x = -Math.PI / 2;
                floor.position.y = -0.5;
                sculptureEngine.scene.add(floor);
            },

            buildPrimitives(profile) {
                const group = new THREE.Group();
                const mode = sculptureEngine.randRange(0, 1) > 0.55 ? 'cage' : 'brutalist';
                if (mode === 'cage') {
                    sculptureEngine.buildCageVariant(group, profile);
                } else {
                    sculptureEngine.buildBrutalistVariant(group, profile);
                }
                sculptureEngine.scene.add(group);
            },

            buildBrutalistVariant(group, profile) {
                const slabMaterial = new THREE.MeshStandardMaterial({
                    color: profile.palette[0],
                    metalness: 0.2,
                    roughness: 0.55
                });
                const shadowMaterial = new THREE.MeshStandardMaterial({
                    color: '#151515',
                    metalness: 0.6,
                    roughness: 0.25
                });
                const accentMaterial = new THREE.MeshStandardMaterial({
                    color: profile.palette[2] || '#d7342a',
                    metalness: 0.4,
                    roughness: 0.35
                });

                const base = new THREE.Mesh(new THREE.BoxGeometry(3.9, 0.2, 3.6), shadowMaterial);
                base.position.y = -0.15;
                group.add(base);

                const towerCount = 5 + Math.floor(sculptureEngine.randRange(0, 4));
                for (let i = 0; i < towerCount; i++) {
                    const width = sculptureEngine.randRange(0.5, 1.1);
                    const depth = sculptureEngine.randRange(0.5, 1.1);
                    const height = sculptureEngine.randRange(1.0, 2.6);
                    const tower = new THREE.Mesh(
                        new THREE.BoxGeometry(width, height, depth),
                        slabMaterial.clone()
                    );
                    tower.position.set(
                        sculptureEngine.randRange(-1.2, 1.2),
                        height / 2,
                        sculptureEngine.randRange(-1.1, 1.1)
                    );
                    tower.rotation.y = sculptureEngine.randRange(-0.4, 0.4);
                    group.add(tower);

                    const edges = new THREE.LineSegments(
                        new THREE.EdgesGeometry(tower.geometry),
                        new THREE.LineBasicMaterial({ color: '#111111', linewidth: 1 })
                    );
                    edges.position.copy(tower.position);
                    edges.rotation.copy(tower.rotation);
                    group.add(edges);
                }

                const cantileverCount = 3 + Math.floor(sculptureEngine.randRange(0, 3));
                for (let i = 0; i < cantileverCount; i++) {
                    const slab = new THREE.Mesh(
                        new THREE.BoxGeometry(sculptureEngine.randRange(1.4, 2.6), 0.18, sculptureEngine.randRange(0.6, 1.4)),
                        accentMaterial.clone()
                    );
                    slab.position.set(
                        sculptureEngine.randRange(-0.8, 0.8),
                        sculptureEngine.randRange(1.0, 2.6),
                        sculptureEngine.randRange(-0.9, 0.9)
                    );
                    slab.rotation.y = sculptureEngine.randRange(-0.6, 0.6);
                    group.add(slab);
                }

                const braceCount = 4 + Math.floor(sculptureEngine.randRange(0, 3));
                for (let i = 0; i < braceCount; i++) {
                    const brace = new THREE.Mesh(
                        new THREE.CylinderGeometry(0.05, 0.05, sculptureEngine.randRange(1.2, 2.6), 10),
                        shadowMaterial.clone()
                    );
                    brace.position.set(
                        sculptureEngine.randRange(-1.4, 1.4),
                        sculptureEngine.randRange(0.6, 2.4),
                        sculptureEngine.randRange(-1.3, 1.3)
                    );
                    brace.rotation.z = sculptureEngine.randRange(-0.8, 0.8);
                    brace.rotation.x = sculptureEngine.randRange(-0.4, 0.4);
                    group.add(brace);
                }

                const voidCount = 3;
                for (let i = 0; i < voidCount; i++) {
                    const voidBox = new THREE.Mesh(
                        new THREE.BoxGeometry(sculptureEngine.randRange(0.5, 1.1), sculptureEngine.randRange(0.4, 0.9), sculptureEngine.randRange(0.5, 1.1)),
                        new THREE.MeshStandardMaterial({ color: '#f6f0e6', transparent: true, opacity: 0.35, metalness: 0, roughness: 1 })
                    );
                    voidBox.position.set(
                        sculptureEngine.randRange(-1.1, 1.1),
                        sculptureEngine.randRange(0.7, 1.8),
                        sculptureEngine.randRange(-1.0, 1.0)
                    );
                    group.add(voidBox);
                }

                const gridLineMaterial = new THREE.LineBasicMaterial({ color: '#d7342a', linewidth: 1 });
                const grid = new THREE.LineSegments(
                    new THREE.EdgesGeometry(new THREE.BoxGeometry(3.4, 0.05, 3.1)),
                    gridLineMaterial
                );
                grid.position.y = 0.05;
                group.add(grid);
            },

            buildCageVariant(group, profile) {
                const barMaterial = new THREE.MeshStandardMaterial({
                    color: '#1a1a1a',
                    metalness: 0.75,
                    roughness: 0.3
                });
                const ringMaterial = new THREE.MeshStandardMaterial({
                    color: profile.palette[1] || '#d7342a',
                    metalness: 0.65,
                    roughness: 0.25
                });
                const glassMaterial = new THREE.MeshStandardMaterial({
                    color: profile.palette[0],
                    transparent: true,
                    opacity: 0.55,
                    metalness: 0.1,
                    roughness: 0.2
                });

                const basePlate = new THREE.Mesh(new THREE.CylinderGeometry(1.6, 1.8, 0.2, 24), barMaterial.clone());
                basePlate.position.y = -0.2;
                group.add(basePlate);

                const topCap = new THREE.Mesh(new THREE.CylinderGeometry(1.15, 1.3, 0.18, 20), ringMaterial.clone());
                topCap.position.y = 2.3;
                group.add(topCap);

                const bottomRing = new THREE.Mesh(new THREE.TorusGeometry(1.25, 0.06, 10, 32), ringMaterial.clone());
                bottomRing.rotation.x = Math.PI / 2;
                bottomRing.position.y = 0.2;
                group.add(bottomRing);

                const midRing = new THREE.Mesh(new THREE.TorusGeometry(1.05, 0.05, 10, 32), ringMaterial.clone());
                midRing.rotation.x = Math.PI / 2;
                midRing.position.y = 1.15;
                group.add(midRing);

                const topRing = new THREE.Mesh(new THREE.TorusGeometry(0.9, 0.05, 10, 32), ringMaterial.clone());
                topRing.rotation.x = Math.PI / 2;
                topRing.position.y = 2.05;
                group.add(topRing);

                const barCount = 14 + Math.floor(sculptureEngine.randRange(0, 6));
                for (let i = 0; i < barCount; i++) {
                    const angle = (i / barCount) * Math.PI * 2;
                    const bar = new THREE.Mesh(
                        new THREE.CylinderGeometry(0.04, 0.04, 2.1, 10),
                        barMaterial.clone()
                    );
                    bar.position.set(Math.cos(angle) * 1.12, 1.2, Math.sin(angle) * 1.12);
                    bar.rotation.z = sculptureEngine.randRange(-0.05, 0.05);
                    bar.rotation.x = sculptureEngine.randRange(-0.03, 0.03);
                    group.add(bar);
                }

                const crownCount = 6;
                for (let i = 0; i < crownCount; i++) {
                    const angle = (i / crownCount) * Math.PI * 2;
                    const fin = new THREE.Mesh(
                        new THREE.BoxGeometry(0.08, 0.4, 0.14),
                        ringMaterial.clone()
                    );
                    fin.position.set(Math.cos(angle) * 0.9, 2.35, Math.sin(angle) * 0.9);
                    fin.rotation.y = angle;
                    group.add(fin);
                }

                const core = new THREE.Mesh(
                    new THREE.CylinderGeometry(0.45, 0.5, 1.2, 18),
                    glassMaterial
                );
                core.position.y = 1.15;
                group.add(core);

                const innerSpine = new THREE.Mesh(
                    new THREE.CylinderGeometry(0.08, 0.08, 1.7, 12),
                    barMaterial.clone()
                );
                innerSpine.position.y = 1.2;
                group.add(innerSpine);

                const braceMaterial = new THREE.LineBasicMaterial({ color: '#d31313', linewidth: 1.2 });
                const braceGeometry = new THREE.BoxGeometry(1.4, 0.1, 1.4);
                const brace = new THREE.LineSegments(new THREE.EdgesGeometry(braceGeometry), braceMaterial);
                brace.position.y = 1.6;
                brace.rotation.y = Math.PI / 4;
                group.add(brace);
            },

            render2D(profile) {
                const ctx = sculptureEngine.prepare2DCanvas();
                if (!ctx) return;
                const bounds = sculptureEngine.container.getBoundingClientRect();
                const width = bounds.width || 420;
                const height = bounds.height || 260;
                sculptureEngine.setSeed(profile.seedText);

                const bgGradient = ctx.createLinearGradient(0, 0, width, height);
                bgGradient.addColorStop(0, profile.palette[0]);
                bgGradient.addColorStop(0.5, '#fef8ef');
                bgGradient.addColorStop(1, profile.palette[1]);
                ctx.fillStyle = bgGradient;
                ctx.fillRect(0, 0, width, height);

                ctx.strokeStyle = 'rgba(0,0,0,0.1)';
                ctx.lineWidth = 1;
                const grid = 26;
                for (let x = 0; x <= width; x += grid) {
                    ctx.beginPath();
                    ctx.moveTo(x, 0);
                    ctx.lineTo(x, height);
                    ctx.stroke();
                }
                for (let y = 0; y <= height; y += grid) {
                    ctx.beginPath();
                    ctx.moveTo(0, y);
                    ctx.lineTo(width, y);
                    ctx.stroke();
                }

                const layers = 6;
                for (let i = 0; i < layers; i++) {
                    const color = profile.palette[i % profile.palette.length];
                    ctx.fillStyle = color;
                    ctx.globalAlpha = 0.12 + i * 0.1;
                    const w = sculptureEngine.randRange(40, 160);
                    const h = sculptureEngine.randRange(30, 120);
                    const x = sculptureEngine.randRange(20, width - w - 20);
                    const y = sculptureEngine.randRange(20, height - h - 20);
                    ctx.save();
                    ctx.translate(x + w / 2, y + h / 2);
                    ctx.rotate(sculptureEngine.randRange(-0.4, 0.4));
                    ctx.fillRect(-w / 2, -h / 2, w, h);
                    ctx.restore();
                }

                ctx.globalAlpha = 1;
                ctx.strokeStyle = '#111';
                ctx.lineWidth = 2;
                ctx.beginPath();
                for (let i = 0; i < 6; i++) {
                    const x = sculptureEngine.randRange(40, width - 40);
                    const y = sculptureEngine.randRange(40, height - 40);
                    ctx.moveTo(x, y);
                    ctx.arc(x, y, sculptureEngine.randRange(8, 24), 0, Math.PI * 2);
                }
                ctx.stroke();

                ctx.fillStyle = '#d7342a';
                ctx.globalAlpha = 0.9;
                ctx.fillRect(width * 0.08, height * 0.72, width * 0.2, 6);
                ctx.globalAlpha = 1;
            },

            render(profile) {
                sculptureEngine.lastProfile = profile;
                sculptureEngine.mode = profile.mode || '2d';
                if (sculptureEngine.mode === '3d' && window.THREE) {
                    sculptureEngine.init3D();
                    if (!sculptureEngine.renderer) return sculptureEngine.render2D(profile);
                    sculptureEngine.setSeed(profile.seedText);
                    sculptureEngine.resetScene();
                    sculptureEngine.buildPrimitives(profile);
                    sculptureEngine.renderer.render(sculptureEngine.scene, sculptureEngine.camera);
                } else {
                    sculptureEngine.mode = '2d';
                    sculptureEngine.render2D(profile);
                }
            },

            resize() {
                if (sculptureEngine.mode === '3d') {
                    if (!sculptureEngine.renderer || !sculptureEngine.camera || !sculptureEngine.container) return;
                    const bounds = sculptureEngine.container.getBoundingClientRect();
                    sculptureEngine.camera.aspect = (bounds.width || 420) / (bounds.height || 260);
                    sculptureEngine.camera.updateProjectionMatrix();
                    sculptureEngine.renderer.setSize(bounds.width || 420, bounds.height || 260);
                    sculptureEngine.renderer.render(sculptureEngine.scene, sculptureEngine.camera);
                } else if (sculptureEngine.lastProfile) {
                    sculptureEngine.render2D(sculptureEngine.lastProfile);
                }
            },

            exportImage() {
                if (sculptureEngine.mode === '3d' && sculptureEngine.renderer) {
                    return sculptureEngine.renderer.domElement.toDataURL('image/png');
                }
                if (sculptureEngine.container) {
                    return sculptureEngine.container.toDataURL('image/png');
                }
                return null;
            }
        };
        window.sculptureEngine = sculptureEngine;

        const assetState = {
            storageKey: 'loom-assets',
            items: [],
            listeners: [],
            init() {
                const stored = window.localStorage.getItem(assetState.storageKey);
                assetState.items = stored ? JSON.parse(stored) : [];
            },
            save() {
                window.localStorage.setItem(assetState.storageKey, JSON.stringify(assetState.items));
            },
            add(item) {
                assetState.items.push(item);
                assetState.save();
                assetState.emit();
            },
            emit() {
                assetState.listeners.forEach((fn) => fn(assetState.items));
            },
            subscribe(fn) {
                assetState.listeners.push(fn);
                fn(assetState.items);
            }
        };

        const griftLedger = {
            storageKey: 'loom-grift-ledger',
            entries: [],
            facts: [
                'NFTs are tokens on a blockchain that can reference off-chain media.',
                'Christie’s sold Beeple’s “Everydays: The First 5000 Days” for $69 million in 2021.',
                'Freeports in places like Geneva store art tax-free for years.',
                'Auction houses add buyer’s premiums on top of hammer prices.',
                'Maurizio Cattelan’s banana taped to a wall (“Comedian”) sold for $120,000 in 2019.',
                'Leonardo da Vinci’s “Salvator Mundi” sold for $450.3 million in 2017.',
                'Basquiat’s 1982 skull painting sold for $110.5 million in 2017.',
                'Banksy’s “Love is in the Bin” was partially shredded after it sold at auction in 2018.',
                'Art funds and fractional ownership platforms let investors buy slices of artworks.',
                'Major auction houses have accepted cryptocurrency for select lots.',
                'The global art market clears tens of billions of dollars annually in reported sales.',
                'Private sales often outweigh public auction totals in the art market.',
                'Provenance records can include gallery invoices, exhibition catalogs, and customs forms.',
                'Museums deaccession works to fund operations or acquire new pieces.',
                'A 2017 report estimated billions in art and antiquities are held in freeports.',
                'High-value art is routinely insured for transport, storage, and exhibition.',
                'The original 2010 sale of “Salvator Mundi” was for under $10,000 before its rediscovery.',
                'Andy Warhol’s “Shot Sage Blue Marilyn” sold for $195 million in 2022.',
                'Art Basel’s UBS report tracks global art market trends every year.',
                'Some collectors lend works to museums for tax and prestige benefits.',
                'Auction records are public, private sale prices are often confidential.',
                'The auction term “third-party guarantee” is used to secure minimum prices.',
                'Yachts above 100 meters can cost hundreds of millions of dollars.',
                'Some NFT projects paid creators in crypto that later swung wildly in value.',
                'Tokenized art platforms sometimes link on-chain tokens to off-chain vault storage.',
                'Art shipping crates can be custom-built with climate control.',
                'Gagosian and other mega-galleries represent dozens of top-tier artists.',
                'An art advisor can place works with collectors privately, off the auction floor.',
                'Art market compliance rules now include sanctions screening in many jurisdictions.'
            ],
            init() {
                const stored = window.localStorage.getItem(griftLedger.storageKey);
                griftLedger.entries = stored ? JSON.parse(stored) : [];
                griftLedger.render();
            },
            save() {
                window.localStorage.setItem(griftLedger.storageKey, JSON.stringify(griftLedger.entries));
            },
            addSale(asset) {
                const stamp = new Date().toLocaleString();
                const shuffled = griftLedger.facts.slice().sort(() => 0.5 - Math.random());
                const chain = shuffled.slice(0, 8);
                griftLedger.entries.unshift({
                    id: `grift-${Date.now()}-${Math.random().toString(36).slice(2, 6)}`,
                    title: asset.title || asset.specimenId || 'Unnamed Asset',
                    origin: asset.origin || 'Unknown Intake',
                    mode: asset.modeLabel || asset.mode || asset.type || 'mixed',
                    stamp,
                    chain
                });
                griftLedger.save();
                griftLedger.render();
            },
            render() {
                const ledger = document.getElementById('grift-ledger');
                const count = document.getElementById('grift-asset-count');
                if (count) count.innerText = griftLedger.entries.length;
                if (!ledger) return;
                if (!griftLedger.entries.length) {
                    ledger.innerHTML = '<div class="text-gray-400">No assets pushed through the Grift Shop yet.</div>';
                    return;
                }
                ledger.innerHTML = griftLedger.entries.map(entry => `
                    <div class="border border-gray-700 p-4 rounded-lg">
                        <div class="text-[10px] uppercase tracking-widest text-gray-400 mb-2">Intake • ${entry.stamp}</div>
                        <div class="font-bold uppercase text-loom-red">${entry.title}</div>
                        <div class="text-[10px] uppercase tracking-widest text-gray-400">Origin: ${entry.origin} • Mode: ${entry.mode}</div>
                        <ul class="mt-3 space-y-2 text-gray-200">
                            ${entry.chain.map(item => `<li>• ${item}</li>`).join('')}
                        </ul>
                    </div>
                `).join('');
            }
        };

        // 5. Gallery (Three.js 3D Room)
        const gallery = {
            scene: null,
            camera: null,
            renderer: null,
            wallGroup: null,
            vitrineGroup: null,
            lanternGroup: null,
            lanternLight: null,
            lanternSpot: null,
            lanternGlow: null,
            lanternActive: false,
            lanternFlickerSeed: Math.random() * 1000,
            assetIds: new Set(),
            controls: {
                yaw: 0,
                pitch: 0,
                position: new THREE.Vector3(0, 1.6, 6),
                isDragging: false,
                dragMode: 'rotate',
                lastX: 0,
                lastY: 0,
                keys: {}
            },
            init: () => {
                const container = document.getElementById('canvas-container');
                if(!container || gallery.scene) return;

                gallery.scene = new THREE.Scene();
                gallery.scene.background = new THREE.Color(0x0f0f0f);
                gallery.scene.fog = new THREE.Fog(0x0f0f0f, 5, 20);

                gallery.camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
                gallery.camera.position.copy(gallery.controls.position);

                gallery.renderer = new THREE.WebGLRenderer({alpha:true, antialias:true});
                gallery.renderer.setSize(window.innerWidth, window.innerHeight);
                container.appendChild(gallery.renderer.domElement);
                gallery.renderer.setPixelRatio(window.devicePixelRatio || 1);
                gallery.renderer.domElement.style.touchAction = 'none';

                // Lighting
                const light = new THREE.DirectionalLight(0xffffff, 1);
                light.position.set(3, 6, 5);
                gallery.scene.add(light);
                gallery.scene.add(new THREE.AmbientLight(0x404040, 1.2));

                gallery.wallGroup = new THREE.Group();
                gallery.vitrineGroup = new THREE.Group();
                gallery.scene.add(gallery.wallGroup);
                gallery.scene.add(gallery.vitrineGroup);

                // Grid Floor
                const grid = new THREE.GridHelper(20, 20, 0x333333, 0x111111);
                gallery.scene.add(grid);

                gallery.buildEnvironment();
                assetState.subscribe((items) => gallery.updateAssets(items));

                gallery.bindControls();

                const animate = function () {
                    requestAnimationFrame(animate);
                    gallery.updateMovement();
                    gallery.updateCamera();
                    gallery.updateLantern();
                    gallery.renderer.render(gallery.scene, gallery.camera);
                };
                animate();
                
                window.addEventListener('resize', () => {
                    gallery.camera.aspect = window.innerWidth / window.innerHeight;
                    gallery.camera.updateProjectionMatrix();
                    gallery.renderer.setSize(window.innerWidth, window.innerHeight);
                });
            },
            buildEnvironment: () => {
                const wallMaterial = new THREE.MeshStandardMaterial({ color: 0x111111, roughness: 0.8, metalness: 0.1 });
                const wall = new THREE.Mesh(new THREE.PlaneGeometry(14, 6), wallMaterial);
                wall.position.set(0, 3, -7);
                gallery.scene.add(wall);

                const floor = new THREE.Mesh(
                    new THREE.PlaneGeometry(20, 20),
                    new THREE.MeshStandardMaterial({ color: 0x0b0b0b, roughness: 0.9, metalness: 0.05 })
                );
                floor.rotation.x = -Math.PI / 2;
                floor.position.y = 0;
                gallery.scene.add(floor);
            },
            updateAssets: (items) => {
                gallery.clearGroup(gallery.wallGroup);
                gallery.clearGroup(gallery.vitrineGroup);
                gallery.assetIds = new Set();
                const twoDAssets = items.filter((item) => item.type === '2d');
                const threeDAssets = items.filter((item) => item.type === '3d');
                twoDAssets.forEach((asset, index) => gallery.add2DAsset(asset, index));
                threeDAssets.forEach((asset, index) => gallery.add3DAsset(asset, index));
                gallery.updateWorksList(items);
            },
            updateWorksList: (items) => {
                const list = document.getElementById('gallery-works');
                if (!list) return;
                if (!items.length) {
                    list.textContent = 'No works yet.';
                    return;
                }
                list.innerHTML = items.slice(0, 6).map(item => `
                    <div>${item.title || item.specimenId} • ${item.modeLabel || item.type}</div>
                `).join('');
            },
            add2DAsset: (asset, index) => {
                if (!asset.dataUrl) return;
                const texture = new THREE.TextureLoader().load(asset.dataUrl);
                texture.needsUpdate = true;
                const plane = new THREE.Mesh(
                    new THREE.PlaneGeometry(1.4, 1.0),
                    new THREE.MeshStandardMaterial({ map: texture, metalness: 0.1, roughness: 0.8 })
                );
                const cols = 4;
                const row = Math.floor(index / cols);
                const col = index % cols;
                const startX = -3.2;
                const startY = 4.4;
                plane.position.set(startX + col * 2.1, startY - row * 1.4, -6.95);
                gallery.wallGroup.add(plane);

                const frame = new THREE.Mesh(
                    new THREE.BoxGeometry(1.48, 1.08, 0.05),
                    new THREE.MeshStandardMaterial({ color: 0x2a2a2a })
                );
                frame.position.copy(plane.position);
                frame.position.z = -7.0;
                gallery.wallGroup.add(frame);
            },
            add3DAsset: (asset, index) => {
                const group = new THREE.Group();
                const base = new THREE.Mesh(
                    new THREE.BoxGeometry(1.8, 0.2, 1.2),
                    new THREE.MeshStandardMaterial({ color: 0x1b1b1b, metalness: 0.2, roughness: 0.7 })
                );
                base.position.y = 0.1;
                group.add(base);

                const glass = new THREE.Mesh(
                    new THREE.BoxGeometry(1.6, 1.2, 1.0),
                    new THREE.MeshStandardMaterial({ color: 0x88aacc, transparent: true, opacity: 0.25, roughness: 0.1 })
                );
                glass.position.y = 0.8;
                group.add(glass);

                const palette = asset.palette || ['#d7342a', '#f6f0e6', '#111111'];
                const core = new THREE.Mesh(
                    new THREE.DodecahedronGeometry(0.35, 0),
                    new THREE.MeshStandardMaterial({ color: palette[0] || '#d7342a', metalness: 0.6, roughness: 0.3 })
                );
                core.position.y = 0.8;
                core.rotation.set(0.4, 0.6, 0);
                group.add(core);

                const ring = new THREE.Mesh(
                    new THREE.TorusGeometry(0.45, 0.05, 10, 36),
                    new THREE.MeshStandardMaterial({ color: palette[1] || '#f6f0e6', metalness: 0.4, roughness: 0.4 })
                );
                ring.position.y = 0.8;
                ring.rotation.x = Math.PI / 2;
                group.add(ring);

                const x = -3.5 + index * 2.2;
                group.position.set(x, 0, -2);
                gallery.vitrineGroup.add(group);
            },
            clearGroup: (group) => {
                if (!group) return;
                while (group.children.length) {
                    group.remove(group.children[0]);
                }
            },
            bindControls: () => {
                const canvas = gallery.renderer.domElement;
                canvas.addEventListener('contextmenu', (event) => event.preventDefault());
                canvas.addEventListener('pointerdown', (event) => {
                    if (event.pointerType === 'touch') event.preventDefault();
                    gallery.controls.isDragging = true;
                    gallery.controls.dragMode = event.shiftKey ? 'pan' : (event.button === 2 ? 'dolly' : 'rotate');
                    gallery.controls.lastX = event.clientX;
                    gallery.controls.lastY = event.clientY;
                    canvas.setPointerCapture(event.pointerId);
                }, { passive: false });
                canvas.addEventListener('pointermove', (event) => {
                    if (!gallery.controls.isDragging) return;
                    const dx = event.clientX - gallery.controls.lastX;
                    const dy = event.clientY - gallery.controls.lastY;
                    gallery.controls.lastX = event.clientX;
                    gallery.controls.lastY = event.clientY;
                    if (gallery.controls.dragMode === 'rotate') {
                        gallery.controls.yaw -= dx * 0.005;
                        gallery.controls.pitch -= dy * 0.005;
                        gallery.controls.pitch = Math.max(-1.2, Math.min(1.2, gallery.controls.pitch));
                    } else if (gallery.controls.dragMode === 'pan') {
                        const right = new THREE.Vector3(Math.cos(gallery.controls.yaw), 0, -Math.sin(gallery.controls.yaw));
                        const up = new THREE.Vector3(0, 1, 0);
                        gallery.controls.position.add(right.multiplyScalar(-dx * 0.01));
                        gallery.controls.position.add(up.multiplyScalar(dy * 0.01));
                    } else {
                        const forward = new THREE.Vector3(Math.sin(gallery.controls.yaw), 0, Math.cos(gallery.controls.yaw));
                        gallery.controls.position.add(forward.multiplyScalar(dy * 0.02));
                    }
                });
                canvas.addEventListener('pointerup', (event) => {
                    gallery.controls.isDragging = false;
                    canvas.releasePointerCapture(event.pointerId);
                });
                canvas.addEventListener('wheel', (event) => {
                    const forward = new THREE.Vector3(Math.sin(gallery.controls.yaw), 0, Math.cos(gallery.controls.yaw));
                    gallery.controls.position.add(forward.multiplyScalar(event.deltaY * 0.01));
                });
                window.addEventListener('keydown', (event) => {
                    gallery.controls.keys[event.code] = true;
                });
                window.addEventListener('keyup', (event) => {
                    gallery.controls.keys[event.code] = false;
                });
            },
            updateMovement: () => {
                const keys = gallery.controls.keys;
                const speed = 0.08;
                const forward = new THREE.Vector3(Math.sin(gallery.controls.yaw), 0, Math.cos(gallery.controls.yaw));
                const right = new THREE.Vector3(Math.cos(gallery.controls.yaw), 0, -Math.sin(gallery.controls.yaw));
                if (keys['KeyW']) gallery.controls.position.add(forward.clone().multiplyScalar(-speed));
                if (keys['KeyS']) gallery.controls.position.add(forward.clone().multiplyScalar(speed));
                if (keys['KeyA']) gallery.controls.position.add(right.clone().multiplyScalar(-speed));
                if (keys['KeyD']) gallery.controls.position.add(right.clone().multiplyScalar(speed));
            },
            updateCamera: () => {
                const direction = new THREE.Vector3(
                    Math.sin(gallery.controls.yaw) * Math.cos(gallery.controls.pitch),
                    Math.sin(gallery.controls.pitch),
                    Math.cos(gallery.controls.yaw) * Math.cos(gallery.controls.pitch)
                );
                gallery.camera.position.copy(gallery.controls.position);
                gallery.camera.lookAt(gallery.controls.position.clone().add(direction));
            },
            resetCamera: () => {
                if(gallery.camera) {
                    gallery.controls.position.set(0, 1.6, 6);
                    gallery.controls.yaw = 0;
                    gallery.controls.pitch = 0;
                    gallery.updateCamera();
                }
            },
            buildLantern: () => {
                const group = new THREE.Group();
                group.name = 'gallery-lantern';

                const brass = new THREE.MeshStandardMaterial({
                    color: 0xb08d57,
                    metalness: 0.85,
                    roughness: 0.35
                });
                const iron = new THREE.MeshStandardMaterial({
                    color: 0x1a1a1a,
                    metalness: 0.6,
                    roughness: 0.5
                });
                const glass = new THREE.MeshStandardMaterial({
                    color: 0xffd8a3,
                    transparent: true,
                    opacity: 0.35,
                    roughness: 0.15,
                    metalness: 0.1,
                    emissive: 0x4a2d12,
                    emissiveIntensity: 0.6
                });

                const plinth = new THREE.Mesh(new THREE.CylinderGeometry(0.7, 0.9, 0.14, 24), iron);
                plinth.position.y = 0.07;
                group.add(plinth);

                const stem = new THREE.Mesh(new THREE.CylinderGeometry(0.09, 0.12, 0.5, 16), brass);
                stem.position.y = 0.39;
                group.add(stem);

                const baseRing = new THREE.Mesh(new THREE.CylinderGeometry(0.5, 0.56, 0.12, 18), brass);
                baseRing.position.y = 0.7;
                group.add(baseRing);

                const glassBody = new THREE.Mesh(new THREE.CylinderGeometry(0.38, 0.42, 0.7, 20), glass);
                glassBody.position.y = 1.02;
                group.add(glassBody);
                gallery.lanternGlow = glassBody;

                const cap = new THREE.Mesh(new THREE.ConeGeometry(0.52, 0.35, 20), brass);
                cap.position.y = 1.47;
                group.add(cap);

                const vent = new THREE.Mesh(new THREE.CylinderGeometry(0.2, 0.24, 0.18, 16), iron);
                vent.position.y = 1.6;
                group.add(vent);

                const postGeom = new THREE.BoxGeometry(0.05, 0.8, 0.05);
                const postOffsets = [
                    [0.34, 1.02, 0.34],
                    [-0.34, 1.02, 0.34],
                    [0.34, 1.02, -0.34],
                    [-0.34, 1.02, -0.34]
                ];
                postOffsets.forEach(([x, y, z]) => {
                    const post = new THREE.Mesh(postGeom, iron);
                    post.position.set(x, y, z);
                    group.add(post);
                });

                const handle = new THREE.Mesh(new THREE.TorusGeometry(0.32, 0.03, 12, 36, Math.PI), brass);
                handle.position.y = 1.78;
                handle.rotation.x = Math.PI;
                group.add(handle);

                return group;
            },
            toggleLantern: () => {
                if (!gallery.scene) return;
                if (gallery.lanternActive) {
                    gallery.removeLantern();
                } else {
                    gallery.addLantern();
                }
            },
            addLantern: () => {
                if (gallery.lanternGroup) return;
                const group = gallery.buildLantern();
                group.position.set(0, 0, 0);
                gallery.scene.add(group);
                gallery.lanternGroup = group;

                const light = new THREE.PointLight(0xffc679, 2.4, 14, 2);
                light.position.set(0, 1.1, 0);
                gallery.scene.add(light);
                gallery.lanternLight = light;

                const spot = new THREE.SpotLight(0xffb35a, 1.2, 18, Math.PI / 5, 0.4, 1);
                spot.position.set(0, 2.6, 0.6);
                spot.target = group;
                gallery.scene.add(spot);
                gallery.lanternSpot = spot;

                gallery.lanternActive = true;
                gallery.updateLanternButton();
            },
            removeLantern: () => {
                if (gallery.lanternGroup) {
                    gallery.scene.remove(gallery.lanternGroup);
                    gallery.lanternGroup = null;
                }
                if (gallery.lanternLight) {
                    gallery.scene.remove(gallery.lanternLight);
                    gallery.lanternLight = null;
                }
                if (gallery.lanternSpot) {
                    gallery.scene.remove(gallery.lanternSpot);
                    gallery.lanternSpot = null;
                }
                gallery.lanternGlow = null;
                gallery.lanternActive = false;
                gallery.updateLanternButton();
            },
            updateLanternButton: () => {
                const button = document.getElementById('gallery-lantern-toggle');
                if (!button) return;
                button.textContent = gallery.lanternActive ? 'Extinguish Lantern' : 'Turn On Lantern';
            },
            updateLantern: () => {
                if (!gallery.lanternActive || !gallery.lanternLight) return;
                const t = performance.now() * 0.002 + gallery.lanternFlickerSeed;
                const flicker = 0.6 + Math.sin(t * 2.1) * 0.2 + Math.sin(t * 7.4) * 0.1;
                gallery.lanternLight.intensity = 2.2 + flicker;
                if (gallery.lanternSpot) {
                    gallery.lanternSpot.intensity = 1.0 + flicker * 0.4;
                }
                if (gallery.lanternGlow && gallery.lanternGlow.material) {
                    gallery.lanternGlow.material.emissiveIntensity = 0.6 + flicker * 0.6;
                }
                if (gallery.lanternGroup) {
                    gallery.lanternGroup.rotation.y += 0.002;
                }
            }
        };

        // 6. Value State + Grift Logic
        const valueState = {
            tokens: 0,
            solved: new Set(),
            listeners: [],
            addToken(id) {
                if (valueState.solved.has(id)) return;
                valueState.solved.add(id);
                valueState.tokens += 1;
                valueState.emit();
            },
            emit() {
                valueState.listeners.forEach((fn) => fn(valueState));
            },
            subscribe(fn) {
                valueState.listeners.push(fn);
                fn(valueState);
            }
        };

        const grift = {
            bound: false,
            boxClicks: 0,
            init: () => {
                if (grift.bound) {
                    grift.updateFromValueState(valueState);
                    return;
                }
                grift.bound = true;
                const slider = document.getElementById('coin-slider');
                if (slider) slider.addEventListener('input', grift.handleCoin);
                const tape = document.getElementById('box-tape');
                if (tape) tape.addEventListener('click', grift.handleBox);
                document.querySelectorAll('.timeshare-box').forEach((box) => box.addEventListener('change', grift.handleTimeshare));
                document.querySelectorAll('#paywall-options input[type="radio"]').forEach((opt) => opt.addEventListener('change', grift.handlePaywall));
                const termsFlag = document.getElementById('terms-flag');
                if (termsFlag) termsFlag.addEventListener('click', grift.handleTerms);
                document.querySelectorAll('.subscription-toggle').forEach((toggle) => toggle.addEventListener('change', grift.handleSubscription));
                document.querySelectorAll('#scam-options [data-scam]').forEach((btn) => btn.addEventListener('click', grift.handleScam));
                const bundle = document.getElementById('bundle-slider');
                if (bundle) bundle.addEventListener('input', grift.handleBundle);
                const fee = document.getElementById('receipt-fee');
                if (fee) fee.addEventListener('click', grift.handleReceipt);
                valueState.subscribe(grift.updateFromValueState);
                grift.handleTimeshare();
                grift.updateState('griftIdle');
            },
            updateFromValueState: (state) => {
                const tokenCount = document.getElementById('token-count');
                if (tokenCount) tokenCount.innerText = state.tokens;
                let stateLabel = 'griftIdle';
                if (state.tokens >= 6) stateLabel = 'griftThresholdMet';
                else if (state.tokens >= 3) stateLabel = 'griftInOnJoke';
                else if (state.tokens >= 1) stateLabel = 'griftExploring';
                grift.updateState(stateLabel);
                const overlay = document.getElementById('grift-overlay');
                if (overlay) overlay.classList.toggle('hidden', state.tokens < 6);
                if (state.solved.has('influencer-coin')) grift.setYield('coin-yield');
                if (state.solved.has('merch-box')) grift.setYield('box-yield');
                if (state.solved.has('timeshare')) grift.setYield('time-yield');
                if (state.solved.has('paywall')) grift.setYield('paywall-yield');
                if (state.solved.has('terms')) grift.setYield('terms-yield');
                if (state.solved.has('subscription')) grift.setYield('subscription-yield');
                if (state.solved.has('scam')) grift.setYield('scam-yield');
                if (state.solved.has('bundle')) grift.setYield('bundle-yield');
                if (state.solved.has('receipt')) grift.setYield('receipt-yield');
                valueGate.updateTokens(valueState);
            },
            updateState: (label) => {
                grift.state = label;
                const stateLabel = document.getElementById('grift-state');
                const note = document.getElementById('grift-note');
                const hint = document.getElementById('grift-hint');
                const messages = {
                    griftIdle: 'waiting for you to notice the seams.',
                    griftExploring: 'value under construction. keep digging.',
                    griftInOnJoke: 'copy shifts to conspiratorial whispers.',
                    griftThresholdMet: 'tickets still unavailable, but you are provisionally woven in.'
                };
                if (stateLabel) stateLabel.innerText = label;
                if (note) note.innerText = messages[label] || '';
                if (hint) {
                    hint.innerText = label === 'griftThresholdMet'
                        ? 'LOOMWORKS NOTE: applicant displays healthy suspicion. good.'
                        : label === 'griftInOnJoke'
                            ? 'you feel like you’re in on the joke now.'
                            : label === 'griftExploring'
                                ? 'keep poking the boxes. value leaks out.'
                                : '';
                }
            },
            setYield: (id) => {
                const el = document.getElementById(id);
                if (el) el.innerText = 'Yield: +1';
            },
            handleCoin: (event) => {
                if (Math.random() > 0.85 && window.audio) audio.click();
                const val = Number(event.target.value);
                const lore = document.getElementById('coin-lore');
                if (val <= 12) {
                    if (lore) lore.innerText = 'Craft dips the price; the value stabilizes.';
                    valueState.addToken('influencer-coin');
                } else if (lore) {
                    lore.innerText = 'Drag toward craft. See what happens.';
                }
            },
            handleBox: () => {
                grift.boxClicks += 1;
                const progress = document.getElementById('box-progress');
                const note = document.getElementById('box-note');
                const words = ['TAP', 'AGAIN', 'OPEN'];
                if (progress) progress.innerText = grift.boxClicks <= words.length ? words[grift.boxClicks - 1] : 'OPEN';
                if (grift.boxClicks >= 3) {
                    if (note) note.classList.remove('hidden');
                    valueState.addToken('merch-box');
                }
            },
            handleTimeshare: () => {
                const boxes = Array.from(document.querySelectorAll('.timeshare-box'));
                const submit = document.getElementById('timeshare-submit');
                const note = document.getElementById('timeshare-note');
                const allOff = boxes.length ? boxes.every((box) => !box.checked) : false;
                if (submit) {
                    submit.classList.toggle('cursor-not-allowed', !allOff);
                    submit.classList.toggle('bg-gray-200', !allOff);
                    submit.classList.toggle('bg-black', allOff);
                    submit.classList.toggle('text-white', allOff);
                }
                if (allOff) {
                    if (note) note.innerText = 'Contract voided. You kept your hours.';
                    valueState.addToken('timeshare');
                }
            },
            handlePaywall: (event) => {
                const note = document.getElementById('paywall-note');
                if (event.target.value === 'library') {
                    if (note) note.innerText = 'Respectful workaround unlocked.';
                    valueState.addToken('paywall');
                } else if (note) {
                    note.innerText = 'One of these honors the work and still gets you through.';
                }
            },
            handleTerms: () => {
                const btn = document.getElementById('terms-flag');
                if (btn) btn.innerText = 'CLAUSE FLAGGED';
                valueState.addToken('terms');
            },
            handleSubscription: () => {
                const toggles = Array.from(document.querySelectorAll('.subscription-toggle'));
                const allOff = toggles.length ? toggles.every((toggle) => !toggle.checked) : false;
                const note = document.getElementById('subscription-note');
                if (allOff) {
                    if (note) note.innerText = 'Auto-renew disabled. You are free.';
                    valueState.addToken('subscription');
                }
            },
            handleScam: (event) => {
                const note = document.getElementById('scam-note');
                if (event.currentTarget.dataset.scam === 'right') {
                    if (note) note.innerText = 'You flagged the obvious grift. Inbox safe.';
                    valueState.addToken('scam');
                } else if (note) {
                    note.innerText = 'That one feels normal. Try again.';
                }
            },
            handleBundle: (event) => {
                const val = Number(event.target.value);
                const note = document.getElementById('bundle-note');
                if (val <= 12) {
                    if (note) note.innerText = 'Bundle stripped down to the real need.';
                    valueState.addToken('bundle');
                }
            },
            handleReceipt: () => {
                const fee = document.getElementById('receipt-fee');
                const total = document.getElementById('receipt-total');
                const note = document.getElementById('receipt-note');
                if (fee) fee.classList.add('hidden');
                if (total) total.innerText = '$25.00';
                if (note) note.innerText = 'Fee deleted. Value preserved.';
                valueState.addToken('receipt');
            }
        };

        const geoQuiz = {
            step: 0,
            completed: false,
            questions: [
                {
                    title: '“Brick” hits your ears on Canal Street. What are they warning you about?',
                    copy: 'New Yorkers weaponize understatement. Decode the emoji, dodge the frostbite.',
                    options: [
                        { emoji: '🧊', label: 'Arctic wind slicing between the avenues.', hint: 'Layer up or turn back.', toast: 'Confirmed: you know “brick” is freeze-your-face cold.', correct: true },
                        { emoji: '🛑', label: 'NYPD sweeping for alternate-side violators.', hint: 'Different kind of ticket.', toast: 'Nice paranoia, but “brick” isn’t a parking scare.' },
                        { emoji: '💪', label: 'Time to flex at an Equinox stairwell selfie.', hint: 'Respect the hustle.', toast: 'Bold move. Wrong slang axis though.' }
                    ]
                },
                {
                    title: 'A friend orders a chopped cheese run. Where are you headed?',
                    copy: 'No couriers; no apps. Just you, a grill, and a hum of fluorescent lights.',
                    options: [
                        { emoji: '🧀', label: 'The bodega flat-top under the humming fan.', hint: 'Cash only, wrapped in foil.', toast: 'Correct. You can smell the hero bread already.', correct: true },
                        { emoji: '💈', label: 'Your barber who swears he “also chefs.”', hint: 'Please don’t.', toast: 'Sharp fade, questionable sandwich.' },
                        { emoji: '🎲', label: 'An alley dice game off the J train.', hint: 'Different hustle.', toast: 'That’s a different kind of chopped.' }
                    ]
                },
                {
                    title: 'Someone taps you and says “you’ve got schmutz.” What happens next?',
                    copy: 'Yiddish lives on the subway. Handle it like you belong.',
                    options: [
                        { emoji: '🫟', label: 'Swipe the face, keep moving before the doors close.', hint: 'Efficient correction.', toast: 'True local move: wipe and ride.', correct: true },
                        { emoji: '♀️', label: 'Strike a Lady Liberty pose and hope for the best.', hint: 'Patriotism is not a napkin.', toast: 'Statuesque, but no.' },
                        { emoji: '🥴', label: 'Tell them the city’s energy is the real smudge.', hint: 'Meta, but messy.', toast: 'Points for poetry, not for cleanliness.' }
                    ]
                }
            ],
            init() {
                geoQuiz.reset();
            },
            start() {
                audio.click();
                geoQuiz.completed = false;
                geoQuiz.step = 0;
                geoQuiz.render();
            },
            reset() {
                const stage = document.getElementById('geo-quiz-stage');
                const status = document.getElementById('geo-quiz-status');
                const card = document.getElementById('geo-quiz-card');
                const step = document.getElementById('geo-quiz-step');
                if (stage) stage.classList.add('hidden');
                if (status) status.innerText = 'Tap verify to begin.';
                if (card) card.innerHTML = '';
                if (step) step.innerText = `0/${geoQuiz.questions.length}`;
                geoQuiz.step = 0;
                geoQuiz.completed = false;
                valueGate.updateTokens(valueState);
            },
            render() {
                const stage = document.getElementById('geo-quiz-stage');
                const status = document.getElementById('geo-quiz-status');
                const card = document.getElementById('geo-quiz-card');
                const step = document.getElementById('geo-quiz-step');
                if (!stage || !status || !card || !step) return;
                stage.classList.remove('hidden');
                const q = geoQuiz.questions[geoQuiz.step];
                step.innerText = `${geoQuiz.step + 1}/${geoQuiz.questions.length}`;
                status.innerText = 'Pick the tile that feels right.';
                card.innerHTML = `
                    <div class="bg-[#FDFBF7] border border-black/10 rounded-xl p-4 shadow-sm space-y-2">
                        <div class="flex items-center justify-between gap-2">
                            <span class="text-[10px] font-mono uppercase tracking-[0.25em] text-red-600">Bodega Banter Check</span>
                            <span class="text-[10px] font-mono uppercase tracking-[0.25em] text-gray-600">No wrong answers, just vibes.</span>
                        </div>
                        <h4 class="text-xl font-bold uppercase leading-tight">${q.title}</h4>
                        <p class="text-sm text-gray-700">${q.copy}</p>
                        <div class="grid sm:grid-cols-3 gap-3 pt-2" id="geo-quiz-options"></div>
                    </div>
                `;

                const optionsWrap = document.getElementById('geo-quiz-options');
                if (!optionsWrap) return;
                optionsWrap.innerHTML = '';
                q.options.forEach((opt) => {
                    const tile = document.createElement('button');
                    tile.className = 'geo-quiz-tile ui-click border border-gray-200';
                    tile.innerHTML = `
                        <div class="text-3xl">${opt.emoji}</div>
                        <div class="text-sm font-mono text-gray-800 leading-snug">${opt.label}</div>
                        <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500">${opt.hint}</div>
                    `;
                    tile.onclick = () => geoQuiz.choose(opt, tile);
                    optionsWrap.appendChild(tile);
                });
            },
            choose(opt, tile) {
                audio.click();
                document.querySelectorAll('.geo-quiz-tile').forEach((btn) => btn.classList.remove('selected'));
                tile.classList.add('selected');
                const status = document.getElementById('geo-quiz-status');
                if (status) status.innerText = opt.toast || 'Noted.';
                setTimeout(() => {
                    geoQuiz.step += 1;
                    if (geoQuiz.step < geoQuiz.questions.length) geoQuiz.render();
                    else geoQuiz.complete();
                }, 480);
            },
            complete() {
                const card = document.getElementById('geo-quiz-card');
                const status = document.getElementById('geo-quiz-status');
                const step = document.getElementById('geo-quiz-step');
                if (step) step.innerText = `${geoQuiz.questions.length}/${geoQuiz.questions.length}`;
                if (status) status.innerText = 'Stamped: ready for the ticket gate.';
                if (card) {
                    card.innerHTML = `
                        <div class="bg-black text-white rounded-xl p-5 border border-red-500 shadow-lg space-y-3">
                            <div class="font-mono text-[10px] uppercase tracking-widest text-red-200">Validated • New Yorker Enough</div>
                            <h4 class="text-2xl font-bold uppercase">Geospatial Compatibility Confirmed</h4>
                            <p class="text-sm text-gray-100 leading-relaxed">You clocked the slang and kept it moving. The ticketing tiers are unlocked without embarrassing anyone’s borough.</p>
                            <div class="flex flex-wrap gap-2">
                                <button onclick="geoQuiz.reset()" class="ui-click border border-white/40 text-xs font-mono uppercase tracking-widest px-3 py-2 hover:bg-white hover:text-black transition-colors">Re-run Quiz</button>
                            </div>
                        </div>
                    `;
                }
                geoQuiz.completed = true;
                geoQuiz.step = 0;
                valueGate.updateTokens(valueState);
            }
        };

        const valueGate = {
            updateTokens: (state) => {
                const tokenCount = document.getElementById('ticket-token-count');
                if (tokenCount) tokenCount.innerText = state.tokens;
                const status = document.getElementById('ticket-status');
                const verifyBtn = document.getElementById('ticket-verify');
                const tokensReady = state.tokens >= 6;
                const quizReady = geoQuiz.completed;
                if (!status) return;
                if (!tokensReady) {
                    status.innerText = 'tickets unavailable. collect 6 of 9 grift tokens, then pass the NYC slang quiz 🗽.';
                    if (verifyBtn) verifyBtn.disabled = false;
                } else if (!quizReady) {
                    status.innerText = 'Tokens logged. Pass the NYC slang quiz 🗽 to open ticketing.';
                    if (verifyBtn) verifyBtn.disabled = false;
                } else {
                    status.innerText = 'tickets still unavailable, but you’ve been provisionally woven in.';
                    if (verifyBtn) verifyBtn.disabled = true;
                }
            }
        };

        const investorQuiz = {
            quips: [
                'Choice logged: {choice}. Classic. Predictable. Still cute. ;) :) :o 🤹‍♀️⚡',
                'You picked {choice}. Bold, for someone who knows we were going to roast you. ;) :) :o 🧨😇',
                'Ah, {choice}. A timeless selection from the “I definitely thought about this” aisle. ;) :) :o 🎪😏',
                'So, {choice}. We’re clapping in slow motion. It’s adorable. ;) :) :o 🔥🪄'
            ],
            init() {
                const response = document.getElementById('investor-quiz-response');
                const options = document.querySelectorAll('[data-investor-option]');
                if (!response || !options.length) return;
                options.forEach((btn, index) => {
                    btn.addEventListener('click', () => {
                        options.forEach((opt) => opt.classList.remove('bg-black', 'text-white'));
                        btn.classList.add('bg-black', 'text-white');
                        const choice = btn.dataset.label || btn.textContent.trim();
                        const quip = this.quips[index % this.quips.length].replace('{choice}', choice);
                        response.innerHTML = `<span class="glitch-text" data-text="${quip}">${quip}</span>`;
                    });
                });
            }
        };

        // 7. Site Map Modal
        const siteMap = {
            open: () => {
                const modal = document.getElementById('site-map-modal');
                if (!modal) return;
                modal.classList.add('active');
                document.body.classList.add('modal-open');
            },
            close: () => {
                const modal = document.getElementById('site-map-modal');
                if (!modal) return;
                modal.classList.remove('active');
                document.body.classList.remove('modal-open');
            },
            jump: (target) => {
                siteMap.close();
                app.navigate(target);
            }
        };

        // 8. Voxel Field
        const voxelField = {
            canvas: null,
            ctx: null,
            cols: 18,
            rows: 12,
            size: 20,
            cells: [],
            hover: null,
            init: () => {
                const canvas = document.getElementById('voxel-celli');
                if (!canvas) return;
                voxelField.canvas = canvas;
                voxelField.ctx = canvas.getContext('2d');
                voxelField.size = Math.floor(canvas.width / voxelField.cols);
                voxelField.cells = Array.from({ length: voxelField.cols * voxelField.rows }, () => Math.random());
                voxelField.render();
                canvas.addEventListener('mousemove', voxelField.onMove);
                canvas.addEventListener('mouseleave', voxelField.onLeave);
            },
            onMove: (event) => {
                const rect = voxelField.canvas.getBoundingClientRect();
                const scaleX = voxelField.canvas.width / rect.width;
                const scaleY = voxelField.canvas.height / rect.height;
                const x = Math.floor((event.clientX - rect.left) * scaleX / voxelField.size);
                const y = Math.floor((event.clientY - rect.top) * scaleY / voxelField.size);
                voxelField.hover = { x, y };
                voxelField.render();
            },
            onLeave: () => {
                voxelField.hover = null;
                voxelField.render();
            },
            render: () => {
                const ctx = voxelField.ctx;
                if (!ctx) return;
                const palette = ['#2555FF', '#FFC54D', '#3DFFB5', '#CD2B2B', '#5A2D82'];
                ctx.clearRect(0, 0, voxelField.canvas.width, voxelField.canvas.height);
                ctx.fillStyle = '#0b0b0b';
                ctx.fillRect(0, 0, voxelField.canvas.width, voxelField.canvas.height);
                for (let row = 0; row < voxelField.rows; row += 1) {
                    for (let col = 0; col < voxelField.cols; col += 1) {
                        const idx = row * voxelField.cols + col;
                        const value = voxelField.cells[idx];
                        const colorIndex = Math.floor(value * palette.length);
                        ctx.fillStyle = palette[colorIndex] || palette[0];
                        const x = col * voxelField.size + 2;
                        const y = row * voxelField.size + 2;
                        ctx.fillRect(x, y, voxelField.size - 4, voxelField.size - 4);
                        if (voxelField.hover && voxelField.hover.x === col && voxelField.hover.y === row) {
                            ctx.strokeStyle = '#FDFBF7';
                            ctx.lineWidth = 2;
                            ctx.strokeRect(x - 1, y - 1, voxelField.size - 2, voxelField.size - 2);
                        }
                    }
                }
            }
        };

        // 9. Cel Engine (Evolving Flow)
        const celEngine = {
            data: JSON.parse(document.getElementById('cel-data').textContent),
            visits: {},
            activeId: null,
            init: () => {
                const stored = window.localStorage.getItem('loom-cel-visits');
                celEngine.visits = stored ? JSON.parse(stored) : {};
                celEngine.renderGrid();
                celEngine.updateEntropy();
            },
            save: () => {
                window.localStorage.setItem('loom-cel-visits', JSON.stringify(celEngine.visits));
            },
            renderGrid: () => {
                const grid = document.getElementById('cel-grid');
                if (!grid) return;
                grid.innerHTML = '';
                celEngine.data.forEach((cel) => {
                    const visits = celEngine.visits[cel.id] || 0;
                    const stageIndex = Math.min(Math.max(visits - 1, 0), cel.stages.length - 1);
                    const stage = cel.stages[stageIndex];
                    const card = document.createElement('button');
                    card.className = 'cel-card ui-click text-left';
                    card.dataset.celId = cel.id;
                    card.innerHTML = `
                        <div class="flex items-start justify-between gap-3">
                            <div>
                                <div class="cel-stage">${stage.label}</div>
                                <div class="font-bold uppercase text-sm mt-1">${cel.title}</div>
                                <div class="text-xs text-gray-600 mt-2">${stage.summary}</div>
                            </div>
                            <div class="text-2xl">${cel.glyph}</div>
                        </div>
                        <div class="text-[10px] font-mono uppercase tracking-widest text-gray-500 mt-3">Returns: ${visits}</div>
                    `;
                    card.addEventListener('click', () => celEngine.activate(cel.id));
                    if (celEngine.activeId === cel.id) card.classList.add('active');
                    grid.appendChild(card);
                });
            },
            activate: (id) => {
                celEngine.visits[id] = (celEngine.visits[id] || 0) + 1;
                celEngine.activeId = id;
                const cel = celEngine.data.find((item) => item.id === id);
                if (!cel) return;
                const visits = celEngine.visits[id];
                const stageIndex = Math.min(visits - 1, cel.stages.length - 1);
                const stage = cel.stages[stageIndex];
                const label = document.getElementById('cel-stage-label');
                const title = document.getElementById('cel-title');
                const copy = document.getElementById('cel-copy');
                const whisper = document.getElementById('cel-whisper');
                if (label) label.innerText = stage.label;
                if (title) title.innerText = cel.title;
                if (copy) copy.innerText = stage.detail;
                if (whisper) whisper.innerText = `${stage.whisper} • Return count: ${visits}`;
                celEngine.save();
                celEngine.renderGrid();
                celEngine.updateEntropy();
            },
            updateEntropy: () => {
                const total = Object.values(celEngine.visits).reduce((sum, count) => sum + count, 0);
                const entropyCount = document.getElementById('entropy-count');
                if (entropyCount) entropyCount.innerText = total;
                document.body.classList.remove('entropy-1', 'entropy-2', 'entropy-3');
                if (total >= 10) document.body.classList.add('entropy-3');
                else if (total >= 6) document.body.classList.add('entropy-2');
                else if (total >= 3) document.body.classList.add('entropy-1');
            }
        };

        // 10. Profiler Logic + Calibration Gate
        const calibrationGate = {
            state: { arg: null, entry: null, lights: new Set() },

            reset() {
                this.state = { arg: null, entry: null, lights: new Set() };
                document.querySelectorAll('.cal-choice').forEach(btn => btn.classList.remove('bg-white', 'text-black', 'border-black', 'ring-2', 'ring-red-500'));
                document.querySelectorAll('.cal-light').forEach(box => { box.checked = false; });

                const stageSelect = document.getElementById('prof-stage-select');
                if (stageSelect) stageSelect.classList.add('hidden');
                const locked = document.getElementById('prof-stage-locked');
                if (locked) locked.classList.remove('hidden');

                const status = document.getElementById('calibration-status');
                if (status) {
                    status.textContent = 'Set your lumen level to tune how much satire you see.';
                    status.className = 'font-mono text-xs uppercase tracking-widest text-gray-200';
                }

                const readout = document.getElementById('lumen-readout');
                if (readout) readout.textContent = 'Lumen Level: Unset';
            },

            setArg(val, el) {
                this.state.arg = val;
                this.highlight('arg', el);
                this.updateStatus();
            },

            setEntry(val, el) {
                this.state.entry = val;
                this.highlight('entry', el);
                this.updateStatus();
            },

            toggleLight(key, checked) {
                if (checked) this.state.lights.add(key);
                else this.state.lights.delete(key);
            },

            highlight(group, el) {
                document.querySelectorAll(`[data-cal-group="${group}"]`).forEach(btn => btn.classList.remove('bg-white', 'text-black', 'border-black', 'ring-2', 'ring-red-500'));
                if (el) el.classList.add('bg-white', 'text-black', 'border-black', 'ring-2', 'ring-red-500');
            },

            updateStatus(msg = 'Set your lumen level to tune how much satire you see.', variant = 'muted') {
                const status = document.getElementById('calibration-status');
                if (!status) return;
                status.textContent = msg;
                status.className = 'font-mono text-xs uppercase tracking-widest';
                if (variant === 'error') status.classList.add('text-red-200');
                else if (variant === 'success') status.classList.add('text-green-200');
                else status.classList.add('text-gray-200');
            },

            computeLumen() {
                const entry = this.state.entry === 'blind' ? 'Restrained Chaos' : 'Implementation Architect';
                const arg = this.state.arg ? 'ARG-Ready' : 'New Signal';
                const labels = { history: 'History', form: 'Form', intent: 'Intent' };
                const light = this.state.entry === 'light'
                    ? (this.state.lights.size ? Array.from(this.state.lights).map(k => labels[k]).join(' / ') : 'Context Requested')
                    : 'Diegetic Blindfold';
                return `${entry} — ${light} (${arg})`;
            },

            confirm() {
                if (this.state.arg === null || this.state.entry === null) {
                    this.updateStatus('Answer both queries to set your Lumen Level.', 'error');
                    return;
                }

                if (this.state.entry === 'light' && this.state.lights.size === 0) {
                    this.updateStatus('Pick at least one Light explainer to carry.', 'error');
                    return;
                }

                const label = this.computeLumen();
                const readout = document.getElementById('lumen-readout');
                if (readout) readout.textContent = `Lumen Level: ${label}`;
                this.updateStatus('Calibration stored. Proceed to the Identity Assessment when ready.', 'success');

                const stageSelect = document.getElementById('prof-stage-select');
                if (stageSelect) stageSelect.classList.remove('hidden');
                const locked = document.getElementById('prof-stage-locked');
                if (locked) locked.classList.add('hidden');
            }
        };

        const profiler = {
            initialChoice: null,
            scores: { dreamer: 0, scholar: 0, investor: 0, passerby: 0, lantern: 0 },
            currentQ: 0,
            lastWinner: null,
            lastTitle: '',
            lastProfile: null,
            shareTimeout: null,

            init: () => {
                calibrationGate.reset();
                document.getElementById('prof-stage-doubt').classList.add('hidden');
                document.getElementById('prof-stage-quiz').classList.add('hidden');
                document.getElementById('prof-stage-process').classList.add('hidden');
                document.getElementById('prof-banner').classList.add('hidden');
                document.getElementById('quiz-modal').classList.remove('active');
                document.body.classList.remove('modal-open');
                document.getElementById('prof-result-card').classList.add('hidden');
                document.getElementById('sculpture-generator').classList.add('hidden');
                const totalEl = document.getElementById('quiz-total');
                if (totalEl) totalEl.innerText = QUIZ.length;
                profiler.scores = { dreamer: 0, scholar: 0, investor: 0, passerby: 0, lantern: 0 };
                profiler.currentQ = 0;
                profiler.initialChoice = null;
                profiler.lastWinner = null;
                profiler.lastTitle = '';
                const readout = document.getElementById('sculpture-readout');
                if (readout) {
                    readout.innerHTML = `<div class="text-[10px] uppercase tracking-widest text-gray-500">Awaiting prompt...</div><p class="text-sm text-gray-700">Run the quiz and generate a specimen to see the deterministic sketch and dossier.</p>`;
                }
                const addBtn = document.getElementById('add-to-gallery');
                const griftBtn = document.getElementById('send-to-grift');
                if (addBtn) addBtn.disabled = true;
                if (griftBtn) griftBtn.disabled = true;
            },

            select: (role, el) => {
                audio.click();
                profiler.initialChoice = role;
                const target = el || null;
                document.querySelectorAll('.role-card').forEach(c => c.classList.remove('selected'));
                if (target) target.classList.add('selected');
                setTimeout(() => {
                    document.getElementById('prof-stage-select').classList.add('hidden');
                    document.getElementById('prof-stage-doubt').classList.remove('hidden');
                }, 500);
            },

            reset: () => {
                audio.click();
                profiler.init();
            },

            startQuiz: () => {
                audio.click();
                document.getElementById('prof-stage-doubt').classList.add('hidden');
                document.getElementById('prof-stage-quiz').classList.remove('hidden');
                document.getElementById('prof-stage-process').classList.add('hidden');
                document.getElementById('quiz-modal').classList.add('active');
                document.body.classList.add('modal-open');
                profiler.renderQuestion();
            },

            renderQuestion: () => {
                const q = QUIZ[profiler.currentQ];
                document.getElementById('quiz-num').innerText = profiler.currentQ + 1;
                document.getElementById('quiz-q').innerText = q.q;

                const optsContainer = document.getElementById('quiz-options');
                optsContainer.innerHTML = '';

                const shuffled = q.opts.sort(() => 0.5 - Math.random());

                shuffled.forEach(opt => {
                    const btn = document.createElement('button');
                    btn.className = "w-full text-left border border-gray-300 p-4 hover:bg-black hover:text-white transition-colors font-mono text-sm ui-click";
                    btn.innerText = `> ${opt.txt}`;
                    btn.onclick = () => profiler.answer(opt);
                    optsContainer.appendChild(btn);
                });
            },

            answer: (opt) => {
                audio.click();
                profiler.scores[opt.type] += opt.score;
                profiler.currentQ++;
                if (profiler.currentQ < QUIZ.length) {
                    profiler.renderQuestion();
                } else {
                    profiler.calculate();
                }
            },

            calculate: () => {
                document.getElementById('prof-stage-quiz').classList.add('hidden');
                document.getElementById('prof-stage-process').classList.remove('hidden');

                let maxScore = -1;
                let winner = profiler.initialChoice;

                for (const [key, val] of Object.entries(profiler.scores)) {
                    if (val > maxScore) {
                        maxScore = val;
                        winner = key;
                    }
                }

                const adj = ROLES[profiler.initialChoice || winner].adj;
                const noun = winner.toUpperCase();
                const finalTitle = profiler.initialChoice === winner ? `THE PURE ${noun}` : `THE ${adj} ${noun}`;

                profiler.lastWinner = winner;
                profiler.lastTitle = finalTitle;

                profiler.runTypewriter(finalTitle, winner);
            },

            runTypewriter: (title, winnerKey) => {
                const lines = [
                    "Analyzing inputs...",
                    "Comparing against self-perception...",
                    "Detecting dissonance...",
                    "Re-calibrating identity matrix...",
                    "Classification Complete."
                ];
                const container = document.getElementById('decon-lines');
                container.innerHTML = '';
                let delay = 0;
                lines.forEach((line) => {
                    delay += 800 + Math.random() * 500;
                    setTimeout(() => {
                        container.innerHTML += `<div class="fade-in">> ${line}</div>`;
                        if (audio.synth) audio.synth.triggerAttackRelease("C3", "32n");
                    }, delay);
                });

                setTimeout(() => {
                    profiler.showResult(title, winnerKey);
                }, delay + 1000);
            },

            showResult: (title, winnerKey) => {
                document.getElementById('prof-stage-process').classList.add('hidden');
                profiler.closeModal();

                const banner = document.getElementById('prof-banner');
                banner.classList.remove('hidden');
                document.getElementById('banner-title').innerText = title;
                document.getElementById('banner-motto').innerText = ROLES[winnerKey].motto;

                const resultCard = document.getElementById('prof-result-card');
                resultCard.classList.remove('hidden');
                document.getElementById('result-title').innerText = title;
                document.getElementById('result-motto').innerText = ROLES[winnerKey].motto;

                const sculptor = document.getElementById('sculpture-generator');
                sculptor.classList.remove('hidden');
                profiler.generateSculpture();

                if (audio.synth) audio.synth.triggerAttackRelease("C4", "8n");
            },

            closeModal: () => {
                const modal = document.getElementById('quiz-modal');
                modal.classList.remove('active');
                document.body.classList.remove('modal-open');
            },

            buildProfile: () => {
                const mat = document.getElementById('sculpture-material').value;
                const fmt = document.getElementById('sculpture-format').value;
                const mode = document.getElementById('sculpture-mode')?.value || '2d';
                const role = profiler.lastWinner || 'dreamer';
                const palettes = {
                    dreamer: ['#1f2a7e', '#d6d5cc', '#f5d9c3'],
                    scholar: ['#7d6338', '#f6f0e6', '#0f172a'],
                    investor: ['#c0c6cc', '#1b1b1b', '#1db954'],
                    passerby: ['#7fb3ff', '#9ca3af', '#f4f4f5'],
                    lantern: ['#d13f23', '#111111', '#f7c99a']
                };
                const gestures = {
                    dreamer: 'spiraling helix with soft gaps',
                    scholar: 'stacked folios with interlocking bands',
                    investor: 'angled plinths with mirrored insets',
                    passerby: 'offset slabs that almost slip',
                    lantern: 'caged beam held by vertical struts'
                };

                const totalScore = Object.values(profiler.scores).reduce((a, b) => a + b, 0) || 1;
                const alignment = Math.min(99, Math.round((profiler.scores[role] / totalScore) * 42) + 55);
                const seedText = `${Date.now()}-${role}-${fmt}-${mat}-${mode}-${profiler.lastTitle || 'specimen'}`;
                const hash = sculptureEngine.hash(seedText).toString(36).slice(0, 5).toUpperCase();

                return {
                    role,
                    material: mat,
                    format: fmt,
                    mode,
                    modeLabel: mode === '3d' ? '3D (Legacy)' : '2D (Current)',
                    palette: palettes[role] || palettes.dreamer,
                    gesture: gestures[role] || gestures.dreamer,
                    alignment,
                    seedText,
                    hash,
                    specimenId: `Specimen-${role.slice(0, 3).toUpperCase()}-${hash}`,
                    anomalies: [
                        `Role deviation: ${Math.max(2, 100 - alignment)}% mismatch from cohort`,
                        `Pulse ingress: ${Math.round(alignment * 0.23)}bps`,
                        `Void pockets: ${(7 + (alignment % 5)).toFixed(1)}cm`
                    ]
                };
            },

            renderSculptureReadout: (profile) => {
                const readout = document.getElementById('sculpture-readout');
                if (!readout) return;
                readout.innerHTML = `
                    <div class="text-[10px] uppercase tracking-widest text-red-600 mb-2">${profile.specimenId}</div>
                    <div class="space-y-1 text-gray-800">
                        <div class="font-bold text-sm">${profiler.lastTitle || 'Signal Artifact'}</div>
                        <div class="text-[11px] uppercase tracking-[0.25em] text-gray-500">${profile.format} • ${profile.material}</div>
                        <div class="text-sm">${profile.gesture} rendered in ${profile.modeLabel}.</div>
                    </div>
                    <div class="mt-3 space-y-1 text-[11px] uppercase tracking-widest text-gray-600">
                        <div>Alignment: ${profile.alignment}%</div>
                        <div>Seed: ${profile.hash}</div>
                        <div>Palette: ${profile.palette.join(' / ')}</div>
                    </div>
                    <div class="mt-3 text-[11px] text-gray-600 space-y-1">
                        ${profile.anomalies.map(a => `<div class="flex items-start gap-2"><span class="text-red-600">●</span><span>${a}</span></div>`).join('')}
                    </div>
                    <div class="mt-4 pt-3 border-t border-gray-200 space-y-2">
                        <div class="text-[10px] uppercase tracking-widest text-gray-500">Share Blueprint</div>
                        <div class="flex flex-wrap gap-2">
                            <button class="sculpture-share-button" onclick="profiler.shareBlueprint()">Share</button>
                            <button class="sculpture-share-button" onclick="profiler.copyBlueprint()">Copy Brief</button>
                            <button class="sculpture-share-button" onclick="profiler.downloadBlueprint()">Download</button>
                        </div>
                        <div id="sculpture-share-status" class="text-[10px] uppercase tracking-widest text-gray-500">Ready to distribute.</div>
                    </div>
                `;
            },

            generateSculpture: () => {
                const profile = profiler.buildProfile();
                profiler.lastProfile = profile;
                sculptureEngine.render(profile);
                profiler.renderSculptureReadout(profile);
                const addBtn = document.getElementById('add-to-gallery');
                const griftBtn = document.getElementById('send-to-grift');
                if (addBtn) addBtn.disabled = false;
                if (griftBtn) griftBtn.disabled = false;
            },
            addToGallery: () => {
                if (!profiler.lastProfile) return profiler.flashShareStatus('Generate first.');
                const image = sculptureEngine.exportImage();
                const asset = {
                    id: `asset-${Date.now()}-${Math.random().toString(36).slice(2, 6)}`,
                    type: profiler.lastProfile.mode === '3d' ? '3d' : '2d',
                    title: profiler.lastProfile.specimenId,
                    modeLabel: profiler.lastProfile.modeLabel,
                    palette: profiler.lastProfile.palette,
                    profile: profiler.lastProfile,
                    origin: 'Identity Generator',
                    dataUrl: image,
                    createdAt: new Date().toISOString()
                };
                assetState.add(asset);
                profiler.flashShareStatus('Added to gallery.');
            },
            sendToGriftShop: () => {
                if (!profiler.lastProfile) return profiler.flashShareStatus('Generate first.');
                const payload = {
                    specimenId: profiler.lastProfile.specimenId,
                    title: profiler.lastProfile.specimenId,
                    modeLabel: profiler.lastProfile.modeLabel,
                    origin: 'Identity Generator'
                };
                griftLedger.addSale(payload);
                profiler.flashShareStatus('Shipped to grift shop.');
            },

            getSharePayload: () => {
                if (!profiler.lastProfile) return null;
                const { specimenId, format, material, gesture, hash, modeLabel } = profiler.lastProfile;
                return {
                    title: `${specimenId} — ${profiler.lastTitle || 'Signal Artifact'}`,
                    text: `${gesture} built for ${format} (${material}) in ${modeLabel}. Seed ${hash}.`,
                    url: window.location.href.split('#')[0]
                };
            },

            flashShareStatus: (msg) => {
                const el = document.getElementById('sculpture-share-status');
                if (!el) return;
                el.innerText = msg;
                el.style.color = '#d31313';
                if (profiler.shareTimeout) clearTimeout(profiler.shareTimeout);
                profiler.shareTimeout = setTimeout(() => {
                    el.style.color = '';
                }, 1200);
            },

            copyBlueprint: async () => {
                const payload = profiler.getSharePayload();
                if (!payload || !navigator.clipboard) return profiler.flashShareStatus('Generate first.');
                const summary = `${payload.title}\n${payload.text}\n${payload.url}`;
                try {
                    await navigator.clipboard.writeText(summary);
                    profiler.flashShareStatus('Copied blueprint.');
                } catch (err) {
                    profiler.flashShareStatus('Clipboard blocked.');
                }
            },

            shareBlueprint: async () => {
                const payload = profiler.getSharePayload();
                if (!payload) return profiler.flashShareStatus('Generate first.');
                if (navigator.share) {
                    try {
                        await navigator.share(payload);
                        profiler.flashShareStatus('Shared.');
                    } catch (err) {
                        profiler.flashShareStatus('Share dismissed.');
                    }
                } else {
                    profiler.copyBlueprint();
                }
            },

            downloadBlueprint: () => {
                const payload = profiler.getSharePayload();
                if (!payload) return profiler.flashShareStatus('Generate first.');
                const dataUrl = sculptureEngine.exportImage();
                if (!dataUrl) return profiler.flashShareStatus('Preview not ready.');
                const link = document.createElement('a');
                link.href = dataUrl;
                link.download = `${payload.title.replace(/[^a-z0-9\- ]/gi, '').replace(/\s+/g, '_')}.png`;
                link.click();
                profiler.flashShareStatus('Preview downloaded.');
            }
        };

        const depthTracker = {
            storageKey: 'loom-depth-tracker',
            counts: {},
            init() {
                const stored = window.localStorage.getItem(depthTracker.storageKey);
                depthTracker.counts = stored ? JSON.parse(stored) : {};
                depthTracker.applyAll();
            },
            save() {
                window.localStorage.setItem(depthTracker.storageKey, JSON.stringify(depthTracker.counts));
            },
            getDepth(page) {
                const count = depthTracker.counts[page] || 0;
                if (count >= 3) return 3;
                if (count >= 2) return 2;
                if (count >= 1) return 1;
                return 0;
            },
            visit(page) {
                depthTracker.counts[page] = (depthTracker.counts[page] || 0) + 1;
                depthTracker.save();
                depthTracker.apply(page);
            },
            apply(page) {
                const view = document.getElementById(`view-${page}`);
                if (!view) return;
                const depth = depthTracker.getDepth(page);
                view.dataset.depthLevel = String(depth);
                view.classList.remove('depth-0', 'depth-1', 'depth-2', 'depth-3');
                view.classList.add(`depth-${depth}`);
            },
            applyAll() {
                document.querySelectorAll('.view-section').forEach((view) => {
                    const id = view.id.replace('view-', '');
                    const depth = depthTracker.getDepth(id);
                    view.dataset.depthLevel = String(depth);
                    view.classList.remove('depth-0', 'depth-1', 'depth-2', 'depth-3');
                    view.classList.add(`depth-${depth}`);
                });
            }
        };

        const storyGate = {
            code: '13570',
            open() {
                const modal = document.getElementById('story-engine-modal');
                if (!modal) return;
                modal.classList.add('active');
                document.body.classList.add('modal-open');
                const input = document.getElementById('story-engine-code');
                const status = document.getElementById('story-engine-status');
                if (status) status.innerText = 'Awaiting code.';
                if (input) {
                    input.value = '';
                    input.focus();
                }
            },
            close() {
                const modal = document.getElementById('story-engine-modal');
                if (!modal) return;
                modal.classList.remove('active');
                document.body.classList.remove('modal-open');
            },
            submit() {
                const input = document.getElementById('story-engine-code');
                const status = document.getElementById('story-engine-status');
                const val = input ? input.value.trim() : '';
                if (val === storyGate.code) {
                    if (status) status.innerText = 'Access granted.';
                    window.open('story-engine/index.html', '_blank', 'noopener');
                    storyGate.close();
                } else {
                    if (status) status.innerText = 'Incorrect code.';
                }
            }
        };

        const dimeBacklog = {
            open() {
                const modal = document.getElementById('dime-backlog-modal');
                if (!modal) return;
                modal.classList.add('active');
                document.body.classList.add('modal-open');
            },
            close() {
                const modal = document.getElementById('dime-backlog-modal');
                if (!modal) return;
                modal.classList.remove('active');
                document.body.classList.remove('modal-open');
            }
        };

        const surveillance = {
            init: () => {
                const popup = document.getElementById('surveillance-popup');
                const banner = document.getElementById('glitch-banner');
                const closeBtn = document.getElementById('surveillance-close');
                if (!popup || !banner) return;

                setTimeout(() => popup.classList.add('active'), 1400);
                setTimeout(() => banner.classList.add('active'), 2200);

                if (closeBtn) {
                    closeBtn.addEventListener('click', () => popup.classList.remove('active'));
                }
            }
        };

        const spotifyOverlay = {
            init: () => {
                const overlay = document.getElementById('spotify-overlay');
                const toggle = document.getElementById('spotify-toggle');
                if (!overlay || !toggle) return;
                toggle.addEventListener('click', () => {
                    const minimized = overlay.classList.toggle('minimized');
                    toggle.textContent = minimized ? 'Expand' : 'Minimize';
                    toggle.setAttribute('aria-expanded', String(!minimized));
                });
            }
        };

        const caveGlyphs = {
            glyphSet: [
                '⟁', '⟟', '⧉', '⧗', '⨀', '⧖', '⟊', '⧙', '⧃', '⧄', '⧫', '⌁', '⌘', '⌬', '⍜', '⍝', '⍟', '⍤',
                '⊹', '⊶', '⊷', '⟁', '⋰', '⋱', '✶', '✺', '✹', '✷', '✦', '⟡', '⟁', '⟐', '⟁', '⟒', '⟟'
            ],
            generate(length) {
                return Array.from({ length }, () => this.glyphSet[Math.floor(Math.random() * this.glyphSet.length)]).join('');
            },
            init() {
                document.querySelectorAll('[data-cave-item]').forEach((item) => {
                    const baseLength = Math.max(8, Math.min(20, (item.dataset.label || '').length));
                    const jitter = Math.floor(Math.random() * 6);
                    const glyphs = this.generate(baseLength + jitter);
                    item.textContent = glyphs;
                    item.dataset.glyph = glyphs;
                });
            }
        };

        // 10. Main App Controller
        const app = {
            integration: 0,
            visited: new Set(),
            navigate: (target) => {
                // Audio Feedback
                if (window.audio) audio.click();

                // Close Mobile Menu
                document.getElementById('mobile-menu').classList.remove('translate-x-full');
                document.getElementById('mobile-menu').classList.add('translate-x-full');

                // View Transition
                const current = document.querySelector('.view-section.active');
                if(current) current.classList.remove('active');
                
                const next = document.getElementById(`view-${target}`);
                if (next) {
                    next.classList.add('active');
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                } else {
                    console.error("Target view not found:", target);
                    return;
                }

                // Nav State
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    if(btn.dataset.target === target) btn.classList.add('active');
                    else btn.classList.remove('active');
                });

                // Integration Bar
                if (!app.visited.has(target)) {
                    app.visited.add(target);
                    app.integration += 10;
                    document.getElementById('integration-fill').style.width = `${Math.min(100, app.integration)}%`;
                }

                depthTracker.visit(target);

                // Lazy Load Modules
                if (target === 'gallery') setTimeout(gallery.init, 100);
                if (target === 'archive') setTimeout(archive.init, 100);
                if (target === 'grift') setTimeout(grift.init, 100);
                if (target === 'tickets') setTimeout(geoQuiz.init, 100);
                if (target === 'profiler' && profiler.initialChoice === null) profiler.init();
            },
            fullBlastOff: () => {
                const message = 'The Thinkiest People in the world called this incomprehensible. Are you prepared?';
                const proceed = window.confirm(message);
                if (!proceed) return;
                if ('speechSynthesis' in window) {
                    const utterance = new SpeechSynthesisUtterance('lul');
                    utterance.rate = 0.9;
                    window.speechSynthesis.speak(utterance);
                }
            }
        };

        // --- GLOBAL EXPORTS & BOOTSTRAP ---
        window.app = app;
        window.audio = audio;
        window.manufacture = manufacture;
        window.profiler = profiler;
        window.gallery = gallery;
        window.grift = grift;
        window.geoQuiz = geoQuiz;
        window.investorQuiz = investorQuiz;
        window.valueState = valueState;
        window.assetState = assetState;
        window.griftLedger = griftLedger;
        window.celEngine = celEngine;
        window.siteMap = siteMap;
        window.voxelField = voxelField;
        window.storyGate = storyGate;
        window.dimeBacklog = dimeBacklog;
        window.depthTracker = depthTracker;
        window.surveillance = surveillance;
        window.spotifyOverlay = spotifyOverlay;

        // Boot
        window.addEventListener('load', () => {
            const bar = document.getElementById('loader-progress');
            const loader = document.getElementById('loader');
            
            // Sim Load
            let w = 0;
            const interval = setInterval(() => {
                w += Math.random() * 15;
                if (w > 100) w = 100;
                bar.style.width = w + '%';
                if (w === 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        loader.classList.add('fade-out');
                        manufacture.init(); // Init canvas early
                        voxelField.init();
                        celEngine.init();
                        geoQuiz.init();
                        investorQuiz.init();
                        profiler.init();
                        assetState.init();
                        griftLedger.init();
                        depthTracker.init();
                        depthTracker.visit('landing');
                        surveillance.init();
                        spotifyOverlay.init();
                        caveGlyphs.init();
                        document.querySelectorAll('.trick-embed iframe').forEach((frame) => {
                            const parent = frame.closest('.trick-embed');
                            if (!parent) return;
                            if (frame.complete) parent.classList.add('is-loaded');
                            frame.addEventListener('load', () => parent.classList.add('is-loaded'));
                        });
                    }, 600);
                }
            }, 80);

            // Audio Unlock
            document.body.addEventListener('click', () => {
                audio.init();
            }, { once: true });
        });

        window.addEventListener('resize', () => sculptureEngine.resize());

    </script>
</body>
</html>
